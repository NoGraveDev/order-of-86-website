<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect fill='%231C1C1E' width='32' height='32' rx='6'/><text x='16' y='23' font-size='18' font-weight='bold' text-anchor='middle' fill='%23ffd700'>86</text></svg>">
    <title>Map of Pawtheon, Order of 86 | Interactive 3D World Map</title>
    <meta name="description" content="Explore the interactive 3D map of Pawtheon. Navigate the world of the 86 wizard dogs, discover regions, landmarks, and territories of each order.">
    <meta name="robots" content="index, follow">
    <meta name="author" content="Order of 86">
    <meta name="keywords" content="Order of 86, map of Pawtheon, interactive map, 3D map, wizard dogs, fantasy world, NFT world map">
    <link rel="canonical" href="https://theorderof86.com/map">
    <meta property="og:title" content="Map of Pawtheon, Order of 86 | Interactive 3D World">
    <meta property="og:description" content="Explore the interactive 3D map of Pawtheon. Navigate the world of the 86 wizard dogs and discover legendary territories.">
    <meta property="og:image" content="https://theorderof86.com/og-image.jpg">
    <meta property="og:url" content="https://theorderof86.com/map">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Order of 86">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Map of Pawtheon, Order of 86 | Interactive 3D World">
    <meta name="twitter:description" content="Explore the interactive 3D map of Pawtheon. Navigate the world of the 86 wizard dogs and discover legendary territories.">
    <meta name="twitter:image" content="https://theorderof86.com/og-image.jpg">
    <style>
        *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
        :root {
            --color-bg:#000000; --color-surface:rgba(28,28,30,0.85);
            --color-text:#F5F5F7; --color-text-secondary:#98989D;
            --color-flame:#FF6B00; --color-wild:#2ECC71; --color-arcane:#9B6EFF;
            --color-deep:#3498DB; --color-radiant:#F1C40F; --color-heart:#FF69B4;
            --color-wanderer:#9966ff;
        }
        html, body { width:100%; height:100%; overflow:hidden; background:#000; font-family:-apple-system,BlinkMacSystemFont,'SF Pro Display','Segoe UI',Roboto,sans-serif; color:var(--color-text); }
        canvas { display:block; }
        #container { width:100%; height:100%; position:relative; }

        /* Nav */
        .nav { position:fixed; top:0; left:0; right:0; z-index:100; padding:env(safe-area-inset-top,0) 0 0 0; }
        .nav-inner { display:flex; align-items:center; justify-content:space-between; padding:12px 24px; background:rgba(28,28,30,0.72); backdrop-filter:blur(40px) saturate(180%); -webkit-backdrop-filter:blur(40px) saturate(180%); border-bottom:1px solid rgba(255,255,255,0.08); }
        .nav-brand { font-size:18px; font-weight:700; color:#ffd700; text-decoration:none; letter-spacing:0.5px; }
        .nav-links { display:flex; gap:24px; }
        .nav-links a { color:var(--color-text-secondary); text-decoration:none; font-size:14px; font-weight:500; transition:color 0.2s; }
        .nav-links a:hover, .nav-links a.active { color:#ffd700; }
        .hamburger { display:none; background:none; border:none; color:var(--color-text); font-size:24px; cursor:pointer; }
        .mobile-menu { display:none; position:fixed; top:56px; left:0; right:0; background:rgba(28,28,30,0.95); backdrop-filter:blur(40px); padding:16px 24px; z-index:99; flex-direction:column; gap:16px; border-bottom:1px solid rgba(255,255,255,0.08); }
        .mobile-menu.open { display:flex; }
        .mobile-menu a { color:var(--color-text-secondary); text-decoration:none; font-size:16px; padding:8px 0; }
        .mobile-menu a.active { color:#ffd700; }
        @media(max-width:768px) {
            .nav-links { display:none; }
            .hamburger { display:block; }
        }

        /* Title */
        .map-title { position:fixed; top:72px; left:50%; transform:translateX(-50%); z-index:50; font-size:28px; font-weight:800; letter-spacing:6px; color:#ffd700; text-shadow:0 0 30px rgba(255,215,0,0.4), 0 0 60px rgba(255,215,0,0.15); pointer-events:none; text-transform:uppercase; }
        @media(max-width:768px) { .map-title { font-size:18px; letter-spacing:3px; top:64px; } }

        /* Hint */
        .hint { position:fixed; bottom:90px; left:50%; transform:translateX(-50%); z-index:50; color:rgba(255,255,255,0.5); font-size:13px; pointer-events:none; transition:opacity 1s; white-space:nowrap; }
        .hint.hidden { opacity:0; }

        /* Legend */
        .legend { position:fixed; bottom:24px; left:24px; z-index:50; display:flex; flex-direction:column; gap:6px; }
        .legend-item { display:flex; align-items:center; gap:8px; cursor:pointer; padding:4px 12px 4px 8px; border-radius:12px; background:rgba(28,28,30,0.6); backdrop-filter:blur(20px); transition:background 0.2s, transform 0.15s; font-size:12px; font-weight:500; }
        .legend-item:hover { background:rgba(255,255,255,0.1); transform:scale(1.05); }
        .legend-dot { width:10px; height:10px; border-radius:50%; flex-shrink:0; }
        @media(max-width:768px) { .legend { bottom:100px; left:12px; } .legend-item { font-size:11px; padding:3px 8px 3px 6px; } }

        /* Zoom buttons */
        .zoom-btns { position:fixed; bottom:24px; right:24px; z-index:50; display:flex; flex-direction:column; gap:8px; }
        .zoom-btn { width:44px; height:44px; border-radius:14px; background:rgba(28,28,30,0.7); backdrop-filter:blur(20px); border:1px solid rgba(255,255,255,0.1); color:#fff; font-size:22px; display:flex; align-items:center; justify-content:center; cursor:pointer; transition:background 0.2s; }
        .zoom-btn:hover { background:rgba(255,255,255,0.15); }

        /* Info Panel */
        .info-panel { position:fixed; top:0; right:-420px; width:400px; height:100%; z-index:90; background:rgba(20,20,22,0.88); backdrop-filter:blur(50px) saturate(180%); -webkit-backdrop-filter:blur(50px) saturate(180%); border-left:1px solid rgba(255,255,255,0.08); transition:right 0.4s cubic-bezier(0.25,0.46,0.45,0.94); overflow-y:auto; padding:80px 24px 40px; }
        .info-panel.open { right:0; }
        .info-close { position:absolute; top:80px; right:20px; width:32px; height:32px; border-radius:50%; background:rgba(255,255,255,0.1); border:none; color:#fff; font-size:18px; cursor:pointer; display:flex; align-items:center; justify-content:center; }
        .info-close:hover { background:rgba(255,255,255,0.2); }
        .info-realm-name { font-size:26px; font-weight:800; margin-bottom:4px; }
        .info-motto { font-size:13px; font-style:italic; color:var(--color-text-secondary); margin-bottom:16px; }
        .info-section { margin-bottom:16px; }
        .info-section h3 { font-size:13px; font-weight:600; color:var(--color-text-secondary); text-transform:uppercase; letter-spacing:1px; margin-bottom:8px; }
        .info-section p { font-size:14px; line-height:1.5; color:var(--color-text); }
        .info-tags { display:flex; flex-wrap:wrap; gap:6px; }
        .info-tag { padding:4px 10px; border-radius:8px; background:rgba(255,255,255,0.08); font-size:12px; color:var(--color-text-secondary); }
        .dog-cards { display:grid; grid-template-columns:repeat(2,1fr); gap:8px; }
        .dog-card { background:rgba(255,255,255,0.05); border-radius:12px; padding:8px; text-align:center; }
        .dog-card img { width:100%; aspect-ratio:1; object-fit:cover; border-radius:8px; margin-bottom:4px; background:rgba(255,255,255,0.03); }
        .dog-card .dog-name { font-size:11px; font-weight:600; line-height:1.2; }
        .dog-card .dog-order { font-size:10px; color:var(--color-text-secondary); }

        @media(max-width:768px) {
            .info-panel { top:auto; bottom:-100%; right:0; left:0; width:100%; height:70%; border-radius:20px 20px 0 0; border-left:none; border-top:1px solid rgba(255,255,255,0.1); transition:bottom 0.4s cubic-bezier(0.25,0.46,0.45,0.94); padding:20px 20px 40px; }
            .info-panel.open { bottom:0; }
            .info-panel::before { content:''; display:block; width:36px; height:4px; border-radius:2px; background:rgba(255,255,255,0.3); margin:0 auto 16px; }
            .info-close { top:16px; right:16px; }
        }

        /* Loading */
        .loading { position:fixed; inset:0; z-index:200; background:#000; display:flex; flex-direction:column; align-items:center; justify-content:center; transition:opacity 0.8s; }
        .loading.done { opacity:0; pointer-events:none; }
        .loading-text { font-size:20px; font-weight:700; color:#ffd700; letter-spacing:4px; margin-bottom:16px; }
        .loading-bar { width:200px; height:3px; background:rgba(255,255,255,0.1); border-radius:2px; overflow:hidden; }
        .loading-bar-inner { width:0%; height:100%; background:linear-gradient(90deg,#ffd700,#FF6B00); transition:width 0.3s; border-radius:2px; }
    </style>
</head>
<body>

<div class="loading" id="loading">
    <div class="loading-text">PAWTHEON</div>
    <div class="loading-bar"><div class="loading-bar-inner" id="loadBar"></div></div>
</div>

<nav class="nav">
    <div class="nav-inner">
        <a href="index.html" class="nav-brand">Order of 86</a>
        <div class="nav-links">
            <a href="index.html">The Order</a>
            <a href="map.html" class="active">Map of Pawtheon</a>
            <a href="moons.html">Moons</a>
            <a href="lore.html">Lore</a>
            <a href="content.html">Content</a>
        </div>
        <button class="hamburger" onclick="document.getElementById('mobileMenu').classList.toggle('open')">☰</button>
    </div>
</nav>
<div class="mobile-menu" id="mobileMenu">
    <a href="index.html">The Order</a>
    <a href="map.html" class="active">Map of Pawtheon</a>
    <a href="moons.html">Moons</a>
    <a href="lore.html">Lore</a>
    <a href="content.html">Content</a>
</div>

<div class="map-title">PAWTHEON</div>
<div class="hint" id="hint">Drag to rotate • Scroll to zoom • Click a realm to explore</div>

<div class="legend" id="legend"></div>

<div class="zoom-btns">
    <button class="zoom-btn" id="zoomIn">+</button>
    <button class="zoom-btn" id="zoomOut">−</button>
</div>

<div class="info-panel" id="infoPanel">
    <button class="info-close" onclick="closePanel()">✕</button>
    <div id="infoPanelContent"></div>
</div>

<div id="container"></div>

<script type="importmap">
{
    "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.162.0/build/three.module.js",
        "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.162.0/examples/jsm/"
    }
}
</script>
<script type="module">
import * as THREE from 'three';
import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';

// ── Dog Data ──
const wizardDogs = {
    "8728":{id:"8728",rank:554,fur:"Gray",pattern:"Husky",eyes:"Square Glasses",clothes:"Scarf",realm:"Frosthollow",order:"Flame",hatColor:"Orange",suggestedName:"Frostforge the Scarf Bearer",suggestedStory:"*Gray Husky | Square Glasses | Scarf | Frosthollow → Forge Spire*\n\nThe rarest Flame Wizard, and the greatest contradiction in the Order. A Husky from Frosthollow's deepest glaciers, wielding fire magic with scholarly precision. The orange hat found Frostforge during the worst blizzard in Frosthollow's recorded history. While other dogs sought shelter, they stood alone on an exposed peak, reading by the faint aurora light, not seeking warmth, but studying the mathematics of cold. When the hat manifested in the storm, wreathed in flame that never touched their scarf, it chose not courage over fear, but curiosity over comfort.\n\nFrostforge brings the analytical mind of ice to the explosive art of fire. Their signature technique, Measured Burn, creates flames that burn only what needs burning, no more, no less. The scarf they wear isn't fashion; it's a reminder that some heat must be contained to be useful. They are the Flame's chief theoretical researcher, developing new forms of forge magic through the marriage of Frosthollow's patience and Emberhowl's power. Other Flame Wizards charge into battle; Frostforge calculates the exact temperature needed to end it.\n\n---",image:"images/8728.png"},
    "5035":{id:"5035",rank:1443,fur:"Black",pattern:"Husky",eyes:"Sleepy Eyes",clothes:"Scarf",realm:"Frosthollow",order:"Flame",hatColor:"Orange",suggestedName:"Blizzardflame the Ice Hearted",suggestedStory:"*Black Husky | Sleepy Eyes | Scarf | Frosthollow → Forge Spire*\n\nBorn during the Great Silence, when all magic died for forty-nine hours, Blizzardflame spent their earliest days in a world without warmth spells or fire magic. They learned to find heat in movement, in purpose, in the friction of determination against impossibility. When magic returned and the orange hat sought them out, it found a Husky who had already discovered that the hottest flame comes from the coldest heart, not from lack of feeling, but from feelings so intense they burn white-hot.\n\nTheir sleepy eyes mask an inner fire that never dims. Blizzardflame practices the most extreme form of Flame discipline: Cold Fire, flames that burn blue-white and feel ice-cold to the touch while melting steel. They serve as the Forge Spire's connection to Frosthollow, carrying messages through blizzards that would kill other messengers. The scarf they wear is woven from their own shed fur, each thread holding a memory of survived cold. When Blizzardflame enters Trial by Fire, the flames turn blue.\n\n---",image:"images/5035.png"},
    "9758":{id:"9758",rank:2989,fur:"Tan",pattern:"Classic",eyes:"Black Eyes",clothes:"Classic Hoodie",realm:"Violet Highlands",order:"Flame",hatColor:"Orange",suggestedName:"Commonflame the Everyman",suggestedStory:"*Tan Classic | Black Eyes | Classic Hoodie | Violet Highlands → Forge Spire*\n\nThe most politically savvy Flame Wizard, and perhaps the most important. A Classic from the Violet Highlands, the realm of 25 Wizards and endless debate, who found their orange hat not through spectacular trial but through quiet, daily courage. Commonflame was a city scribe who walked the same route to work every day through increasingly dangerous streets during the pre-Loyalty Wars tensions. While nobles hired guards and merchants found new routes, Commonflame simply... kept walking. The hat found them on a Tuesday, manifesting not in dramatic flame but as a warm glow on their head as they helped an injured stranger.\n\nTheir power lies not in extraordinary combat magic but in extraordinary determination. Commonflame's flames never go out, not flashy, but absolutely reliable. They serve as the Flame's ambassador to the Violet Highlands' Grand Assembly, translating between the political language of Classics and the direct language of fire. The hoodie they wear marks them as approachable; they're the Flame Wizard most likely to have a normal conversation about normal things. But when politics threaten to explode into violence, Commonflame's steady flame reminds everyone that true strength doesn't need to shout.\n\n---",image:"images/9758.png"},
    "3030":{id:"3030",rank:3305,fur:"White",pattern:"Classic",eyes:"Black Eyes",clothes:"None",realm:"Violet Highlands",order:"Flame",hatColor:"Orange",suggestedName:"Pureflame the Unadorned",suggestedStory:"*White Classic | Black Eyes | None | Violet Highlands → Forge Spire*\n\nThe most minimalist Flame Wizard. No accessories, no distinctive clothing, nothing but white fur and black eyes and an orange hat. Pureflame's origin story is almost disappointingly simple: they walked into the Trial by Fire with nothing and emerged with everything. The Flame's magic chose them precisely because they brought no expectations, no baggage, no preconceptions about what fire magic should be.\n\nTheir specialty is Essential Flame, fire stripped of everything except the core concept of transformation. When Pureflame casts, their magic appears as simple orange light, but it cuts through the most complex defensive spells like they're paper. They refuse all ornamentation, all titles beyond their name, all complications that might dilute their focus. Other Flame Wizards joke that Pureflame is so pure they barely cast shadows. They're not wrong. In the philosophical debates that rage within any Order, Pureflame represents the position that fire doesn't need a reason to burn, it burns because burning is what fire does.\n\n---",image:"images/3030.png"},
    "986":{id:"986",rank:3638,fur:"Gray",pattern:"Split",eyes:"Square Glasses",clothes:"None",realm:"Abyssal Reaches",order:"Flame",hatColor:"Orange",suggestedName:"Splitforge the Dual Natured",suggestedStory:"*Gray Split | Square Glasses | None | Abyssal Reaches → Forge Spire*\n\nA Split-furred diplomat from the Abyssal Reaches who found their orange hat in the most unlikely place: the middle of a peace negotiation. Splitforge was mediating a dispute between rival fishing fleets when both sides' anger erupted into violence. Instead of fleeing or choosing sides, they stood between the combatants and spoke, not words of peace, but words of challenge. \"If you must fight,\" they said, \"fight something that fights back.\" The hat manifested as they offered themselves as the target for both fleets' rage.\n\nSplitforge's dual nature makes them unique among the Flame. Their Split fur literally divides their magical expression, one half channels aggressive flame, the other controlled burn. They can simultaneously attack and defend, destroy and preserve. Their square glasses reflect their analytical approach to combat magic. They serve as the Flame's specialist in conflict resolution through controlled escalation, sometimes the best way to prevent a war is to give people a small, safe fight that satisfies their need for violence. Splitforge provides that service, channeling societal anger into manageable fire.\n\n---",image:"images/986.png"},
    "165":{id:"165",rank:3732,fur:"Gray",pattern:"Husky",eyes:"Visor",clothes:"None",realm:"Frosthollow",order:"Flame",hatColor:"Orange",suggestedName:"Vanguard the Glacier Walker",suggestedStory:"*Gray Husky | Visor | None | Frosthollow → Forge Spire*\n\nThe third Husky in the Flame Order, proving that Frosthollow breeds something special in ice-dogs who choose fire. Vanguard earned their orange hat by doing what no other dog had done: they walked across the Frozen Lake of Echoes during a blizzard, guided only by the visor that protected their eyes from ice-glare. The lake preserves sounds from thousands of years, howls, conversations, the echoes of the First Howl itself. As Vanguard crossed, they listened to every preserved sound and chose the ones worth preserving in flame.\n\nTheir visor isn't just protection; it's a magical focus that lets them see heat signatures through ice, smoke, and flame. Vanguard serves as the Flame's arctic specialist, the only Wizard who can forge weapons in sub-zero temperatures. Their signature creation is Glacier Glass, transparent metal harder than steel, forged from ice and fire in perfect balance. They lead scouting missions into territories too cold for other Flame Wizards, proving that fire doesn't fear cold, it conquers it.\n\n---",image:"images/165.png"},
    "5275":{id:"5275",rank:3857,fur:"Brown",pattern:"Split",eyes:"Yellow Eyes",clothes:"None",realm:"Abyssal Reaches",order:"Flame",hatColor:"Orange",suggestedName:"Tideforge the Current Rider",suggestedStory:"*Brown Split | Yellow Eyes | None | Abyssal Reaches → Forge Spire*\n\nFrom the coastal cliffs where land meets sea, Tideforge brought the rhythm of waves to the chaos of flame. Their Split nature, half sea-blue, half sun-gold, made them natural mediators in the Abyssal Reaches' constantly shifting politics. The orange hat found them during the Tidal Court sessions, when they alone spoke for both the above-water and below-water factions simultaneously. As they argued two contradictory positions with equal passion, the hat manifested, recognizing that sometimes the greatest courage is being willing to disagree with yourself.\n\nTheir yellow eyes see through water as clearly as air, making them the Flame's naval specialist. Tideforge's fire burns even underwater, fed by the friction between opposing forces rather than by air. They serve as liaison to the Abyssal Reaches' government, translating between the Split realm's dual-perspective politics and the Flame's direct action philosophy. When the Forge Spire needs weapons that function in all environments, Tideforge creates fire that adapts to its surroundings like a tide.\n\n---",image:"images/5275.png"},
    "8667":{id:"8667",rank:3969,fur:"Orange",pattern:"Solid",eyes:"Sleepy Eyes",clothes:"None",realm:"Sunward Heights",order:"Flame",hatColor:"Orange",suggestedName:"Goldforge the Sun Touched",suggestedStory:"*Orange Solid | Sleepy Eyes | None | Sunward Heights → Forge Spire*\n\nThe only orange-furred Flame Wizard, creating a perfect visual harmony between breed and Order. From the sun-drenched Sunward Heights, where everything is pure and bright, Goldforge seemed destined for the Radiant Order's light magic. But when the Sorting Ceremony came, it was an orange hat that chose them, not because they radiated light, but because they absorbed it. Their sleepy eyes hide an inner furnace that burns on stored solar energy, making them most powerful at noon and during solar storms.\n\nGoldforge represents the Flame's connection to stellar fire rather than earthly flame. Their magic draws directly from the sun, creating weapons that blaze with daylight intensity. They are the only Flame Wizard whose magic gets stronger in bright light rather than weaker. During the summer solstice, when Solaris peaks, Goldforge's power rivals any Radiant Wizard's. Their sleepy demeanor masks the fact that they're constantly processing enormous amounts of solar energy. When they fully wake up, the results can be seen from orbit.\n\n---",image:"images/8667.png"},
    "7770":{id:"7770",rank:3986,fur:"Gray",pattern:"Tiger",eyes:"Red Eyes",clothes:"None",realm:"Ember Wastes",order:"Flame",hatColor:"Orange",suggestedName:"Stripesight the Pattern Burner",suggestedStory:"*Gray Tiger | Red Eyes | None | Ember Wastes → Forge Spire*\n\nA Tiger from the volcanic Ember Wastes, where Tigers naturally thrive, but unique even among their stripe-patterned kin. Stripesight's red eyes, the rarest eye color among Wizards, see not just heat but the patterns within fire. When other Tigers practice solitary ambush magic, Stripesight studied the mathematical beauty of flame spread, the fractal patterns of ember trails, the hidden geometry of explosion. Their orange hat appeared during the Ash Garden burns, manifesting as they traced flame patterns in volcanic ash.\n\nTheir Tiger stripes store magical energy in complex patterns, releasing it in controlled burns that follow precise mathematical sequences. Stripesight creates fire that burns in fractals, flames that follow geometric progression, controlled explosions that bloom in perfect spirals. They serve as the Flame's master of precision destruction, when the Order needs to burn exactly this much and no more, Stripesight calculates the pattern. Their red eyes reflect not anger but the deep satisfaction of an artist whose medium happens to be fire.\n\n---",image:"images/7770.png"},
    "7710":{id:"7710",rank:4081,fur:"Yellow",pattern:"Solid",eyes:"Sleepy Eyes",clothes:"None",realm:"Sunward Heights",order:"Flame",hatColor:"Orange",suggestedName:"Goldstrike the Lightning Fast",suggestedStory:"*Yellow Solid | Sleepy Eyes | None | Sunward Heights → Forge Spire*\n\nAnother Solid from the Sunward Heights, but where Goldforge burns steady and bright, Goldstrike burns in rapid bursts. Their yellow fur gleams like captured lightning, and despite their sleepy appearance, they are the fastest draw in the Flame Order. The orange hat found them during a moment of perfect reaction time, a rockslide threatening a trading caravan, Goldstrike moving without thought to create a controlled explosion that redirected the falling stones.\n\nTheir magic manifests as Lightning Fire, flame that moves at the speed of electricity, strikes with surgical precision, and dissipates immediately. Perfect for rescue operations where sustained heat would cause more damage than the original problem. Goldstrike's sleepy eyes are actually constantly calculating trajectory, timing, and force needed for split-second interventions. They serve as the Flame's rapid response specialist, arriving at emergencies before the call for help finishes echoing through the Loyalty Network.\n\n---",image:"images/7710.png"},
    "1848":{id:"1848",rank:4120,fur:"Yellow",pattern:"Tiger",eyes:"Round Glasses",clothes:"None",realm:"Ember Wastes",order:"Flame",hatColor:"Orange",suggestedName:"Lensfire the Tiger Scholar",suggestedStory:"*Yellow Tiger | Round Glasses | None | Ember Wastes → Forge Spire*\n\nThe most academic Tiger in the Ember Wastes, and possibly the only Tiger who reads for pleasure. Lensfire's round glasses mark them as scholarly in a realm that values instinct over study, independence over collaboration. But when their orange hat manifested, it wasn't during solo meditation but during the most collaborative moment of their life, teaching young Tigers how to control their stripe-stored magic. The hat recognized that sometimes the greatest courage is admitting you don't know everything.\n\nTheir glasses focus more than just vision; they focus flame into precise tools for magical research. Lensfire burns away ignorance the way others burn away enemies, using fire to reveal hidden truths by destroying everything that obscures them. They serve as the Flame's research director, conducting experiments too dangerous for anyone without Tiger reflexes and scholarly patience. When the Order encounters unknown magic, Lensfire burns controlled samples until they understand how it works.\n\n---",image:"images/1848.png"},
    "4540":{id:"4540",rank:4490,fur:"White",pattern:"Blotted",eyes:"Visor",clothes:"None",realm:"Shadowmire",order:"Flame",hatColor:"Orange",suggestedName:"Blotforge the Chaos Shaper",suggestedStory:"*White Blotted | Visor | None | Shadowmire → Forge Spire*\n\nThe only Shadowmire representative in the Flame Order, carrying the prejudices of both their dark homeland and their fire-bright Order. Blotforge's blotted pattern, irregular, asymmetric, chaotic, makes them an outcast in an Order that values controlled power and disciplined technique. But their white base color reflects all light, making their unpredictable blots into a strength rather than a weakness. The orange hat found them in the Shifting Grounds during a territory rearrangement, when they alone remained standing as the earth literally reformed around them.\n\nTheir visor protects against the chaos of their own magic as much as external threats. Blotforge's flame follows no pattern because pattern is limitation, their fire adapts, mutates, and evolves in real time to overcome any obstacle. They represent the Flame's answer to enemies who adapt to conventional fire magic: unpredictable flame that cannot be predicted or countered. Other Flame Wizards create controlled burns. Blotforge creates intelligent burns that learn from resistance.\n\n---",image:"images/4540.png"},
    "8095":{id:"8095",rank:4524,fur:"Gray",pattern:"Split",eyes:"Pink Eyes",clothes:"None",realm:"Abyssal Reaches",order:"Flame",hatColor:"Orange",suggestedName:"Rosestrike the Pink Eyed",suggestedStory:"*Gray Split | Pink Eyes | None | Abyssal Reaches → Forge Spire*\n\nFrom the tidal politics of the Abyssal Reaches, where every decision requires balancing two perspectives, Rosestrike brought the rare gift of pink eyes, eyes that see emotional energy as clearly as physical matter. In their homeland's Twin Council system, they served as the emotional interpreter, helping negotiators understand not just what was said but what was felt. The orange hat manifested during a particularly heated debate when they stood up and declared, \"Stop arguing about positions. Fight for principles.\"\n\nTheir pink eyes let them see the emotional fuel behind magical energy, making them uniquely suited to combat magic that draws on passion rather than technique. Rosestrike's flames burn brightest when fighting for something rather than against something, making them the Flame's specialist in defensive combat and protection magic. They can literally see love, honor, loyalty, and courage as flames that can be amplified and weaponized. When Rosestrike fights, they're not just wielding fire, they're wielding the emotional energy that makes fire worth using.\n\n---",image:"images/8095.png"},
    "5518":{id:"5518",rank:5144,fur:"Black",pattern:"Split",eyes:"Green Eyes",clothes:"None",realm:"Abyssal Reaches",order:"Flame",hatColor:"Orange",suggestedName:"Voidstrike the Green Eyed",suggestedStory:"*Black Split | Green Eyes | None | Abyssal Reaches → Forge Spire*\n\nThe darkest-furred Flame Wizard, their black Split pattern creating a visual contradiction with orange flame that somehow works perfectly. Voidstrike's green eyes, unusual for any breed, see magical voids, the empty spaces where magic should be but isn't. They found their calling during the Great Silence's aftermath, identifying and mapping the \"dead bonds\" left in the Loyalty Network by the magical shutdown. The orange hat appeared as they worked to reforge broken magical connections through controlled flame.\n\nTheir specialty is Void Fire, flame that burns in magical darkness, drawing fuel from the absence of other magic rather than its presence. When enemies create magical barriers or null-magic zones, Voidstrike's fire burns brighter. They serve as the Flame's specialist in anti-magic combat, creating fire that consumes magical defenses the way normal fire consumes wood. Their black fur makes them nearly invisible in smoke and shadow, while their green eyes track magical signatures others can't detect.\n\n---",image:"images/5518.png"},
    "1714":{id:"1714",rank:5584,fur:"Brown",pattern:"Classic",eyes:"Pink Eyes",clothes:"None",realm:"Violet Highlands",order:"Flame",hatColor:"Orange",suggestedName:"Roseheart the Gentle Flame",suggestedStory:"*Brown Classic | Pink Eyes | None | Violet Highlands → Forge Spire*\n\nThe most diplomatic Flame Wizard, proving that fire magic doesn't require an aggressive personality. Roseheart's pink eyes and gentle demeanor make them seem more suited to the Heart Order than the Flame, but their orange hat chose them precisely because they understand that the hottest flame is controlled flame. They found their calling during post-Loyalty Wars reconstruction, using precisely controlled fire to clear debris without damaging anything salvageable.\n\nTheir Brown Classic fur marks them as steady and reliable, while their pink eyes let them see the emotional damage that combat leaves behind. Roseheart's flames never cause unnecessary harm, they burn away what needs burning and preserve what needs preserving. They serve as the Flame's humanitarian specialist, using fire magic for rescue operations, medical cauterization, and controlled demolition. When other Flame Wizards are too dangerous for civilian work, Roseheart provides fire with a conscience.\n\n---",image:"images/1714.png"},
    "246":{id:"246",rank:5884,fur:"Orange",pattern:"Solid",eyes:"Black Eyes",clothes:"None",realm:"Sunward Heights",order:"Flame",hatColor:"Orange",suggestedName:"Goldburn the Solar Flame",suggestedStory:"*Orange Solid | Black Eyes | None | Sunward Heights → Forge Spire*\n\nThe second orange-furred Flame Wizard, but where Goldforge channels stored solar energy, Goldburn channels direct solar flame. Their orange Solid coat creates perfect resonance with orange hat magic, making them a walking embodiment of pure Flame discipline. The hat found them during high noon on the summer solstice, as they stood unprotected on the Purified Plateau, deliberately absorbing as much solar energy as their body could hold.\n\nTheir black eyes create stark contrast with orange fur, marking them as a being of absolute focus within absolute power. Goldburn's magic doesn't just use fire, it IS fire, in the purest possible form. They serve as the Flame's connection to stellar forces, the living proof that Order magic can achieve perfect harmony with natural forces. During solar storms, Goldburn becomes temporarily more powerful than any other Flame Wizard. Their presence alone raises the temperature in any room they enter.\n\n---",image:"images/246.png"},
    "4042":{id:"4042",rank:6804,fur:"Gray",pattern:"Classic",eyes:"Pink Eyes",clothes:"None",realm:"Violet Highlands",order:"Flame",hatColor:"Orange",suggestedName:"Roseflame the Pink Eyed",suggestedStory:"*Gray Classic | Pink Eyes | None | Violet Highlands → Forge Spire*\n\nThe third pink-eyed Flame Wizard, proving that emotional sight is more common in the Order than initially recognized. Roseflame's gray Classic appearance makes them blend into any crowd in the Violet Highlands, but their pink eyes reveal the emotional currents flowing beneath political discourse. They earned their orange hat during a Grand Assembly session when they stood up and used flame magic to literally illuminate the emotional dishonesty in several speakers' arguments.\n\nTheir power lies in Emotional Flame, fire that burns lies, cowardice, and dishonor while leaving truth, courage, and integrity untouched. In the politically complex Violet Highlands, this makes them both invaluable and dangerous. Roseflame serves as the Flame's truth-detector, using controlled fire to reveal when someone is lying to themselves as much as to others. Their gray fur and pink eyes create the perfect combination for seeing clearly through political smoke.\n\n---",image:"images/4042.png"},
    "1053":{id:"1053",rank:7607,fur:"Black",pattern:"Zombie",eyes:"Black Eyes",clothes:"None",realm:"Shadowmire",order:"Flame",hatColor:"Orange",suggestedName:"Deathforge the Undying",suggestedStory:"*Black Zombie | Black Eyes | None | Shadowmire → Forge Spire*\n\nThe darkest Wizard in the entire Order of 86, both literally and figuratively. A Zombie from the Shadowmire practicing fire magic, decay and transformation meeting flame and renewal. Deathforge earned their orange hat by walking through the Great Rot's infected territory and emerging not just unharmed, but changed. The corruption that destroys other living things feeds their Zombie nature, and they learned to burn rot away from the inside out.\n\nTheir all-black appearance, black fur, black eyes, black pattern, makes them invisible in smoke and shadow. But when Deathforge channels flame magic, their entire body glows from within like a coal in the darkness. They represent the Flame's answer to corruption: sometimes the only way to cleanse decay is to burn it from something that can't be corrupted. Their death-touched nature makes them immune to many forms of magical attack, while their flame magic provides the offensive power that pure immunity lacks. When the Great Rot finally breaks containment, Deathforge will be the Flame's first response.",image:"images/1053.png"},
    "3449":{id:"3449",rank:627,fur:"Brown",pattern:"Tiger",eyes:"Pink Eyes",clothes:"Poncho",realm:"Ember Wastes",order:"Wild",hatColor:"Green",suggestedName:"Stripeheart the Bridge Walker",suggestedStory:"*Brown Tiger | Pink Eyes | Poncho | Ember Wastes → Heartwood Spire*\n\nThe rarest Wild Wizard and the greatest contradiction in the Order. A solitary Tiger from the volcanic Ember Wastes, where independence is survival, who found their green hat by doing the most un-Tiger thing possible: they established a permanent beast sanctuary. Stripeheart's pink eyes, the gift of emotional sight, let them see the terror in animals fleeing volcanic eruptions. Instead of hunting prey weakened by disaster, they guided them to safety. The green hat manifested as they stood between a pack of terrified creatures and a lava flow, using their own body as a bridge to guide them across cooling stone.\n\nTheir poncho, woven from plant fibers that grow only in volcanic soil, marks them as a traveler between realms. Stripeheart carries seeds from the Heartwood throughout the Ember Wastes, creating networks of green growth in the most unlikely places. They are the Wild's ambassador to the Tiger realm, proving that solitary creatures can serve collective good without losing their essential nature. When natural disasters threaten to separate mothers from cubs, Stripeheart creates magical migration routes that keep families together. Their pink eyes weep for every creature they cannot save, and their tears grow into memorial gardens.\n\n---",image:"images/3449.png"},
    "8272":{id:"8272",rank:1073,fur:"White",pattern:"Spotted",eyes:"Round Glasses",clothes:"Lumberjack",realm:"Deepwood",order:"Wild",hatColor:"Green",suggestedName:"Spotforge the Pattern Reader",suggestedStory:"*White Spotted | Round Glasses | Lumberjack | Deepwood → Heartwood Spire*\n\nA native of the Deepwood who earned their green hat through the most scholarly form of nature magic: pattern recognition. Spotforge's white coat with dark spots creates a living map of the forest's health, each spot corresponds to a different grove, and the spots' color and size change to reflect the condition of their linked trees. Their round glasses focus not just vision but magical perception, letting them read the deep patterns that connect all growing things.\n\nTheir lumberjack outfit marks them as one of the Wild Order's few members who works with dead wood as well as living trees. Spotforge practices Sustainable Magic, they can tell exactly how much can be taken from a forest without damaging its long-term health. They serve as the Wild's resource manager, ensuring that the Heartwood Spire's growth doesn't drain the surrounding forest. When other Orders need wood for construction, Spotforge selects trees that want to be harvested, usually old trees ready to make room for new growth, transforming their final act into service.\n\n---",image:"images/8272.png"},
    "8822":{id:"8822",rank:1415,fur:"White",pattern:"Blotted",eyes:"Square Glasses",clothes:"Sport Hoodie",realm:"Shadowmire",order:"Wild",hatColor:"Green",suggestedName:"Chaosbloom the Change Bringer",suggestedStory:"*White Blotted | Square Glasses | Sport Hoodie | Shadowmire → Heartwood Spire*\n\nFrom the ever-changing Shadowmire to the ever-growing Heartwood, Chaosbloom brings the gift of controlled chaos to nature magic. Their blotted pattern shifts and changes like the Shadowmire's terrain, never quite the same from day to day. The square glasses they wear focus chaotic energy into readable patterns, while their sport hoodie suggests an active, dynamic approach to magic that matches their homeland's embrace of transformation.\n\nChaosbloom's specialty is Accelerated Evolution, using Wild magic to speed up natural selection and adaptation processes. When the Great Rot threatens specific plant species, they help those plants develop resistance in days instead of generations. Their white base color reflects all forms of magical energy, making them immune to corruption while their chaotic blotting pattern adapts their magic to any challenge. They serve as the Wild's specialist in fighting magical corruption through biological innovation, sometimes the best defense against unnatural evil is natural change happening unnaturally fast.\n\n---",image:"images/8822.png"},
    "6398":{id:"6398",rank:1466,fur:"Brown",pattern:"Split",eyes:"Black Eyes",clothes:"Shirt",realm:"Abyssal Reaches",order:"Wild",hatColor:"Green",suggestedName:"Tideseed the Shore Walker",suggestedStory:"*Brown Split | Black Eyes | Shirt | Abyssal Reaches → Heartwood Spire*\n\nFrom the coastal cliffs where land meets sea, Tideseed brings the rhythm of tides to the patience of growth. Their Split nature, half earth-brown, half sea-blue, makes them natural ambassadors between terrestrial plants and marine ecosystems. The shirt they wear is woven from kelp fibers, creating clothing that breathes with the tide's rhythm. Their green hat manifested as they successfully grafted land plants onto underwater root systems, creating the first truly amphibious forest.\n\nTheir magic specializes in Tidal Growth, plants that flourish in both salt and fresh water, roots that grow stronger when submerged, seeds that use wave action to spread. Tideseed maintains the coastal forests that protect inland areas from storm damage, creating living breakwaters that grow stronger with each storm they survive. They serve as liaison between the Wild Order and the Abyssal Reaches, ensuring that both realm interests are served when nature magic affects coastal areas.\n\n---",image:"images/6398.png"},
    "2426":{id:"2426",rank:2082,fur:"White",pattern:"Blotted",eyes:"Black Eyes",clothes:"Turtleneck",realm:"Shadowmire",order:"Wild",hatColor:"Green",suggestedName:"Blotbark the Corruption Fighter",suggestedStory:"*White Blotted | Black Eyes | Turtleneck | Shadowmire → Heartwood Spire*\n\nThe second Shadowmire Wizard in the Wild Order, specializing in the fight against the Great Rot. Blotbark's white base color with chaotic dark blotting creates perfect camouflage in partially corrupted forest, they can move through Rot-touched territory undetected by matching their pattern to diseased bark. Their turtleneck provides protection against airborne spores and magical contamination, while their black eyes see corruption as clearly as other Wild Wizards see healthy growth.\n\nTheir unique ability is Rot Reversal, using controlled decay to fight uncontrolled corruption. By accelerating the natural decomposition of infected plant matter, they prevent the Rot from spreading through root networks. Blotbark walks the dangerous border between healthy forest and corrupted wasteland, serving as early warning system and first line of defense. Their Shadowmire heritage makes them comfortable with decay as natural process, while their Wild training provides the growth magic needed to restore cleared areas.\n\n---",image:"images/2426.png"},
    "1977":{id:"1977",rank:2547,fur:"Black",pattern:"Classic",eyes:"Green Eyes",clothes:"Collar",realm:"Violet Highlands",order:"Wild",hatColor:"Green",suggestedName:"Greensight the Network Walker",suggestedStory:"*Black Classic | Green Eyes | Collar | Violet Highlands → Heartwood Spire*\n\nFrom the scholarly Violet Highlands, where information flows through written networks, Greensight brings academic discipline to biological networks. Their green eyes, matching their Order's color, see the root networks that connect forest ecosystems as clearly as a Classic sees library catalogs. The collar they wear is living vine that stays green year-round, demonstrating their permanent connection to growing things even in winter.\n\nTheir specialty is Network Magic, using the root systems of forests as communication and transport networks. Messages carried through tree roots travel faster than any conventional messenger, while the root networks can detect threats to forest health before surface symptoms appear. Greensight maps and maintains these biological networks, ensuring that information flows efficiently through natural systems. They serve as the Wild's information specialist, proving that nature's networks are more sophisticated than any civilization's archives.\n\n---",image:"images/1977.png"},
    "1976":{id:"1976",rank:2938,fur:"Gray",pattern:"Husky",eyes:"Black Eyes",clothes:"Collar",realm:"Frosthollow",order:"Wild",hatColor:"Green",suggestedName:"Frostbark the Ice Grower",suggestedStory:"*Gray Husky | Black Eyes | Collar | Frosthollow → Heartwood Spire*\n\nThe most unlikely Wild Wizard, a Husky from the frozen realm practicing magic of growth and warmth. Frostbark's gray fur and endurance breeding make them perfectly suited to Frosthollow's harsh conditions, but their green hat chose them for their understanding of life persisting in impossible circumstances. They found their calling tending the few hardy plants that grow in Frosthollow's brief summers, coaxing maximum life from minimal growing seasons.\n\nTheir collar is woven from arctic moss, the only plant that stays green through Frosthollow's winters. Frostbark's magic specializes in Cold Growth, plants that thrive in sub-freezing temperatures, roots that draw nutrients from ice, and growing seasons that extend into winter months. They prove that Wild magic isn't limited to temperate climates by creating food sources that sustain Frosthollow through the longest winters. When other realms' crops fail due to unexpected cold snaps, Frostbark's arctic varieties provide emergency food supplies.\n\n---",image:"images/1976.png"},
    "3758":{id:"3758",rank:3040,fur:"Purple",pattern:"Zombie",eyes:"Red Eyes",clothes:"None",realm:"Shadowmire",order:"Wild",hatColor:"Green",suggestedName:"Deathbloom the Renewal Bringer",suggestedStory:"*Purple Zombie | Red Eyes | None | Shadowmire → Heartwood Spire*\n\nThe most visually striking Wild Wizard, purple fur with red eyes from the realm of decay practicing the magic of growth. Deathbloom represents the Wild's understanding that death and growth are partners, not enemies. Their Zombie heritage means they understand decay from the inside, while their red eyes see the life force that persists even in dying things. The green hat chose them during their first bloom, a moment when their purple fur sprouted actual flowers, proving that even death-touched beings can nurture life.\n\nTheir magic is Necromantic Botany, growing plants from dead soil, using the nutrients in decay to fuel new growth, and creating gardens that flourish in graveyards and battlefields. Deathbloom tends the memorial groves where fallen Wizards are honored, ensuring that death serves life in an endless cycle. Their purple and green color combination creates visual harmony between death and growth, while their red eyes track the life force that flows from ending to beginning.\n\n---",image:"images/3758.png"},
    "8965":{id:"8965",rank:3183,fur:"Brown",pattern:"Classic",eyes:"Black Eyes",clothes:"Scarf",realm:"Violet Highlands",order:"Wild",hatColor:"Green",suggestedName:"Brownthorn the Shield Grower",suggestedStory:"*Brown Classic | Black Eyes | Scarf | Violet Highlands → Heartwood Spire*\n\nA practical Classic from the Violet Highlands who earned their green hat through defensive magic rather than aggressive growth. Brownthorn's brown fur blends perfectly with tree bark and rich soil, while their scarf is woven from thorn-vine fibers that provide natural armor. They found their calling during the Loyalty Wars, when they used rapid-growth magic to create living barriers that protected civilians from combat magic.\n\nTheir specialty is Defensive Botany, walls of thorns that grow in seconds, root networks that detect approaching threats, and tree canopies that provide natural shelter. Brownthorn's magic focuses on protection rather than attack, creating living fortifications that grow stronger with time. They serve as the Wild's defensive specialist, proving that nature magic is most powerful when it preserves rather than destroys. Their Classic steadiness makes them ideal for long-term protective magic that must remain stable for years.\n\n---",image:"images/8965.png"},
    "6873":{id:"6873",rank:3935,fur:"Yellow",pattern:"Solid",eyes:"Mixed",clothes:"None",realm:"Sunward Heights",order:"Wild",hatColor:"Green",suggestedName:"Goldleaf the Multi Eyed",suggestedStory:"*Yellow Solid | Mixed Eyes | None | Sunward Heights → Forge Spire*\n\nThe only Wild Wizard with mixed-color eyes, creating a connection to multiple magical frequencies simultaneously. Goldleaf's yellow Solid fur creates perfect resonance with sunlight, while their mixed eyes let them see both solar energy and earth energy as interconnected systems. They earned their green hat by creating the first plants that could photosynthesize moonlight as efficiently as sunlight, extending growing seasons into the night.\n\nTheir magic specializes in Solar Botany, plants that store sunlight like batteries, releasing it gradually to power growth during cloudy periods. Goldleaf's yellow fur actually photosynthesizes, making them partially plant themselves. They serve as the Wild's connection to solar energy cycles, ensuring that forest magic remains strong even during the winter months when Solaris is weakest. Their mixed eyes see the color spectrum differently each day, allowing them to tune plant growth to specific wavelengths of light.\n\n---",image:"images/6873.png"},
    "2807":{id:"2807",rank:4035,fur:"Green",pattern:"Zombie",eyes:"Visor",clothes:"None",realm:"Shadowmire",order:"Wild",hatColor:"Green",suggestedName:"Voidbloom the Visor Wearer",suggestedStory:"*Green Zombie | Visor | None | Shadowmire → Heartwood Spire*\n\nThe second Zombie in the Wild Order, but where Deathbloom works with death-to-life transitions, Voidbloom specializes in void-to-growth magic. Their green fur matches their Order's color perfectly, while the visor they wear protects against the disorientation of seeing plants grow in magical darkness. Voidbloom earned their place by growing the first garden in the Shadowmire's dark valleys, where normal photosynthesis is impossible.\n\nTheir magic is Void Botany, plants that grow without sunlight, drawing energy from magical darkness and shadow. These shadow plants serve as food sources in underground areas and during eclipse periods when normal agriculture fails. Voidbloom's visor contains crystallized darkness that lets them see how shadow interacts with living things. They prove that growth is possible anywhere life is needed, regardless of environmental conditions.\n\n---",image:"images/2807.png"},
    "9952":{id:"9952",rank:4082,fur:"Black",pattern:"Zombie",eyes:"Green Eyes",clothes:"None",realm:"Shadowmire",order:"Wild",hatColor:"Green",suggestedName:"Grimbloom the Green Eyed",suggestedStory:"*Black Zombie | Green Eyes | None | Shadowmire → Heartwood Spire*\n\nThe darkest Wild Wizard, their black Zombie fur creating stark contrast with green Order magic. Grimbloom's green eyes see life force directly, making them capable of detecting the faintest spark of vitality in seemingly dead environments. They specialize in resurrection botany, bringing dead plants back to life, not as undead vegetation but as renewed living things.\n\nTheir magic focuses on Second Chance Growth, giving failed crops another opportunity to thrive, reviving forests damaged by magical combat, and maintaining the Shadowmire's ecosystem despite constant decay and transformation. Grimbloom's black fur makes them invisible in the deepest forest shadows, while their green eyes serve as beacons for lost creatures seeking the safety of growing things. They represent the Wild's commitment to giving every living thing multiple opportunities to survive and thrive.\n\n---",image:"images/9952.png"},
    "8284":{id:"8284",rank:4766,fur:"Black",pattern:"Tiger",eyes:"Round Glasses",clothes:"None",realm:"Ember Wastes",order:"Wild",hatColor:"Green",suggestedName:"Stripesight the Pattern Hunter",suggestedStory:"*Black Tiger | Round Glasses | None | Ember Wastes → Heartwood Spire*\n\nA black Tiger from the Ember Wastes whose solitary hunting instincts evolved into pattern-tracking abilities that serve the collective needs of forest ecosystems. Stripesight's black fur with faint stripe patterns creates perfect camouflage in burnt forest areas, while their round glasses help them see growth patterns in areas damaged by volcanic activity. They earned their green hat by tracking and cataloging every surviving seed in post-eruption wastelands.\n\nTheir specialty is Recovery Botany, identifying which plants will grow back naturally after disasters and which need magical assistance. Stripesight hunts not animals but opportunities for growth, stalking through damaged landscapes to find the hidden potential for renewal. Their Tiger instincts make them expert at finding the one perfect seed that can restart an entire ecosystem. They serve as the Wild's disaster response specialist, arriving at natural catastrophes to begin immediate restoration efforts.\n\n---",image:"images/8284.png"},
    "5374":{id:"5374",rank:5224,fur:"Black",pattern:"Spotted",eyes:"Red Eyes",clothes:"None",realm:"Deepwood",order:"Wild",hatColor:"Green",suggestedName:"Redsight the Spotted Tracker",suggestedStory:"*Black Spotted | Red Eyes | None | Deepwood → Heartwood Spire*\n\nA native Deepwood Wizard whose black coat with spots creates living camouflage that changes pattern based on surroundings. Redsight's red eyes, the rarest eye color, see heat signatures and life force simultaneously, making them the Wild's most effective tracker of both healthy and diseased plant life. They earned recognition by being the first to identify the Great Rot's early symptoms, tracking the corruption's spread through forest networks before it became visible to normal sight.\n\nTheir magic is Diagnostic Botany, identifying plant diseases, tracking the health of forest networks, and prescribing natural remedies for ecosystem problems. Redsight's spotted pattern acts as a living health map, with each spot corresponding to a different area of forest and changing color to reflect its condition. They serve as the Wild's medical specialist, making house calls to sick trees and prescribing growth treatments for damaged ecosystems.\n\n---",image:"images/5374.png"},
    "3826":{id:"3826",rank:5283,fur:"Orange",pattern:"Classic",eyes:"Green Eyes",clothes:"None",realm:"Violet Highlands",order:"Wild",hatColor:"Green",suggestedName:"Orangeheart the Classic Bridge",suggestedStory:"*Orange Classic | Green Eyes | None | Violet Highlands → Heartwood Spire*\n\nThe only orange-furred Wild Wizard, creating a visual connection between Wild green magic and Flame orange energy. Orangeheart's green eyes provide perfect color balance, while their Classic breeding brings Violet Highlands scholarship to nature magic. They specialize in Fire-Growth Symbiosis, understanding how forest fires create conditions for new growth, and managing controlled burns that rejuvenate ecosystems without causing lasting damage.\n\nTheir orange fur reflects and focuses flame energy, making them immune to natural fire while their green Order magic guides post-fire regeneration. Orangeheart serves as liaison between the Wild and Flame Orders, coordinating between destruction magic and growth magic to create planned renewal cycles. They prove that orange and green can work together when both serve the greater goal of healthy ecosystems.\n\n---",image:"images/3826.png"},
    "5177":{id:"5177",rank:5878,fur:"Gray",pattern:"Husky",eyes:"Black Eyes",clothes:"None",realm:"Frosthollow",order:"Wild",hatColor:"Green",suggestedName:"Frostgrow the Gray Endurer",suggestedStory:"*Gray Husky | Black Eyes | None | Frosthollow → Heartwood Spire*\n\nThe second Husky in the Wild Order, but where Frostbark specializes in cold-weather plants, Frostgrow focuses on plants that bridge seasonal transitions. Their gray fur provides perfect camouflage during the brief Frosthollow summers when snow melts to reveal the brown earth beneath. They earned their green hat by creating the migration gardens, rest stops with magical food sources that sustain animals during long journeys between breeding and wintering grounds.\n\nTheir magic is Transition Botany, plants that change their properties with the seasons, roots that remain active under ice, and seed dispersal systems that work in arctic conditions. Frostgrow maintains the green corridors that connect Frosthollow to other realms, ensuring that migrating creatures have food and shelter during the most vulnerable portions of their journeys. Their Husky endurance makes them ideal for the patient, long-term magic required to establish sustainable ecosystems in harsh climates.\n\n---",image:"images/5177.png"},
    "5538":{id:"5538",rank:7282,fur:"Gray",pattern:"Solid",eyes:"Black Eyes",clothes:"None",realm:"Sunward Heights",order:"Wild",hatColor:"Green",suggestedName:"Graystorm the Weather Walker",suggestedStory:"*Gray Solid | Black Eyes | None | Sunward Heights → Heartwood Spire*\n\nFrom the eternally sunny Sunward Heights, Graystorm brings understanding of what plants need when the sun doesn't shine. Their gray Solid fur contrasts sharply with their homeland's bright environment, marking them as different from their sun-loving neighbors. They earned their green hat during the Great Silence, when even the sun seemed dim, by keeping food plants alive through forty-nine hours of magical darkness.\n\nTheir magic is Weather-Independent Botany, plants that thrive regardless of weather conditions, root systems that store nutrients for extended dry periods, and agricultural techniques that work during storms, droughts, or unnatural darkness. Graystorm serves as the Wild's insurance policy against climate disasters, maintaining emergency food sources that remain productive when normal agriculture fails. Their gray appearance reflects their specialty in working with plants during gray, overcast conditions when other Wild Wizards' magic is weakest.\n\n---",image:"images/5538.png"},
    "9713":{id:"9713",rank:8952,fur:"Black",pattern:"Classic",eyes:"Black Eyes",clothes:"None",realm:"Violet Highlands",order:"Wild",hatColor:"Green",suggestedName:"Darkleaf the Shadow Grower",suggestedStory:"*Black Classic | Black Eyes | None | Violet Highlands → Heartwood Spire*\n\nThe least common Wild Wizard, ranking very low in the collection but serving a crucial role in the Order. Darkleaf's all-black appearance makes them nearly invisible in deep forest shadows, while their Classic stability provides the patience needed for deep-shade botany. They specialize in Under-Story Magic, the plants that grow beneath forest canopies, in the shadow of larger trees, creating the complex ecosystem layers that support forest health.\n\nTheir magic focuses on Symbiotic Growth, plants that support each other through root networks, leaf-litter cycles that enrich soil, and the delicate balance of competition and cooperation that keeps forests healthy. Darkleaf tends the forest floor, ensuring that nutrients cycle efficiently from fallen leaves back into growing trees. They prove that Wild magic doesn't require flashy displays, sometimes the most important growth happens quietly, in darkness, where only patient eyes can see.",image:"images/9713.png"},
    "8518":{id:"8518",rank:407,fur:"Black",pattern:"Tiger",eyes:"Yellow Eyes",clothes:"None",realm:"Ember Wastes",order:"Heart",hatColor:"Pink",suggestedName:"Goldstripe the Time Stalker",suggestedStory:"*Black Tiger | Yellow Eyes | None | Ember Wastes → Violet Citadel*\n\nThe second-rarest Arcane Wizard, a solitary Tiger whose hunting instincts evolved into something far more sophisticated: hunting through time itself. Goldstripe's black fur with golden stripes creates perfect camouflage in the shifting light-and-shadow patterns of temporal magic, while their yellow eyes see not just heat signatures but temporal signatures, the traces left by past and future events. They earned their purple hat by successfully stalking and observing the same historical moment from seventeen different temporal angles.\n\nTheir specialty is Temporal Archaeology, using time-sight magic to witness past events and gather information that was lost to conventional history. Goldstripe hunts lost knowledge the way other Tigers hunt prey, following temporal trails through layered time until they find the moment when crucial information was hidden or destroyed. They serve as the Arcane's historical investigator, solving mysteries that have been forgotten for centuries. Their solitary nature is perfect for time-diving, since temporal magic works best when practiced alone to avoid paradox complications.\n\n---",image:"images/8518.png"},
    "3406":{id:"3406",rank:912,fur:"Yellow",pattern:"Solid",eyes:"Blue Eyes",clothes:"Shirt",realm:"Sunward Heights",order:"Arcane",hatColor:"Purple",suggestedName:"Blueshirt the Dimensional Scholar",suggestedStory:"*Yellow Solid | Blue Eyes | Shirt | Sunward Heights → Violet Citadel*\n\nFrom the bright, simple Sunward Heights, where everything is one pure color and one pure truth, Blueshirt brings clarity to the complex theories of dimensional magic. Their yellow Solid fur creates perfect color purity, while their blue eyes provide a secondary focus for magical sight that doesn't interfere with their primary yellow resonance. The shirt they wear is woven from dimensional fabric, appearing solid from one angle, translucent from another, demonstrating their specialty in multi-dimensional perception.\n\nTheir magic focuses on Dimensional Mapping, charting the layers of reality that exist parallel to Pawtheon's normal dimension. Blueshirt's Solid nature provides the mental stability needed to explore alternate dimensions without losing track of which reality is home. They serve as the Arcane's specialist in dimensional travel and extra-dimensional storage, maintaining the Citadel's libraries that exist in folded space, containing far more knowledge than their physical size suggests.\n\n---",image:"images/3406.png"},
    "9234":{id:"9234",rank:2843,fur:"Black",pattern:"Spotted",eyes:"Black Eyes",clothes:"Scarf",realm:"Deepwood",order:"Arcane",hatColor:"Purple",suggestedName:"Shadowspot the Pattern Keeper",suggestedStory:"*Black Spotted | Black Eyes | Scarf | Deepwood → Violet Citadel*\n\nA Deepwood native whose spotted pattern serves as a living memory storage system. Shadowspot's black base color with dark spots creates patterns that shift and change to record observed information, while their scarf is woven from memory-silk that preserves important conversations in its fibers. They earned their purple hat by demonstrating that their spotted pattern could store and replay visual memories with perfect accuracy, creating a living archive of everything they've witnessed.\n\nTheir specialty is Memory Magic, storing experiences in physical patterns, sharing memories between individuals, and preserving important information in forms that can't be destroyed by conventional means. Each spot on their coat contains a different memory, accessible through touch-based magic that lets others experience past events from Shadowspot's perspective. They serve as the Arcane's living backup system, ensuring that crucial knowledge survives even if physical records are destroyed.\n\n---",image:"images/9234.png"},
    "8311":{id:"8311",rank:3893,fur:"Yellow",pattern:"Tiger",eyes:"Visor",clothes:"None",realm:"Ember Wastes",order:"Heart",hatColor:"Pink",suggestedName:"Goldvisor the Tiger Theorist",suggestedStory:"*Yellow Tiger | Visor | None | Ember Wastes → Violet Citadel*\n\nThe second Tiger in the Arcane Order, but where Goldstripe hunts through time, Goldvisor develops the theoretical frameworks that make temporal magic possible. Their yellow fur resonates with light-based magic, while their visor protects against the disorienting effects of working with multiple theoretical frameworks simultaneously. They earned recognition by developing the mathematical models that predict when temporal magic will succeed or cause paradoxes.\n\nTheir magic is Theoretical Arcane, creating the underlying principles that guide practical applications of complex magic. Goldvisor writes the textbooks that other Arcane Wizards study, developing new forms of ward magic and dimensional theory. Their Tiger instincts for patient stalking translate into methodical pursuit of theoretical breakthroughs that might take years to complete. The visor they wear displays magical equations and theoretical frameworks directly onto their field of vision.\n\n---",image:"images/8311.png"},
    "9301":{id:"9301",rank:3938,fur:"Yellow",pattern:"Solid",eyes:"Pink Eyes",clothes:"None",realm:"Sunward Heights",order:"Heart",hatColor:"Pink",suggestedName:"Rosegold the Pink Eyed Theorist",suggestedStory:"*Yellow Solid | Pink Eyes | None | Sunward Heights → Violet Citadel*\n\nThe second yellow Solid in the Arcane Order, but where Blueshirt focuses on dimensional magic, Rosegold specializes in the intersection between magical theory and emotional reality. Their pink eyes see the emotional components of magical energy, while their yellow Solid fur provides the clarity needed to analyze complex emotional patterns without being overwhelmed by them. They developed the theoretical framework for understanding how emotional energy affects magical efficiency.\n\nTheir specialty is Emotional Arcane, understanding how feelings influence magical outcomes, predicting which emotions will enhance or interfere with specific spells, and developing techniques for emotional regulation during complex magical work. Rosegold's research explains why some magical partnerships work perfectly while others fail catastrophically. They serve as the Arcane's specialist in group magic theory, developing the protocols that allow multiple Arcane Wizards to work together without their individual magical styles interfering with each other.\n\n---",image:"images/9301.png"},
    "5056":{id:"5056",rank:4059,fur:"Brown",pattern:"Tiger",eyes:"Visor",clothes:"None",realm:"Ember Wastes",order:"Arcane",hatColor:"Purple",suggestedName:"Brownvisor the Research Director",suggestedStory:"*Brown Tiger | Visor | None | Ember Wastes → Violet Citadel*\n\nThe third Tiger in the Arcane Order, completing the triangle of Tiger scholars who bring predatory focus to academic research. Brownvisor's brown fur provides perfect camouflage in library settings, while their visor displays research notes and magical formulas directly in their field of vision. They serve as the research coordinator for the most dangerous magical experiments, ensuring that Tiger reflexes protect researchers when theory meets practice.\n\nTheir magic is Experimental Arcane, testing new magical theories under controlled conditions, developing safety protocols for dangerous research, and coordinating between theoretical development and practical application. Brownvisor's Tiger instincts make them perfect for anticipating when magical experiments are about to go wrong, while their scholarly training provides the knowledge needed to prevent catastrophic failures. They maintain the Violet Citadel's restricted laboratories where the most dangerous magical research takes place.\n\n---",image:"images/5056.png"},
    "5240":{id:"5240",rank:4173,fur:"Gray",pattern:"Solid",eyes:"Sleepy Eyes",clothes:"None",realm:"Sunward Heights",order:"Arcane",hatColor:"Purple",suggestedName:"Graysleep the Dream Walker",suggestedStory:"*Gray Solid | Sleepy Eyes | None | Sunward Heights → Violet Citadel*\n\nThe third Solid from the Sunward Heights, but unlike their bright-colored colleagues, Graysleep specializes in magic that works during sleep and unconsciousness. Their gray fur provides neutrality that doesn't interfere with dream magic, while their permanently sleepy appearance reflects their specialty in unconscious mental states. They earned their purple hat by successfully entering and mapping the collective unconscious of an entire realm.\n\nTheir magic is Dream Arcane, working with sleeping minds, accessing memories that are only available during unconsciousness, and using dream logic to solve problems that defeat waking analysis. Graysleep spends most of their time asleep, conducting magical research in dream states where normal physical limitations don't apply. They serve as the Arcane's specialist in sleep magic and unconscious mental processes, proving that some forms of knowledge can only be accessed when the conscious mind steps aside.\n\n---",image:"images/5240.png"},
    "4994":{id:"4994",rank:4600,fur:"White",pattern:"Collie",eyes:"Red Eyes",clothes:"None",realm:"Deepwood",order:"Arcane",hatColor:"Purple",suggestedName:"Whitecoat the Collie Coordinator",suggestedStory:"*White Collie | Red Eyes | None | Deepwood → Violet Citadel*\n\nThe only Collie in the Arcane Order, bringing herding instincts to the challenge of organizing magical knowledge. Whitecoat's white fur and red eyes create striking visual contrast, while their Collie breeding provides the coordination skills needed to keep track of multiple complex research projects simultaneously. They earned recognition by successfully organizing the Violet Citadel's entire library system, ensuring that no knowledge is ever truly lost.\n\nTheir specialty is Information Herding, keeping track of how different pieces of knowledge relate to each other, ensuring that research findings are shared between appropriate parties, and preventing important discoveries from getting lost in the archives. Whitecoat treats knowledge like a flock that needs constant attention to prevent straying. Their red eyes track information pathways the way other Collies track animal movements, ensuring that the right knowledge reaches the right researcher at the right time.\n\n---",image:"images/4994.png"},
    "8342":{id:"8342",rank:4624,fur:"White",pattern:"Split",eyes:"Red Eyes",clothes:"None",realm:"Abyssal Reaches",order:"Heart",hatColor:"Pink",suggestedName:"Whiteheart the Split Researcher",suggestedStory:"*White Split | Red Eyes | None | Abyssal Reaches → Violet Citadel*\n\nFrom the realm of duality and diplomatic complexity, Whiteheart brings Split perspectives to magical research. Their white base color with subtle dual-toning reflects their ability to see both sides of theoretical debates, while their red eyes provide the emotional insight needed to understand why different researchers reach different conclusions from the same evidence. They specialize in research that requires considering multiple incompatible theories simultaneously.\n\nTheir magic is Paradox Arcane, working with magical theories that seem to contradict each other but are somehow both true. Whiteheart's Split nature lets them hold opposing ideas in their mind without resolving the contradiction, which is essential for understanding magic that operates according to paradoxical principles. They serve as the Arcane's specialist in theoretical problems that have no single correct answer, developing magical techniques that work precisely because they shouldn't work.\n\n---",image:"images/8342.png"},
    "9826":{id:"9826",rank:4845,fur:"Green",pattern:"Zombie",eyes:"Black Eyes",clothes:"None",realm:"Shadowmire",order:"Heart",hatColor:"Pink",suggestedName:"Greenbone the Chaos Scholar",suggestedStory:"*Green Zombie | Black Eyes | None | Shadowmire → Violet Citadel*\n\nThe only Shadowmire representative in the Arcane Order, bringing chaos magic principles to scholarly research. Greenbone's green Zombie fur creates a living connection to decay and transformation processes, while their black eyes see the order hidden within apparent chaos. They earned their purple hat by successfully cataloguing and organizing the Shadowmire's shapeshifting terrain, creating maps of a landscape that changes faster than maps can be drawn.\n\nTheir specialty is Chaos Theory Arcane, finding the hidden patterns in random events, predicting probable outcomes from chaotic systems, and developing magical techniques that harness randomness for controlled results. Greenbone's Zombie nature means they understand transformation from the inside, while their scholarly training provides the analytical tools needed to make chaos comprehensible. They serve as the Arcane's specialist in unpredictable magic and chaos-based systems.\n\n---",image:"images/9826.png"},
    "6095":{id:"6095",rank:5093,fur:"White",pattern:"Dalmatian",eyes:"Square Glasses",clothes:"None",realm:"Deepwood",order:"Arcane",hatColor:"Purple",suggestedName:"Dalmatianscript the Unique Scholar",suggestedStory:"*White Dalmatian | Square Glasses | None | Deepwood → Violet Citadel*\n\nThe collection's only Dalmatian Wizard, making them as unique among the 86 as their breed is among all dogs. Dalmatianscript's white coat with perfectly placed spots creates a living text where each spot represents a different piece of magical knowledge. Their square glasses focus not just vision but magical perception, allowing them to read the hidden texts that appear on surfaces throughout the Violet Citadel when illuminated by Umbra's light.\n\nTheir specialty is Textual Arcane, magic that works through written symbols, spells that are cast by writing rather than speaking, and the preservation of knowledge in forms that can survive any catastrophe. Each spot on their coat contains a different spell or piece of information, creating a living spellbook that can never be lost or destroyed. They serve as the Arcane's ultimate backup system, carrying the Order's most essential knowledge literally in their skin. Their unique breed status makes them a living reminder that knowledge takes many forms, some of which appear only once in history.\n\n---",image:"images/6095.png"},
    "9898":{id:"9898",rank:5299,fur:"Orange",pattern:"Classic",eyes:"Green Eyes",clothes:"None",realm:"Violet Highlands",order:"Arcane",hatColor:"Purple",suggestedName:"Orangeheart the Classic Bridge",suggestedStory:"*Orange Classic | Green Eyes | None | Violet Highlands → Violet Citadel*\n\nAn unusual color combination, orange Classic fur with green eyes, creating visual connections to multiple Orders simultaneously. Orangeheart serves as the Arcane's liaison to other Orders, using their orange fur to connect with Flame discipline and their green eyes to understand Wild magic theory. Their Classic breeding provides the diplomatic stability needed to translate between different magical philosophies without losing essential meaning.\n\nTheir magic is Translation Arcane, converting magical techniques from one discipline to another, finding the common theoretical foundations that underlie different Orders' approaches to magic, and developing hybrid techniques that combine multiple disciplines. Orangeheart's unusual coloring reflects their role as a bridge between different magical traditions. They serve as proof that Arcane magic works best when it integrates knowledge from all sources rather than pursuing isolated theoretical development.\n\n---",image:"images/9898.png"},
    "8154":{id:"8154",rank:5549,fur:"Gray",pattern:"Classic",eyes:"Square Glasses",clothes:"None",realm:"Violet Highlands",order:"Arcane",hatColor:"Purple",suggestedName:"Grayglasses the Foundation Scholar",suggestedStory:"*Gray Classic | Square Glasses | None | Violet Highlands → Violet Citadel*\n\nThe most typical-looking Arcane Wizard, gray Classic fur, square glasses, nothing flashy or distinctive. But Grayglasses represents the foundation of all Arcane magic: patient, methodical, thorough research into basic principles that support more advanced magical development. Their gray coloring provides perfect neutrality for magical experiments, while their square glasses focus their attention on precise details that more dramatic researchers might overlook.\n\nTheir magic is Foundation Arcane, establishing the basic principles that allow advanced magic to work, maintaining the ward systems that protect the Violet Citadel, and ensuring that experimental magic doesn't destabilize the fundamental forces that keep reality consistent. Grayglasses performs the unglamorous but essential work that makes spectacular magical achievements possible. They serve as the Arcane's most reliable researcher, producing steady progress on long-term projects that require decades of consistent effort.",image:"images/8154.png"},
    "4165":{id:"4165",rank:854,fur:"White",pattern:"Collie",eyes:"Pink Eyes",clothes:"Poncho",realm:"Deepwood",order:"Deep",hatColor:"Blue",suggestedName:"Pinkgaze the Emotional Seer",suggestedStory:"*White Collie | Pink Eyes | Poncho | Deepwood → Tidewatch*\n\nThe rarest Deep Wizard, whose Collie herding instincts evolved into something far more sophisticated: herding probable futures into manageable patterns. Pinkgaze's white fur reflects all magical energies without absorption, while their pink eyes see emotional currents flowing through time as clearly as water flowing through streams. The poncho they wear is woven from water-resistant fibers that repel both liquid water and liquid time, protecting them from temporal splash-back during deep scrying sessions.\n\nTheir specialty is Emotional Prophecy, predicting future events by tracking the emotional currents that drive decision-making. Pinkgaze sees that wars begin not with political tensions but with the accumulation of small angers, that great loves start with moments of unexpected kindness, that major discoveries emerge from curiosity about trivial details. They serve as the Deep's specialist in personal prophecy, helping individuals understand how their emotional choices will shape their futures. Their Collie instincts make them naturally protective of those they guide, ensuring that their prophecies serve to prevent suffering rather than merely predict it.\n\n---",image:"images/4165.png"},
    "9530":{id:"9530",rank:2023,fur:"White",pattern:"Bernard",eyes:"Black Eyes",clothes:"Shirt",realm:"Frosthollow",order:"Deep",hatColor:"Blue",suggestedName:"Bernardguard the Truth Keeper",suggestedStory:"*White Bernard | Black Eyes | Shirt | Frosthollow → Tidewatch*\n\nThe collection's only Bernard Wizard, embodying the perfect convergence of breed instinct and Order discipline. Bernards are the rescue breed, built for finding lost travelers in hostile conditions, carrying supplies to sustain life in crisis. Bernardguard earned their blue hat by successfully guiding a lost expedition through a blizzard to the Truth Mirror's location, then standing guard as each member looked into the mirror and faced what they truly were. Three members never spoke again. Two emerged transformed. One thanked Bernardguard and walked into the snow, never to be seen again.\n\nTheir magic is Guardian Prophecy, seeing the dangerous truths that people seek and determining whether they're strong enough to survive the knowledge they want. Bernardguard maintains permanent station at Frosthollow, serving as the final filter between seekers and the Truth Mirror. Their white fur provides camouflage in snow, while their black eyes see the truth-readiness in approaching souls. The shirt they wear carries supplies for those who emerge from the Truth Mirror needing immediate physical and emotional support. They have seen more truth than any other being in Pawtheon, yet their Bernard nature keeps them focused on helping others rather than being overwhelmed by knowledge.\n\n---",image:"images/9530.png"},
    "3557":{id:"3557",rank:3868,fur:"Yellow",pattern:"Tiger",eyes:"Yellow Eyes",clothes:"None",realm:"Ember Wastes",order:"Deep",hatColor:"Blue",suggestedName:"Goldstare the Solar Prophet",suggestedStory:"*Yellow Tiger | Yellow Eyes | None | Ember Wastes → Tidewatch*\n\nA Tiger from the volcanic Ember Wastes whose perfect yellow-on-yellow coloring creates unique resonance with light-based prophecy. Goldstare's solitary hunting instincts evolved into patient observation of probability patterns, while their yellow eyes see not just heat signatures but the thermal patterns of possible futures. They earned their blue hat during a volcanic eruption, when they successfully predicted the exact path of lava flows by reading the heat signatures of probability itself.\n\nTheir specialty is Solar Scrying, using concentrated sunlight as a medium for prophecy, reading futures in the patterns of light and shadow, and predicting events that will occur during daylight hours. Goldstare's Tiger nature makes them most powerful when working alone, avoiding the interference that group scrying sessions create. They serve as the Deep's daytime prophet, complementing colleagues who work better in darkness or underwater environments. Their perfect yellow coloring means they literally glow when channeling solar prophecy, becoming briefly too bright to look at directly.\n\n---",image:"images/3557.png"},
    "2634":{id:"2634",rank:4331,fur:"Black",pattern:"Split",eyes:"Mixed",clothes:"None",realm:"Abyssal Reaches",order:"Deep",hatColor:"Blue",suggestedName:"Mixedsight the Paradox Prophet",suggestedStory:"*Black Split | Mixed Eyes | None | Abyssal Reaches → Tidewatch*\n\nFrom the realm of duality and impossible perspectives, Mixedsight brings Split double-vision to prophecy magic. Their black Split fur creates perfect contrast patterns, while their mixed-color eyes see different aspects of the same future simultaneously. One eye sees what will happen if current trends continue; the other sees what will happen if key variables change. They earned their blue hat by successfully predicting both outcomes of a major political crisis, then watching both futures occur simultaneously in parallel timeline streams.\n\nTheir specialty is Paradox Prophecy, seeing futures that contradict each other but are somehow both true, predicting the unpredictable moments when reality splits into multiple valid possibilities, and navigating the temporal confusion that results when multiple timelines converge. Mixedsight's Split nature lets them experience contradictory visions without mental strain, while their mixed eyes track multiple probability streams simultaneously. They serve as the Deep's specialist in crisis prophecy, predicting the moments when normal cause-and-effect breaks down and multiple futures become possible.\n\n---",image:"images/2634.png"},
    "4742":{id:"4742",rank:5050,fur:"White",pattern:"Blotted",eyes:"Sleepy Eyes",clothes:"None",realm:"Shadowmire",order:"Deep",hatColor:"Blue",suggestedName:"Blottedmist the Chaos Seer",suggestedStory:"*White Blotted | Sleepy Eyes | None | Shadowmire → Tidewatch*\n\nFrom the ever-changing Shadowmire, Blottedmist brings chaos magic principles to prophecy work. Their white base color with irregular blotting provides perfect camouflage in situations where normal pattern-recognition fails, while their sleepy eyes mask intense concentration on probability patterns that shift too rapidly for normal observation. They earned recognition by successfully predicting events in the Shadowmire's shapeshifting terrain, where normal prophecy magic fails because the landscape changes faster than visions can form.\n\nTheir magic is Chaos Prophecy, predicting the unpredictable, finding pattern in randomness, and reading futures in systems too complex for conventional analysis. Blottedmist's blotted pattern changes to reflect the probability patterns they're currently tracking, creating a living map of chaos magic systems. Their sleepy appearance masks hyperactive mental processes that must track thousands of shifting variables simultaneously. They serve as the Deep's specialist in impossible predictions, seeing futures that shouldn't be possible but somehow occur anyway.\n\n---",image:"images/4742.png"},
    "6135":{id:"6135",rank:5309,fur:"Blue",pattern:"Classic",eyes:"Visor",clothes:"None",realm:"Violet Highlands",order:"Deep",hatColor:"Blue",suggestedName:"Bluevisor the Technology Prophet",suggestedStory:"*Blue Classic | Visor | None | Violet Highlands → Tidewatch*\n\nThe only blue-furred Deep Wizard, creating perfect color resonance between their coat and their Order's discipline. Bluevisor's visor displays not just current information but probability projections and timeline analysis, turning their field of vision into a real-time prophecy interface. They earned their position by developing new techniques for technological prophecy, predicting not just what will happen, but what inventions and magical developments will make it possible.\n\nTheir specialty is Innovation Prophecy, seeing the future discoveries that will change how magic works, predicting which experimental technologies will succeed, and preparing for the social changes that new magical capabilities will create. Bluevisor's Classic stability provides the mental framework needed to process rapidly changing technological possibilities without being overwhelmed by infinite potential. They serve as the Deep's technology advisor, ensuring that the Order stays ahead of magical developments that might affect prophecy accuracy.\n\n---",image:"images/6135.png"},
    "5516":{id:"5516",rank:5977,fur:"White",pattern:"Classic",eyes:"Black Eyes",clothes:"Collar",realm:"Violet Highlands",order:"Deep",hatColor:"Blue",suggestedName:"Whiteguard the Shield Prophet",suggestedStory:"*White Classic | Black Eyes | Collar | Violet Highlands → Tidewatch*\n\nA defensive specialist whose white fur reflects magical attacks while their black eyes see the aggressive intentions behind them. Whiteguard's collar is woven from ward-silk that provides protection against psychic attacks, essential equipment for a prophet who must look into the minds of those planning violence. They earned their blue hat by successfully predicting and preventing a series of assassination attempts during the post-Loyalty Wars period, using prophecy magic to identify threats before they became action.\n\nTheir magic is Protective Prophecy, seeing dangers before they manifest, predicting attacks in time to prepare defenses, and using future-sight to guide protective magic. Whiteguard's white fur makes them highly visible, but this actually enhances their protective role by serving as a beacon for those seeking safety. Their black eyes provide stark contrast that helps them focus on dark intentions and hidden threats. They serve as the Deep's security specialist, using prophecy to protect other Wizards from those who would harm them for their knowledge.\n\n---",image:"images/5516.png"},
    "6232":{id:"6232",rank:6043,fur:"Yellow",pattern:"Solid",eyes:"Black Eyes",clothes:"None",realm:"Sunward Heights",order:"Deep",hatColor:"Blue",suggestedName:"Goldsolid the Pure Prophet",suggestedStory:"*Yellow Solid | Black Eyes | None | Sunward Heights → Tidewatch*\n\nFrom the realm of pure colors and simple truths, Goldsolid brings Solid-breed clarity to the complex art of prophecy. Their yellow Solid fur creates perfect color purity with no distracting patterns, while their black eyes provide absolute focus on single-thread futures without the complications that multi-colored eyes create. They specialize in Simple Prophecy, clear, unambiguous visions of straightforward futures with minimal complications.\n\nTheir magic focuses on Pure Truth Prophecy, seeing futures without interpretation, bias, or wishful thinking. Goldsolid's visions are shorter but more accurate than other prophets', focusing on specific moments rather than complex storylines. Their Solid nature means they see one future at a time rather than the multiple probability streams that confuse other Deep Wizards. They serve as the Order's specialist in direct, actionable prophecy that can guide immediate decision-making without requiring extensive interpretation.\n\n---",image:"images/6232.png"},
    "6597":{id:"6597",rank:6539,fur:"Black",pattern:"Classic",eyes:"Square Glasses",clothes:"None",realm:"Violet Highlands",order:"Deep",hatColor:"Blue",suggestedName:"Blackglasses the Archive Prophet",suggestedStory:"*Black Classic | Square Glasses | None | Violet Highlands → Tidewatch*\n\nA scholarly prophet whose black fur absorbs magical energy without reflection, while their square glasses focus on detailed analysis of specific future events rather than broad prophetic sweeps. Blackglasses earned their position by developing techniques for archival prophecy, not just seeing what will happen, but creating permanent records of prophetic visions that can be studied and referenced later.\n\nTheir specialty is Documentation Prophecy, creating detailed, searchable records of prophetic visions, cross-referencing predictions to identify patterns in future-events, and maintaining the Deep's prophetic archives. Blackglasses' Classic stability provides the patience needed for long-term prophetic research, while their black fur helps them blend into the Tidewatch's underground environment. They serve as the Deep's institutional memory, ensuring that important prophecies aren't forgotten or misinterpreted over time.\n\n---",image:"images/6597.png"},
    "7257":{id:"7257",rank:7436,fur:"Gray",pattern:"Classic",eyes:"Sleepy Eyes",clothes:"None",realm:"Violet Highlands",order:"Deep",hatColor:"Blue",suggestedName:"Graydreamer the Sleep Prophet",suggestedStory:"*Gray Classic | Sleepy Eyes | None | Violet Highlands → Tidewatch*\n\nA Classic whose permanently sleepy appearance reflects their specialty in dream-state prophecy and unconscious vision work. Graydreamer's gray fur provides perfect neutrality for dream magic, while their sleepy eyes are actually processing multiple layers of prophetic information simultaneously. They earned recognition by successfully maintaining continuous prophetic surveillance through extended sleep periods, providing 24-hour future monitoring.\n\nTheir magic is Dream Prophecy, seeing futures through prophetic dreams, accessing visions that only appear during unconscious states, and maintaining prophetic awareness even while asleep. Graydreamer spends most of their time in controlled sleep states, conducting prophetic research in dream realms where normal physical limitations don't interfere with future-sight. They serve as the Deep's night shift, ensuring that prophetic monitoring continues even when other Wizards are sleeping.\n\n---",image:"images/7257.png"},
    "1841":{id:"1841",rank:8023,fur:"Orange",pattern:"Classic",eyes:"Black Eyes",clothes:"None",realm:"Violet Highlands",order:"Deep",hatColor:"Blue",suggestedName:"Blue Beard the Bridge Prophet",suggestedStory:"*Orange Classic | Black Eyes | None | Violet Highlands → Tidewatch*\n\nAn unusual color combination for the Deep Order, orange Classic fur creating visual connection to Flame magic while practicing water-based prophecy. Orangeclassic serves as liaison between the Deep and Flame Orders, using their orange coloring to understand how fire magic will develop and evolve. Their black eyes provide the focus needed to see through the distraction of contradictory magical resonances.\n\nTheir specialty is Cross-Order Prophecy, predicting how different magical disciplines will interact, seeing futures that depend on cooperation between Orders, and identifying potential conflicts before they develop into serious problems. Orangeclassic's unusual coloring reflects their role in bridging between different magical traditions. They serve as proof that Deep magic works best when it considers all possible influences rather than focusing solely on water-based systems.\n\n---",image:"images/1841.png"},
    "3417":{id:"3417",rank:9083,fur:"Orange",pattern:"Classic",eyes:"Black Eyes",clothes:"None",realm:"Violet Highlands",order:"Deep",hatColor:"Blue",suggestedName:"Orangeshield the Flame Prophet",suggestedStory:"*Orange Classic | Black Eyes | None | Violet Highlands → Tidewatch*\n\nThe second orange-furred Deep Wizard, but where Orangeclassic focuses on Order relations, Orangeshield specializes in fire-related prophecy. Their orange fur creates sympathetic resonance with fire magic, allowing them to predict volcanic eruptions, magical fire accidents, and Flame Order activities with unusual accuracy. Their black eyes provide the cool focus needed to observe fire futures without being overwhelmed by their intensity.\n\nTheir magic is Elemental Opposition Prophecy, using water magic to predict fire events, finding the points where opposing forces create prophetic clarity, and reading futures in the tension between incompatible elements. Orangeshield's orange coloring shouldn't work with water magic, but the contradiction actually enhances their prophetic ability by providing unique perspective on elemental interactions. They serve as early warning system for fire-related disasters throughout Pawtheon.\n\n---",image:"images/3417.png"},
    "7226":{id:"7226",rank:9172,fur:"Tan",pattern:"Classic",eyes:"Black Eyes",clothes:"None",realm:"Violet Highlands",order:"Deep",hatColor:"Blue",suggestedName:"Tanwatcher the Patient Prophet",suggestedStory:"*Tan Classic | Black Eyes | None | Violet Highlands → Tidewatch*\n\nThe lowest-ranking Deep Wizard, but ranking means nothing when prophecy is the goal. Tanwatcher's tan Classic fur provides perfect camouflage in earthtone environments, while their black eyes maintain absolute focus on long-term prophetic patterns that other Wizards find too boring to track. They specialize in Patient Prophecy, following probability threads for years or decades to see how small changes create major outcomes.\n\nTheir magic focuses on Long-Term Vision, seeing the consequences of current decisions decades into the future, tracking the slow development of major historical changes, and maintaining prophetic vigilance over trends too gradual for other prophets to notice. Tanwatcher's Classic stability provides the mental endurance needed for prophetic projects that span multiple lifetimes. They serve as the Deep's specialist in civilizational prophecy, predicting the rise and fall of governments, cultural changes, and the long-term consequences of magical development.",image:"images/7226.png"},
    "9684":{id:"9684",rank:66,fur:"White",pattern:"Blotted",eyes:"Yellow Eyes",clothes:"Shirt",realm:"Shadowmire",order:"Radiant",hatColor:"Yellow",suggestedName:"Goldblot the Luminous Shadow",suggestedStory:"*White Blotted | Yellow Eyes | Shirt | Shadowmire → Solar Spire*\n\nThe rarest Radiant Wizard and the greatest paradox in the Order. A Blotted from the dark Shadowmire practicing the magic of absolute light. Goldblot's white base color with chaotic dark blotting creates the perfect canvas for light magic, the blots absorb and concentrate solar energy while the white fur reflects and amplifies it. Their yellow eyes match their Order's color perfectly, while the shirt they wear is woven from light-capturing fibers that glow softly in darkness.\n\nTheir magic is Shadow-Light Synthesis, using darkness to define light, creating illumination that is only visible in contrast to shadow, and purifying corruption by burning it away from the inside. Goldblot's blotted pattern shifts to concentrate light magic in the most effective configurations, while their Shadowmire heritage makes them immune to the corruption they're fighting. They serve as the Radiant's specialist in corruption purification, proving that sometimes the best weapon against darkness is light that understands shadow.\n\n---",image:"images/9684.png"},
    "9604":{id:"9604",rank:277,fur:"Beige",pattern:"Classic",eyes:"Black Eyes",clothes:"Lumberjack",realm:"Violet Highlands",order:"Radiant",hatColor:"Yellow",suggestedName:"Beigelumber the Worker's Light",suggestedStory:"*Beige Classic | Black Eyes | Lumberjack | Violet Highlands → Solar Spire*\n\nA working-class Classic whose beige fur and lumberjack outfit mark them as different from the typical scholarly atmosphere of both their home realm and their Order. Beigelumber earned their yellow hat not through theoretical study but through practical application, using light magic to guide rescue operations in collapsed buildings, providing illumination for emergency medical procedures, and creating light-based tools for construction work.\n\nTheir magic is Practical Radiance, light that serves immediate, useful purposes rather than dramatic displays. Beigelumber's solar magic focuses into precise tools: light-blades for cutting, light-ropes for lifting, light-shields for protection. Their lumberjack background means they understand that the best magic is magic that gets work done. They serve as the Radiant's specialist in utility magic, proving that purification and revelation can be as simple as providing light when people need to see clearly.\n\n---",image:"images/9604.png"},
    "9469":{id:"9469",rank:464,fur:"White",pattern:"Blotted",eyes:"Sleepy Eyes",clothes:"None",realm:"Shadowmire",order:"Radiant",hatColor:"Yellow",suggestedName:"Whitemist the Sleepy Purifier",suggestedStory:"*White Blotted | Sleepy Eyes | None | Shadowmire → Solar Spire*\n\nThe second Shadowmire Wizard in the Radiant Order, but where Goldblot works with shadow-light synthesis, Whitemist specializes in gentle purification that works while the patient sleeps. Their white base color with soft blotting creates perfect channels for healing light, while their permanently sleepy appearance reflects their specialty in unconscious purification magic.\n\nTheir magic is Dream Purification, cleansing corruption, fear, and negative emotions while the subject sleeps, removing magical contamination without the pain that conscious purification causes, and healing trauma through gentle dream-light therapy. Whitemist's sleepy nature allows them to work in dream states where purification magic is more effective and less traumatic. They serve as the Radiant's medical specialist, providing healing that works through rest and gentle revelation rather than dramatic intervention.\n\n---",image:"images/9469.png"},
    "7833":{id:"7833",rank:1025,fur:"Bronze",pattern:"Shiny",eyes:"Black Eyes",clothes:"Sport Hoodie",realm:"Shadowmire",order:"Radiant",hatColor:"Yellow",suggestedName:"Bronzebeacon the Shiny Light",suggestedStory:"*Bronze Shiny | Black Eyes | Sport Hoodie | Shadowmire → Solar Spire*\n\nThe collection's only Shiny Wizard, making them as unique among the 86 as their breed is among all dogs. Bronzebeacon's metallic bronze fur literally glows with its own light, while their sport hoodie suggests an active, dynamic approach to light magic that matches their role as beacon-keeper in the dark Shadowmire. Their black eyes provide stark contrast to their glowing fur, creating perfect focus for directing concentrated light magic.\n\nTheir specialty is Beacon Magic, creating permanent points of light that guide lost travelers, establishing magical lighthouses that pierce any darkness, and maintaining the illumination network that makes navigation possible in lightless environments. Bronzebeacon's Shiny nature means their light never dims, never flickers, never fails. They serve as the Radiant's most reliable source of constant illumination, proving that some lights burn forever because they were meant to.\n\n---",image:"images/7833.png"},
    "9396":{id:"9396",rank:2131,fur:"Tan",pattern:"Husky",eyes:"Black Eyes",clothes:"Collar",realm:"Frosthollow",order:"Radiant",hatColor:"Yellow",suggestedName:"Tancollar the Diplomatic Light",suggestedStory:"*Tan Husky | Black Eyes | Collar | Frosthollow → Solar Spire*\n\nA Husky from ice-realm Frosthollow practicing sun magic, another example of the productive tension between breed instinct and Order discipline. Tancollar's tan fur provides earth-tone grounding for solar energy, while their collar is woven from sun-crystal fibers that store daylight for use during Frosthollow's long winter nights. They earned their yellow hat by successfully establishing the first permanent light-beacon in the deepest arctic regions.\n\nTheir magic is Cold Light, solar energy that provides illumination and warmth without the heat that would melt delicate ice formations. Tancollar's Husky endurance makes them ideal for maintaining light-sources in the harshest conditions, while their diplomatic training (suggested by the collar) makes them effective at negotiating agreements between sun-magic and ice-realm cultures. They serve as the Radiant's arctic specialist, bringing light to places where normal solar magic would be either impossible or destructive.\n\n---",image:"images/9396.png"},
    "5381":{id:"5381",rank:2521,fur:"Pink",pattern:"Classic",eyes:"Black Eyes",clothes:"Tracksuit",realm:"Violet Highlands",order:"Radiant",hatColor:"Yellow",suggestedName:"Roseclassic the Pink Diplomat",suggestedStory:"*Pink Classic | Black Eyes | Tracksuit | Violet Highlands → Solar Spire*\n\nAn unusual color for any Order, pink Classic fur creating visual connection to Heart magic while practicing Radiant discipline. Roseclassic's tracksuit marks them as athletic and active, suggesting dynamic rather than contemplative light magic. They earned recognition by developing techniques for Emotional Purification, using light magic to cleanse negative emotions rather than just revealing truth.\n\nTheir magic is Gentle Radiance, purification that heals rather than burns, light that reveals truth gradually rather than blindingly, and illumination that comforts rather than exposes. Roseclassic's pink coloring reflects their specialty in compassionate revelation, showing people their flaws in ways that encourage growth rather than causing shame. They serve as the Radiant's specialist in therapeutic truth-magic, proving that revelation can be kind without being weak.\n\n---",image:"images/5381.png"},
    "7731":{id:"7731",rank:2866,fur:"Beige",pattern:"Classic",eyes:"Black Eyes",clothes:"Shirt",realm:"Violet Highlands",order:"Radiant",hatColor:"Yellow",suggestedName:"Beigelight the Steady Illuminator",suggestedStory:"*Beige Classic | Black Eyes | Shirt | Violet Highlands → Solar Spire*\n\nThe second beige Classic in the Radiant Order, but where Beigelumber focuses on practical applications, Beigelight specializes in sustained illumination for scholarly work. Their beige fur provides perfect neutrality for extended magical work, while the shirt they wear contains light-gathering threads that store solar energy for nighttime use.\n\nTheir magic is Scholarly Radiance, steady, reliable light for reading and research, illumination that doesn't interfere with delicate magical experiments, and truth-magic that reveals information gradually rather than overwhelming researchers with sudden insights. Beigelight serves as the Radiant's academic specialist, providing the consistent, reliable light that makes detailed scholarly work possible. Their steady nature makes them ideal for projects requiring years of patient illumination.\n\n---",image:"images/7731.png"},
    "9025":{id:"9025",rank:3879,fur:"Gray",pattern:"Split",eyes:"Red Eyes",clothes:"None",realm:"Abyssal Reaches",order:"Radiant",hatColor:"Yellow",suggestedName:"Grayheart the Split Revealer",suggestedStory:"*Gray Split | Red Eyes | None | Abyssal Reaches → Solar Spire*\n\nFrom the realm of duality and complex perspectives, Grayheart brings Split vision to revelation magic. Their gray base color with subtle split-toning provides perfect neutrality for truth-magic, while their red eyes see emotional truth as clearly as factual truth. They specialize in Diplomatic Revelation, showing people uncomfortable truths in ways that promote understanding rather than conflict.\n\nTheir magic focuses on Balanced Truth, revealing both sides of complex situations, showing how apparent contradictions can both be true, and using light magic to illuminate the common ground hidden beneath surface disagreements. Grayheart's Split nature lets them understand multiple perspectives simultaneously, while their red eyes track the emotional dynamics that determine whether revealed truth will be accepted or rejected. They serve as the Radiant's specialist in conflict resolution through enlightenment.\n\n---",image:"images/9025.png"},
    "6203":{id:"6203",rank:4781,fur:"Tan",pattern:"Husky",eyes:"Sleepy Eyes",clothes:"None",realm:"Frosthollow",order:"Radiant",hatColor:"Yellow",suggestedName:"Sleepytan the Dream Revealer",suggestedStory:"*Tan Husky | Sleepy Eyes | None | Frosthollow → Solar Spire*\n\nThe second Husky in the Radiant Order, but where Tancollar focuses on arctic light-magic, Sleepytan specializes in revelation that occurs during rest and unconsciousness. Their tan fur provides earth-tone stability for dream-work, while their permanently sleepy appearance reflects their specialty in unconscious truth-revelation.\n\nTheir magic is Sleep Revelation, showing people important truths through prophetic dreams, cleansing false beliefs while the subject sleeps, and providing gentle enlightenment that doesn't disturb daily life. Sleepytan's Husky endurance makes them ideal for maintaining dream-magic over extended periods, while their sleepy nature allows them to work in unconscious states where revelation is less traumatic. They serve as the Radiant's dream specialist, providing truth-magic that works through rest rather than confrontation.\n\n---",image:"images/6203.png"},
    "9183":{id:"9183",rank:5726,fur:"White",pattern:"Split",eyes:"Pink Eyes",clothes:"None",realm:"Abyssal Reaches",order:"Radiant",hatColor:"Yellow",suggestedName:"Whiteheart the Pink Eyed Illuminator",suggestedStory:"*White Split | Pink Eyes | None | Abyssal Reaches → Solar Spire*\n\nA Split from the diplomatic Abyssal Reaches whose white fur and pink eyes create perfect harmony for compassionate revelation magic. Whiteheart's white base color reflects all forms of light without absorption, while their pink eyes see the emotional impact of revealed truth. They specialize in Truth with Mercy, showing people difficult truths in ways that encourage growth rather than despair.\n\nTheir magic is Compassionate Radiance, light that reveals truth gradually, purification that heals rather than burns, and illumination that shows both problems and solutions simultaneously. Whiteheart's Split nature helps them balance truth-telling with kindness, while their pink eyes ensure that their revelations serve healing rather than judgment. They serve as the Radiant's specialist in therapeutic truth-magic for individuals dealing with personal crises.\n\n---",image:"images/9183.png"},
    "4458":{id:"4458",rank:5746,fur:"White",pattern:"Split",eyes:"Square Glasses",clothes:"None",realm:"Abyssal Reaches",order:"Radiant",hatColor:"Yellow",suggestedName:"Whiteglasses the Precision Revealer",suggestedStory:"*White Split | Square Glasses | None | Abyssal Reaches → Solar Spire*\n\nThe second white Split in the Radiant Order, but where Whiteheart focuses on emotional aspects of revelation, Whiteglasses specializes in precise, detailed truth-magic. Their square glasses focus light magic into exact measurements and specific details rather than broad illumination. They earned recognition by developing techniques for Forensic Radiance, using light magic to reveal exactly what happened in complex situations.\n\nTheir magic is Precision Truth, illuminating specific facts rather than general truths, revealing exact details that solve mysteries, and providing the focused light needed for detailed investigation work. Whiteglasses serves as the Radiant's specialist in investigative magic, using light to reveal evidence that conventional investigation methods miss. Their Split nature helps them see all sides of complex situations, while their glasses ensure that no important detail is overlooked.\n\n---",image:"images/4458.png"},
    "3186":{id:"3186",rank:9281,fur:"Brown",pattern:"Classic",eyes:"Black Eyes",clothes:"None",realm:"Violet Highlands",order:"Radiant",hatColor:"Yellow",suggestedName:"Brownheart the Common Light",suggestedStory:"*Brown Classic | Black Eyes | None | Violet Highlands → Solar Spire*\n\nThe least rare Wizard in the entire Order of 86, ranking 9,281 out of 10,000, more common than 92.8% of all Doginal Dogs. Yet Brownheart practices the magic of absolute truth and divine light. Their brown Classic fur is completely ordinary, their black eyes provide simple focus, and they wear no distinctive clothing or accessories. They are the most unremarkable-looking being practicing the most remarkable magic.\n\nTheir power lies not in spectacular displays but in Simple Truth, basic, honest light that reveals reality without interpretation or complication. Brownheart's magic doesn't blind or overwhelm; it simply shows things as they actually are. Their ordinary appearance makes them approachable to common dogs who would be intimidated by more dramatic Radiant Wizards. They serve as the Order's connection to everyday truth-telling, proving that the most important light isn't the brightest, it's the most reliable. When other Radiant magic fails, Brownheart's simple illumination still works.",image:"images/3186.png"},
    "9089":{id:"9089",rank:46,fur:"Black",pattern:"Split",eyes:"Red Eyes",clothes:"Tracksuit",realm:"Abyssal Reaches",order:"Heart",hatColor:"Pink",suggestedName:"Raredheart the Ultimate Amplifier",suggestedStory:"*Black Split | Red Eyes | Tracksuit | Ball | Abyssal Reaches → Heartstring Tower*\n\nThe rarest Wizard in the Order of 86. The rarest Wizard in the entire Doginal Dogs collection. And they're Heart. A Black Split from the Abyssal Reaches, the realm of duality and impossible perspectives, wearing a Tracksuit (one of the very few clothed Wizards) and carrying a Ball (unique among all 86). Red eyes in a black face, the rarest eye color combined with the starkest fur contrast.\n\nRaredheart's incredible rarity translates to raw magical potential that terrifies even experienced Wizards. When they join a pack cast, the multiplicative effect of Heart magic reaches levels that could reshape reality itself. Their Red eyes, the rarest eye color among the Wizards, see emotional bonds as physical threads, visible and tangible as rope or wire. Their Split heritage lets them experience multiple emotional perspectives simultaneously, while their black fur absorbs and concentrates emotional energy from everyone around them.\n\nThe Tracksuit marks them as deliberately casual, rejecting the solemnity that most Wizards affect. The Ball suggests playfulness, youth, or perhaps the wisdom to remember that joy is the highest form of love. Their presence at the Heartstring Tower makes the entire structure pulse stronger, and their emotional range, from childlike wonder to cosmic empathy, drives their Order-mates to heights of magical power they never imagined possible. The most powerful entity in the Caninosphere carries a ball and wears a tracksuit. That's not a contradiction, that's the point.\n\n---",image:"images/9089.png"},
    "2855":{id:"2855",rank:5958,fur:"Brown",pattern:"Solid",eyes:"Black Eyes",clothes:"None",realm:"Sunward Heights",order:"Heart",hatColor:"Pink",suggestedName:"Glassesheart the Scholarly Amplifier",suggestedStory:"*Gray Classic | Square Glasses | Collar | Violet Highlands → Heartstring Tower*\n\nFrom the academic Violet Highlands, Glassesheart brings scholarly analysis to the intuitive magic of emotional bonds. Their square glasses focus not just vision but emotional perception, allowing them to study the mathematical principles underlying bond magic. The collar they wear is woven from empathy-silk that responds to emotional changes in their environment, serving as both magical focus and emotional barometer.\n\nTheir magic is Analytical Empathy, understanding exactly why emotional bonds form, predicting which relationships will strengthen or weaken over time, and optimizing pack configurations for maximum magical efficiency. Glassesheart's Classic stability provides the mental framework needed to study emotions without being overwhelmed by them, while their scholarly training brings scientific rigor to a discipline that usually relies on intuition. They serve as the Heart's theorist, developing the principles that guide practical bond magic.\n\n---",image:"images/2855.png"},
    "3735":{id:"3735",rank:7823,fur:"Pink",pattern:"Classic",eyes:"Black Eyes",clothes:"None",realm:"Violet Highlands",order:"Heart",hatColor:"Pink",suggestedName:"Tancollar the Steady Bond",suggestedStory:"*Tan Classic | Black Eyes | Collar | Violet Highlands → Heartstring Tower*\n\nThe second Classic in the Heart Order, but where Glassesheart focuses on theory, Tancollar specializes in long-term relationship maintenance. Their tan fur provides earth-tone stability for sustained emotional magic, while their collar contains memory-threads that preserve important emotional moments between bonded individuals.\n\nTheir magic is Relationship Maintenance, strengthening bonds that have weakened over time, helping partners rediscover what they originally loved about each other, and preventing small emotional problems from becoming major conflicts. Tancollar's Classic nature provides the patience needed for relationship work that might take years to complete. They serve as the Heart's counselor, helping individuals and groups work through emotional difficulties that interfere with magical cooperation.\n\n---",image:"images/3735.png"},
    "6502":{id:"6502",rank:7031,fur:"White",pattern:"Collie",eyes:"Black Eyes",clothes:"None",realm:"Deepwood",order:"Arcane",hatColor:"Purple",suggestedName:"Sleepyheart the Dream Bonder",suggestedStory:"*Tan Classic | Sleepy Eyes | None | Violet Highlands → Heartstring Tower*\n\nThe third Classic in the Heart Order, specializing in emotional bonds that form during sleep and unconscious states. Their tan fur provides neutrality for dream-work, while their permanently sleepy appearance reflects their specialty in unconscious bonding magic. They earned recognition by successfully maintaining pack bonds between Wizards who were too traumatized by the Loyalty Wars to work together while awake.\n\nTheir magic is Dream Bonding, creating emotional connections through shared dreams, healing relationship trauma while subjects sleep, and maintaining pack cohesion when conscious tensions make cooperation impossible. Sleepyheart spends most of their time in controlled sleep states, working in dream realms where emotional barriers are lowered and healing can occur more easily. They serve as the Heart's specialist in trauma recovery and unconscious emotional healing.\n\n---",image:"images/6502.png"},
    "4650":{id:"4650",rank:7071,fur:"Tan",pattern:"Solid",eyes:"Black Eyes",clothes:"None",realm:"Sunward Heights",order:"Arcane",hatColor:"Purple",suggestedName:"Brownheart the Stable Amplifier",suggestedStory:"*Brown Classic | Black Eyes | None | Violet Highlands → Heartstring Tower*\n\nThe fourth Classic in the Heart Order, demonstrating that steady, reliable breeds are naturally suited to bond magic that requires long-term commitment. Brownheart's brown fur provides earth-tone grounding for emotional magic, while their black eyes maintain focus on individual relationships rather than getting overwhelmed by group dynamics.\n\nTheir magic is Steady Amplification, providing consistent emotional support that doesn't fluctuate with circumstances, maintaining stable magical amplification even during crisis periods, and serving as emotional anchor for more volatile pack members. Brownheart's reliability makes them the Heart Wizard that others turn to when they need emotional stability rather than dramatic magical effects. They serve as the Order's foundation, proving that the most important bond magic is quiet, consistent, and utterly dependable.\n\n---",image:"images/4650.png"},
    "7439":{id:"7439",rank:5732,fur:"Yellow",pattern:"Solid",eyes:"Black Eyes",clothes:"None",realm:"Sunward Heights",order:"Arcane",hatColor:"Purple",suggestedName:"Sleepyhusky the Gentle Endurer",suggestedStory:"*Tan Husky | Sleepy Eyes | None | Frosthollow → Heartstring Tower*\n\nA Husky from the harsh arctic realm practicing the magic of gentle emotional connection. Sleepyhusky's tan fur provides warmth-tones that contrast with their ice-realm heritage, while their sleepy eyes mask the intense emotional endurance that Husky breeds bring to pack work. They earned their pink hat by maintaining pack bonds during the longest winter in Frosthollow's recorded history, when isolation and darkness threatened to break every social connection in the realm.\n\nTheir magic is Endurance Bonding, emotional connections that survive any hardship, pack magic that grows stronger under pressure, and the patient love that outlasts any crisis. Sleepyhusky's Husky heritage provides the emotional stamina needed for relationship work in the harshest conditions, while their sleepy nature allows them to conserve emotional energy for when it's most needed. They serve as the Heart's specialist in crisis bonding, proving that the gentlest magic is sometimes the strongest.\n\n---",image:"images/7439.png"},
    "6198":{id:"6198",rank:6042,fur:"Gray",pattern:"Tiger",eyes:"Black Eyes",clothes:"None",realm:"Ember Wastes",order:"Arcane",hatColor:"Purple",suggestedName:"Blackhusky the Shadow Amplifier",suggestedStory:"*Black Husky | Sleepy Eyes | None | Frosthollow → Heartstring Tower*\n\nThe second Husky in the Heart Order, but where Sleepyhusky focuses on endurance, Blackhusky specializes in amplifying the hidden emotional strengths that people don't know they possess. Their black fur absorbs and concentrates emotional energy, while their sleepy eyes see the dormant potential in damaged or discouraged individuals.\n\nTheir magic is Hidden Strength Amplification, finding the emotional resources that people have forgotten they possess, amplifying courage in those who think they're cowards, and revealing the deep love that fear or trauma has concealed. Blackhusky's black fur makes them nearly invisible in emotional darkness, allowing them to work with individuals too damaged for conventional healing. They serve as the Heart's specialist in recovering lost emotional capacity, proving that no one is ever completely beyond the reach of love.\n\n---",image:"images/6198.png"},
    "9624":{id:"9624",rank:7914,fur:"Black",pattern:"Spotted",eyes:"Black Eyes",clothes:"None",realm:"Deepwood",order:"Arcane",hatColor:"Purple",suggestedName:"Brownsteady the Reliable Heart",suggestedStory:"*Brown Classic | Black Eyes | None | Violet Highlands → Heartstring Tower*\n\nThe fifth Classic in the Heart Order, demonstrating the natural affinity between steady breeds and consistent emotional magic. Brownsteady's brown fur provides perfect grounding for long-term relationship work, while their black eyes maintain clear focus on individual emotional needs without being distracted by complex group dynamics.\n\nTheir magic is Reliable Love, emotional support that never wavers, amplification magic that works the same way every time, and the steady affection that makes long-term pack bonds possible. Brownsteady serves as emotional baseline for their pack, providing the consistent love that allows others to take emotional risks. They prove that spectacular displays of affection are less important than reliable presence, being the pack member who's always there, always caring, always ready to help.\n\n---",image:"images/9624.png"},
    "3479":{id:"3479",rank:7641,fur:"Beige",pattern:"Classic",eyes:"Black Eyes",clothes:"None",realm:"Violet Highlands",order:"Heart",hatColor:"Pink",suggestedName:"Grayheart the Neutral Amplifier",suggestedStory:"*Gray Classic | Black Eyes | None | Violet Highlands → Heartstring Tower*\n\nThe sixth Classic in the Heart Order, specializing in neutral amplification that doesn't favor any particular emotional approach. Grayheart's gray fur provides perfect emotional neutrality, while their black eyes maintain focus without introducing personal bias into their amplification magic. They serve as the ideal amplifier for mixed groups where different personalities need different types of emotional support.\n\nTheir magic is Universal Amplification, enhancing whatever emotional strengths each individual brings to the pack, providing amplification that adapts to different personality types, and serving as neutral ground where conflicting emotional styles can find harmony. Grayheart's neutrality makes them valuable for diplomatic magic and conflict resolution, proving that sometimes the most loving thing is to amplify others without adding your own emotional agenda to the mix.\n\n---",image:"images/3479.png"},
    "1271":{id:"1271",rank:6653,fur:"White",pattern:"Collie",eyes:"Black Eyes",clothes:"None",realm:"Deepwood",order:"Heart",hatColor:"Pink",suggestedName:"Tansteady the Patient Amplifier",suggestedStory:"*Tan Classic | Black Eyes | None | Violet Highlands → Heartstring Tower*\n\nThe seventh Classic in the Heart Order, demonstrating that the breed most suited to emotional magic is also the most common breed in Pawtheon. Tansteady's tan fur provides earth-tone stability, while their patient nature makes them ideal for emotional work that requires years rather than moments to complete.\n\nTheir magic is Patient Love, emotional support that works on long timescales, amplification that builds gradually rather than flaring dramatically, and the understanding that real emotional change requires time and consistency. Tansteady works with individuals and relationships that need years of support to heal from major trauma. They prove that the most powerful bond magic is often the quietest, working so gradually that its effects are only noticed when looking back over long periods of time.\n\n---",image:"images/1271.png"},
    "9017":{id:"9017",rank:6598,fur:"Tan",pattern:"Classic",eyes:"Yellow Eyes",clothes:"None",realm:"Violet Highlands",order:"Heart",hatColor:"Pink",suggestedName:"Sleepysteady the Gentle Dreamer",suggestedStory:"*Gray Classic | Sleepy Eyes | None | Violet Highlands → Heartstring Tower*\n\nThe eighth and final Classic in the Heart Order, specializing in gentle emotional work that occurs during rest and sleep. Their gray fur provides neutrality for unconscious emotional work, while their permanently sleepy appearance reflects their specialty in dream-state bonding and healing.\n\nTheir magic is Gentle Dream Healing, emotional recovery that happens while sleeping, bond magic that works through shared dreams, and the kind of subtle emotional support that heals without the subject realizing they're being healed. Sleepysteady's sleepy nature allows them to work in dream states where emotional barriers are down and healing can occur without resistance. They serve as the Heart's specialist in unconscious emotional support, proving that love works best when it doesn't call attention to itself.",image:"images/9017.png"},
    "6164":{id:"6164",rank:7277,fur:"Gray",pattern:"Classic",eyes:"Round Glasses",clothes:"None",realm:"Violet Highlands",order:"Wanderer",hatColor:"Purple",suggestedName:"The Wanderer, First Dog",suggestedStory:"*Gray Classic | Round Glasses | None | Purple POINTY Hat | No Realm → All Realms*\n\nThe most ordinary-looking dog in the collection. Gray fur. Classic pattern. No clothes. No accessories. Round glasses. Rank 7,277, deep in the bottom quartile of rarity. By every objective metric, unremarkable. Except for one detail visible only in the art: his hat is pointy. Every other Wizard's hat is rounded or folded. The Wanderer's hat ends in a sharp point, the classic wizard's hat from legend.\n\nHe is the First Dog. The being who appeared in the emptiness before existence and howled the universe into being. His story is the origin story every pup in Pawtheon knows by heart: alone in the void, he sat patiently until patience became purpose, then opened his mouth and sang reality into existence with the First Howl. Seven tones, seven moons, seven realms, and everything that followed.\n\nHis hat is purple, the color of the Arcane, but he is not Arcane. The 14 purple-hatted Wizards don't include him in their count. His hat resonates with all six Order frequencies simultaneously and with Palehowl, the Starter Moon, the weakest of the seven. He draws his power not from the concentrated magic of the Orders but from the diffuse magic that touches every common dog in Pawtheon. During the Septenary Alignment, when all seven moons are full, Palehowl blazes brighter than all six Order Moons combined, and the humblest magic becomes the strongest.\n\nHe walks. Between realms, between Orders, between the breed-world and the moon-world. He tells stories, especially his own, the tale of the First Howl. He sits patiently in places where patience is needed. He howls sometimes, late at night, when the seven moons align. And when he does, every dog in Pawtheon stops what they're doing and listens.\n\nThe Wanderer was offered leadership of the 86 after the Loyalty Wars. He refused. He was offered membership in the Arcane Order because his hat is purple. He refused. He was offered a home in the Violet Highlands because he's a Classic. He refused. He doesn't lead because leading would require choosing sides, and the dog who howled everything into existence doesn't take sides. He takes walks.\n\nThe round glasses he wears are the same glasses he wore in the void before creation, artifacts from before artifacts existed, lenses that have seen the birth of everything. They're not magic. They're more than magic. They're the first objects that ever existed, created by the need to see clearly in a universe that didn't yet have light.\n\nHis rank, 7,277, marks him as common. His power marks him as unique. The contradiction is the point. The First Howl never ended. It just became too quiet for most to hear. But The Wanderer still hears it, still carries it, still *is* it. When the next crisis comes, and the Deep know it's coming, though they won't say what it is, the most ordinary dog will once again become the most extraordinary being in the Caninosphere.\n\nHe is the 86th Wizard, inside the Order of 86 but outside every Order within it. He started everything. He belongs to nothing. And that's exactly how it should be.",image:"images/6164.png"}
};

const orderColorsHex = { Flame:'#FF6B00', Wild:'#2ECC71', Arcane:'#9B6EFF', Deep:'#3498DB', Radiant:'#F1C40F', Heart:'#FF69B4', Wanderer:'#9966ff' };

// ── Realm Data ──
const realms = {
    'Frosthollow': { x:-350, z:-300, color:new THREE.Color(0.85,0.92,1.0), color2:new THREE.Color(0.6,0.75,0.95), hex:'#d9ebff', motto:'"In stillness, strength."', desc:'The frozen northwest, where jagged peaks pierce eternal winter skies. Glaciers carve through ice-blue valleys and a vast frozen lake mirrors the aurora. Only the hardiest dogs survive here, and only the wisest thrive.', landmarks:['Frozen Lake of Mirrors','The Glacial Stairway','Aurora Peak'], breeds:['Husky','Collie','Split'], knownFor:'Ice magic, endurance, patience', elevation:80 },
    'Abyssal Reaches': { x:0, z:-350, color:new THREE.Color(0.25,0.3,0.4), color2:new THREE.Color(0.15,0.2,0.35), hex:'#3d4d66', motto:'"The deep remembers what the surface forgets."', desc:'Coastal cliffs plunge into dark waters where ancient things stir. The boundary between land and ocean, where prophecy magic runs strongest. Tidewatch tower stands sentinel where waves crash against basalt.', landmarks:['Tidewatch Tower','The Drowned Steps','Basalt Cliffs'], breeds:['Tiger','Spotted','Classic'], knownFor:'Prophecy, ocean magic, deep memory', elevation:20 },
    'Sunward Heights': { x:350, z:-300, color:new THREE.Color(1.0,0.92,0.7), color2:new THREE.Color(0.95,0.85,0.6), hex:'#ffe6a3', motto:'"Truth shines brightest at the peak."', desc:'High plateaus bathed in perpetual golden light. Crystal formations catch and refract sunbeams into prismatic cascades. The air is thin and clear, perfect for seeing far, both physically and metaphysically.', landmarks:['Crystal Spires','The Solar Plateau','Prismatic Falls'], breeds:['Solid','Blotted','Classic'], knownFor:'Light magic, revelation, truth-seeing', elevation:65 },
    'Ember Wastes': { x:400, z:100, color:new THREE.Color(0.25,0.18,0.12), color2:new THREE.Color(0.5,0.2,0.05), hex:'#804020', motto:'"From destruction, creation."', desc:'Volcanic badlands where the ground itself burns. Lava rivers cut through obsidian plains, calderas glow with hellfire, and ash perpetually drifts skyward. The Forge Spire harnesses this raw elemental fury.', landmarks:['The Great Caldera','Lava Rivers','Obsidian Fields'], breeds:['Tiger','Split','Solid'], knownFor:'Fire magic, forge craft, destruction and renewal', elevation:45 },
    'Deepwood': { x:250, z:350, color:new THREE.Color(0.15,0.35,0.12), color2:new THREE.Color(0.2,0.45,0.15), hex:'#2d6b1f', motto:'"All roots connect."', desc:'An ancient forest of impossible density. The Heartwood, a tree so massive it can be seen from any realm, stands at its center. Fireflies dance between moss-covered trunks and the air hums with growth magic.', landmarks:['The Heartwood','Firefly Glades','Root Cathedral'], breeds:['Classic','Zombie','Spotted'], knownFor:'Nature magic, growth, the living network', elevation:15 },
    'Violet Highlands': { x:-300, z:300, color:new THREE.Color(0.4,0.28,0.5), color2:new THREE.Color(0.35,0.22,0.45), hex:'#6b3d80', motto:'"Knowledge is the highest ground."', desc:'Terraced mountain ridges in shades of purple and gray. Step-like terrain carved by ancient magic. Home to the most Wizards of any realm, 25, making it the political heart of Pawtheon.', landmarks:['The Violet Citadel','Terraced Archives','The Debate Amphitheater'], breeds:['All patterns represented'], knownFor:'Arcane theory, politics, magical scholarship', elevation:55 },
    'Shadowmire': { x:0, z:400, color:new THREE.Color(0.12,0.15,0.08), color2:new THREE.Color(0.18,0.2,0.1), hex:'#2d3318', motto:'"In darkness, we see what light conceals."', desc:'Low, flat swamplands shrouded in perpetual mist. Dark pools reflect nothing. The air is thick, the ground treacherous. But Shadowmire hides beauty in its danger, bioluminescent fungi, rare herbs, ancient secrets.', landmarks:['Mistpools','The Fungal Groves','The Sinking Stones'], breeds:['Zombie','Blotted','Split'], knownFor:'Shadow magic, alchemy, hidden knowledge', elevation:-5 },
    'Starter Lands': { x:0, z:0, color:new THREE.Color(0.45,0.55,0.35), color2:new THREE.Color(0.5,0.6,0.4), hex:'#7a9959', motto:'"Every journey begins with a single howl."', desc:'Gentle rolling plains at Pawtheon\'s heart. Where all loyalty lines converge, where new Wizards first feel the pull of magic. Open sky, soft grass, and the distant glow of six towers on the horizon.', landmarks:['The Convergence Stone','First Howl Meadow','Loyalty Crossroads'], breeds:['All breeds welcome'], knownFor:'Beginning magic, loyalty bonds, unity', elevation:10 },
    'Heartwood': { x:250, z:350, color:new THREE.Color(0.15,0.35,0.12), color2:new THREE.Color(0.2,0.45,0.15), hex:'#2d6b1f', motto:'', desc:'The living heart of Deepwood, centered on the great tree.', landmarks:['The Heartwood Tree'], breeds:['Various'], knownFor:'Nature magic', elevation:15 },
    'Solara Fields': { x:350, z:-300, color:new THREE.Color(1.0,0.92,0.7), color2:new THREE.Color(0.95,0.85,0.6), hex:'#ffe6a3', motto:'', desc:'Sun-drenched meadows near Sunward Heights.', landmarks:['Golden Meadows'], breeds:['Various'], knownFor:'Light and radiant magic', elevation:60 }
};

// Map Heartwood/Solara to their parent realms for display
const realmAliases = { 'Heartwood':'Deepwood', 'Solara Fields':'Sunward Heights' };
const displayRealms = ['Frosthollow','Abyssal Reaches','Sunward Heights','Ember Wastes','Deepwood','Violet Highlands','Shadowmire','Starter Lands'];

// ── Simplex Noise ──
class SimplexNoise {
    constructor(seed=0) {
        this.grad3 = [[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]];
        this.p = [];
        for(let i=0;i<256;i++) this.p[i]=i;
        let n,s=seed;
        for(let i=255;i>0;i--) { s=(s*16807+0)%2147483647; n=s%(i+1); [this.p[i],this.p[n]]=[this.p[n],this.p[i]]; }
        this.perm=new Uint8Array(512); this.permMod12=new Uint8Array(512);
        for(let i=0;i<512;i++) { this.perm[i]=this.p[i&255]; this.permMod12[i]=this.perm[i]%12; }
    }
    noise2D(x,y) {
        const F2=0.5*(Math.sqrt(3)-1), G2=(3-Math.sqrt(3))/6;
        const s=(x+y)*F2; const i=Math.floor(x+s), j=Math.floor(y+s);
        const t=(i+j)*G2; const x0=x-(i-t), y0=y-(j-t);
        const i1=x0>y0?1:0, j1=x0>y0?0:1;
        const x1=x0-i1+G2, y1=y0-j1+G2, x2=x0-1+2*G2, y2=y0-1+2*G2;
        const ii=i&255, jj=j&255;
        const gi0=this.permMod12[ii+this.perm[jj]], gi1=this.permMod12[ii+i1+this.perm[jj+j1]], gi2=this.permMod12[ii+1+this.perm[jj+1]];
        let n0=0,n1=0,n2=0;
        let t0=0.5-x0*x0-y0*y0; if(t0>0){t0*=t0;const g=this.grad3[gi0];n0=t0*t0*(g[0]*x0+g[1]*y0);}
        let t1=0.5-x1*x1-y1*y1; if(t1>0){t1*=t1;const g=this.grad3[gi1];n1=t1*t1*(g[0]*x1+g[1]*y1);}
        let t2=0.5-x2*x2-y2*y2; if(t2>0){t2*=t2;const g=this.grad3[gi2];n2=t2*t2*(g[0]*x2+g[1]*y2);}
        return 70*(n0+n1+n2);
    }
}

// ── Setup ──
const isMobile = window.innerWidth < 768;
const subdivisions = isMobile ? 180 : 256;
const noise = new SimplexNoise(42);
const noise2 = new SimplexNoise(137);
const clock = new THREE.Clock();

const renderer = new THREE.WebGLRenderer({ antialias:!isMobile, alpha:false, powerPreference:'high-performance' });
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
renderer.shadowMap.enabled = true;
renderer.shadowMap.type = isMobile ? THREE.BasicShadowMap : THREE.PCFSoftShadowMap;
renderer.toneMapping = THREE.ACESFilmicToneMapping;
renderer.toneMappingExposure = 1.1;
renderer.outputColorSpace = THREE.SRGBColorSpace;
document.getElementById('container').appendChild(renderer.domElement);

const scene = new THREE.Scene();
scene.background = new THREE.Color(0x050510);
scene.fog = new THREE.FogExp2(0x0a0a1a, 0.0008);

// ── Stars ──
{
    const starCount = 2000;
    const starGeo = new THREE.BufferGeometry();
    const starPos = new Float32Array(starCount * 3);
    const starSizes = new Float32Array(starCount);
    for (let i = 0; i < starCount; i++) {
        const theta = Math.random() * Math.PI * 2;
        const phi = Math.acos(2 * Math.random() - 1);
        const r = 1200 + Math.random() * 300;
        starPos[i*3] = r * Math.sin(phi) * Math.cos(theta);
        starPos[i*3+1] = Math.abs(r * Math.cos(phi)); // only upper hemisphere
        starPos[i*3+2] = r * Math.sin(phi) * Math.sin(theta);
        starSizes[i] = 0.5 + Math.random() * 2.5;
    }
    starGeo.setAttribute('position', new THREE.Float32BufferAttribute(starPos, 3));
    starGeo.setAttribute('size', new THREE.Float32BufferAttribute(starSizes, 1));
    const starMat = new THREE.PointsMaterial({ color: 0xffffff, size: 2, sizeAttenuation: true, transparent: true, opacity: 0.8 });
    const stars = new THREE.Points(starGeo, starMat);
    stars.frustumCulled = false;
    scene.add(stars);
}

const camera = new THREE.PerspectiveCamera(50, window.innerWidth/window.innerHeight, 1, 3000);
camera.position.set(0, 500, 600);

const controls = new OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.dampingFactor = 0.12;
controls.minDistance = 100;
controls.maxDistance = 1200;
controls.maxPolarAngle = Math.PI/2.15;
controls.autoRotate = true;
controls.autoRotateSpeed = 0.3;
controls.target.set(0, 0, 0);
controls.rotateSpeed = 0.5;
controls.zoomSpeed = 0.8;
controls.panSpeed = 0.5;
controls.touches = { ONE: THREE.TOUCH.ROTATE, TWO: THREE.TOUCH.DOLLY_PAN };
controls.enablePan = true;

let userInteracted = false;
controls.addEventListener('start', () => { userInteracted = true; controls.autoRotate = false; });

// Progress
let progress = 0;
function setProgress(p) { progress = p; document.getElementById('loadBar').style.width = p+'%'; }

// ── Lighting ──
const ambientLight = new THREE.AmbientLight(0xfff0dd, 0.35);
scene.add(ambientLight);

const sunLight = new THREE.DirectionalLight(0xfff4e0, 1.2);
sunLight.position.set(200, 400, -100);
sunLight.castShadow = true;
sunLight.shadow.mapSize.set(isMobile?1024:2048, isMobile?1024:2048);
sunLight.shadow.camera.left = -600; sunLight.shadow.camera.right = 600;
sunLight.shadow.camera.top = 600; sunLight.shadow.camera.bottom = -600;
sunLight.shadow.camera.near = 1; sunLight.shadow.camera.far = 1200;
sunLight.shadow.bias = -0.001;
scene.add(sunLight);

const hemiLight = new THREE.HemisphereLight(0x8899bb, 0x334422, 0.3);
scene.add(hemiLight);

setProgress(10);

// ── Terrain ──
function getRealmInfluence(x, z) {
    const influences = {};
    let totalWeight = 0;
    for (const [name, r] of Object.entries(realms)) {
        if (name === 'Heartwood' || name === 'Solara Fields') continue;
        const dx = x - r.x, dz = z - r.z;
        const dist = Math.sqrt(dx*dx + dz*dz);
        const w = Math.pow(Math.max(0, 1 - dist/400), 2.5);
        if (w > 0) { influences[name] = w; totalWeight += w; }
    }
    if (totalWeight === 0) return { 'Starter Lands': 1 };
    for (const k in influences) influences[k] /= totalWeight;
    return influences;
}

function getHeight(x, z) {
    const inf = getRealmInfluence(x, z);
    let baseElev = 0;
    for (const [name, w] of Object.entries(inf)) baseElev += (realms[name]?.elevation || 10) * w;

    let n = noise.noise2D(x*0.004, z*0.004) * 30;
    n += noise.noise2D(x*0.01, z*0.01) * 12;
    n += noise2.noise2D(x*0.025, z*0.025) * 5;

    // Frosthollow peaks
    const fh = inf['Frosthollow'] || 0;
    if (fh > 0.1) {
        const peak = Math.abs(noise.noise2D(x*0.015, z*0.015));
        n += peak * 80 * fh;
        n += Math.abs(noise2.noise2D(x*0.03, z*0.03)) * 30 * fh;
    }

    // Ember Wastes calderas
    const ew = inf['Ember Wastes'] || 0;
    if (ew > 0.1) {
        const caldera = noise.noise2D(x*0.008+5, z*0.008+5);
        if (caldera > 0.3) n -= 25 * ew * (caldera-0.3)*3;
        else n += 20 * ew;
        n += Math.abs(noise2.noise2D(x*0.02, z*0.02)) * 15 * ew;
    }

    // Sunward plateaus
    const sh = inf['Sunward Heights'] || 0;
    if (sh > 0.2) {
        const plateau = noise.noise2D(x*0.005+10, z*0.005+10);
        if (plateau > 0) n += 40 * sh; else n += 15 * sh;
    }

    // Violet terraces
    const vh = inf['Violet Highlands'] || 0;
    if (vh > 0.1) {
        const terrace = noise.noise2D(x*0.006, z*0.006) * 40 * vh;
        n += Math.round(terrace / 10) * 10; // Step-like
    }

    // Abyssal cliff drop
    const ab = inf['Abyssal Reaches'] || 0;
    if (ab > 0.3) {
        const cliff = noise.noise2D(x*0.003+20, z*0.003+20);
        if (cliff < -0.1) n -= 40 * ab;
    }

    // Shadowmire depressions
    const sm = inf['Shadowmire'] || 0;
    if (sm > 0.1) {
        const pool = noise.noise2D(x*0.012+15, z*0.012+15);
        if (pool > 0.3) n -= 8 * sm;
        n -= 10 * sm;
    }

    // Deepwood gentle
    const dw = inf['Deepwood'] || 0;
    if (dw > 0.1) n *= 0.6;

    return baseElev + n;
}

function getTerrainColor(x, z, height) {
    const inf = getRealmInfluence(x, z);
    const c = new THREE.Color(0, 0, 0);

    for (const [name, w] of Object.entries(inf)) {
        const r = realms[name];
        if (!r) continue;
        const t = Math.min(1, Math.max(0, (height - (r.elevation-20)) / 60));
        const col = r.color.clone().lerp(r.color2, 1-t);

        // Ember cracks
        if (name === 'Ember Wastes') {
            const crack = noise.noise2D(x*0.05, z*0.05);
            if (Math.abs(crack) < 0.08) col.lerp(new THREE.Color(1, 0.3, 0.0), 0.8);
        }
        // Frosthollow snow caps
        if (name === 'Frosthollow' && height > 100) {
            col.lerp(new THREE.Color(1, 1, 1), Math.min(1, (height-100)/40));
        }

        c.r += col.r * w;
        c.g += col.g * w;
        c.b += col.b * w;
    }
    return c;
}

const terrainGeo = new THREE.PlaneGeometry(1100, 1100, subdivisions, subdivisions);
terrainGeo.rotateX(-Math.PI/2);
const positions = terrainGeo.attributes.position;
const colors = new Float32Array(positions.count * 3);

for (let i = 0; i < positions.count; i++) {
    const x = positions.getX(i), z = positions.getZ(i);
    const h = getHeight(x, z);
    positions.setY(i, h);
    const col = getTerrainColor(x, z, h);
    colors[i*3] = col.r; colors[i*3+1] = col.g; colors[i*3+2] = col.b;
}
terrainGeo.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));
terrainGeo.computeVertexNormals();

const terrainMat = new THREE.MeshStandardMaterial({ vertexColors:true, roughness:0.85, metalness:0.05, flatShading:false });
const terrain = new THREE.Mesh(terrainGeo, terrainMat);
terrain.receiveShadow = true;
terrain.castShadow = true;
terrain.name = 'terrain';
scene.add(terrain);
setProgress(30);

// ── Realm click zones (invisible planes) ──
const realmMeshes = [];
for (const [name, r] of Object.entries(realms)) {
    if (name === 'Heartwood' || name === 'Solara Fields') continue;
    const plane = new THREE.Mesh(
        new THREE.CircleGeometry(100, 32),
        new THREE.MeshBasicMaterial({ visible:false })
    );
    plane.rotation.x = -Math.PI/2;
    plane.position.set(r.x, getHeight(r.x, r.z)+2, r.z);
    plane.userData = { type:'realm', name };
    scene.add(plane);
    realmMeshes.push(plane);
}

// ── Realm Boundary Glow ──
for (const [name, r] of Object.entries(realms)) {
    if (name === 'Heartwood' || name === 'Solara Fields') continue;
    const ringGeo = new THREE.RingGeometry(90, 105, 64);
    const ringMat = new THREE.MeshBasicMaterial({
        color: r.color.clone().multiplyScalar(1.5),
        transparent: true,
        opacity: 0.08,
        side: THREE.DoubleSide,
        depthWrite: false
    });
    const ring = new THREE.Mesh(ringGeo, ringMat);
    ring.rotation.x = -Math.PI / 2;
    ring.position.set(r.x, getHeight(r.x, r.z) + 1, r.z);
    scene.add(ring);
    // Inner glow
    const innerGeo = new THREE.CircleGeometry(90, 64);
    const innerMat = new THREE.MeshBasicMaterial({
        color: r.color,
        transparent: true,
        opacity: 0.04,
        side: THREE.DoubleSide,
        depthWrite: false
    });
    const inner = new THREE.Mesh(innerGeo, innerMat);
    inner.rotation.x = -Math.PI / 2;
    inner.position.set(r.x, getHeight(r.x, r.z) + 0.5, r.z);
    scene.add(inner);
}

// ── Water ──
const waterGeo = new THREE.PlaneGeometry(1400, 1400, 64, 64);
waterGeo.rotateX(-Math.PI/2);
const waterMat = new THREE.MeshPhysicalMaterial({
    color:0x1a5c7a, transparent:true, opacity:0.65, roughness:0.1, metalness:0.3,
    transmission:0.2, thickness:2, envMapIntensity:0.5, side:THREE.DoubleSide
});
const water = new THREE.Mesh(waterGeo, waterMat);
water.position.y = -8;
water.receiveShadow = true;
scene.add(water);

// Frozen lake
const lakeMat = new THREE.MeshPhysicalMaterial({ color:0xc8e8ff, transparent:true, opacity:0.7, roughness:0.05, metalness:0.4, transmission:0.3, thickness:1 });
const lake = new THREE.Mesh(new THREE.CircleGeometry(50, 48), lakeMat);
lake.rotation.x = -Math.PI/2;
const lakeY = getHeight(-350, -300);
lake.position.set(-350, lakeY + 5, -300);
scene.add(lake);

setProgress(40);

// ── Trees ──
const trunkGeo = new THREE.CylinderGeometry(1.2, 1.8, 12, 6);
const canopyGeo = new THREE.ConeGeometry(6, 16, 6);
const trunkMat = new THREE.MeshStandardMaterial({ color:0x5c3d2e, roughness:0.9 });

function createTreeInstance(count, positions_arr) {
    const group = new THREE.Group();
    const dummy = new THREE.Object3D();

    const trunkIM = new THREE.InstancedMesh(trunkGeo, trunkMat, count);
    const canopyColors = [0x1a5c1a, 0x2d7a2d, 0x1a6b1a, 0x3d8b3d, 0x0d4d0d, 0x2a6e2a];
    const canopyIM = new THREE.InstancedMesh(canopyGeo, new THREE.MeshStandardMaterial({ color:0x2d7a2d, roughness:0.8 }), count);

    for (let i = 0; i < count; i++) {
        const p = positions_arr[i];
        const scale = p.s || 1;
        // Trunk
        dummy.position.set(p.x, p.y + 6*scale, p.z);
        dummy.scale.set(scale, scale, scale);
        dummy.rotation.y = Math.random() * Math.PI * 2;
        dummy.updateMatrix();
        trunkIM.setMatrixAt(i, dummy.matrix);
        // Canopy
        dummy.position.set(p.x, p.y + 16*scale, p.z);
        dummy.updateMatrix();
        canopyIM.setMatrixAt(i, dummy.matrix);
        const cc = new THREE.Color(canopyColors[i % canopyColors.length]);
        canopyIM.setColorAt(i, cc);
    }
    trunkIM.castShadow = true;
    canopyIM.castShadow = true;
    canopyIM.receiveShadow = true;
    group.add(trunkIM, canopyIM);
    return group;
}

const treePositions = [];
// Deepwood dense trees
for (let i = 0; i < 250; i++) {
    const angle = Math.random() * Math.PI * 2;
    const dist = Math.random() * 130;
    const tx = 250 + Math.cos(angle) * dist;
    const tz = 350 + Math.sin(angle) * dist;
    // Skip near Heartwood center
    if (Math.sqrt((tx-250)**2 + (tz-350)**2) < 15) continue;
    const ty = getHeight(tx, tz);
    if (ty < -5) continue;
    treePositions.push({ x:tx, y:ty, z:tz, s:0.6 + Math.random()*0.8 });
}
// Scattered elsewhere
for (let i = 0; i < 80; i++) {
    const tx = (Math.random()-0.5)*800;
    const tz = (Math.random()-0.5)*800;
    const inf = getRealmInfluence(tx, tz);
    if ((inf['Ember Wastes']||0) > 0.4) continue;
    if ((inf['Frosthollow']||0) > 0.5) continue;
    const ty = getHeight(tx, tz);
    if (ty < -3) continue;
    treePositions.push({ x:tx, y:ty, z:tz, s:0.5 + Math.random()*0.6 });
}

const trees = createTreeInstance(treePositions.length, treePositions);
scene.add(trees);

// THE HEARTWOOD, massive tree
const heartwoodGroup = new THREE.Group();
const hwTrunk = new THREE.Mesh(
    new THREE.CylinderGeometry(8, 12, 80, 12),
    new THREE.MeshStandardMaterial({ color:0x4a2f1a, roughness:0.9 })
);
hwTrunk.position.set(250, getHeight(250,350)+40, 350);
hwTrunk.castShadow = true;
heartwoodGroup.add(hwTrunk);

for (let i = 0; i < 4; i++) {
    const canopy = new THREE.Mesh(
        new THREE.SphereGeometry(35 - i*5, 12, 10),
        new THREE.MeshStandardMaterial({ color: new THREE.Color().setHSL(0.28, 0.6, 0.2 + i*0.05), roughness:0.8 })
    );
    canopy.position.set(250 + (Math.random()-0.5)*15, getHeight(250,350)+70+i*12, 350 + (Math.random()-0.5)*15);
    canopy.castShadow = true;
    heartwoodGroup.add(canopy);
}
scene.add(heartwoodGroup);

setProgress(55);

// ── Mountains ──
function createMountains(positions_arr, color, count) {
    const geo = new THREE.ConeGeometry(1, 1, 6);
    const mat = new THREE.MeshStandardMaterial({ color, roughness:0.75, flatShading:true });
    const im = new THREE.InstancedMesh(geo, mat, count);
    const dummy = new THREE.Object3D();
    for (let i = 0; i < count; i++) {
        const p = positions_arr[i];
        dummy.position.set(p.x, p.y + p.h/2, p.z);
        dummy.scale.set(p.r, p.h, p.r);
        dummy.rotation.y = Math.random()*Math.PI;
        dummy.updateMatrix();
        im.setMatrixAt(i, dummy.matrix);
    }
    im.castShadow = true;
    return im;
}

// Frosthollow peaks
const fhPeaks = [];
for (let i=0;i<18;i++) {
    const ax = -350 + (Math.random()-0.5)*200, az = -300 + (Math.random()-0.5)*180;
    const ay = getHeight(ax, az);
    fhPeaks.push({x:ax,y:ay,z:az,h:30+Math.random()*50,r:12+Math.random()*10});
}
scene.add(createMountains(fhPeaks, 0xe8f0ff, fhPeaks.length));

// Violet peaks
const vhPeaks = [];
for (let i=0;i<12;i++) {
    const ax = -300 + (Math.random()-0.5)*180, az = 300 + (Math.random()-0.5)*160;
    const ay = getHeight(ax, az);
    vhPeaks.push({x:ax,y:ay,z:az,h:20+Math.random()*35,r:10+Math.random()*8});
}
scene.add(createMountains(vhPeaks, 0x7a5a8a, vhPeaks.length));

// Sunward formations
const shPeaks = [];
for (let i=0;i<7;i++) {
    const ax = 350 + (Math.random()-0.5)*140, az = -300 + (Math.random()-0.5)*120;
    const ay = getHeight(ax, az);
    shPeaks.push({x:ax,y:ay,z:az,h:25+Math.random()*30,r:8+Math.random()*8});
}
scene.add(createMountains(shPeaks, 0xffe8a0, shPeaks.length));

// Crystal formations in Sunward Heights
for (let i=0;i<10;i++) {
    const cx = 350 + (Math.random()-0.5)*120, cz = -300 + (Math.random()-0.5)*100;
    const cy = getHeight(cx, cz);
    const crystal = new THREE.Mesh(
        new THREE.ConeGeometry(2+Math.random()*3, 15+Math.random()*20, 5),
        new THREE.MeshPhysicalMaterial({ color:0xfff8e0, transparent:true, opacity:0.6, roughness:0.1, metalness:0.5, transmission:0.4 })
    );
    crystal.position.set(cx, cy+10, cz);
    crystal.rotation.z = (Math.random()-0.5)*0.3;
    scene.add(crystal);
}

setProgress(65);

// ── Towers ──
const towers = [];
const towerData = [
    { name:'Forge Spire', order:'Flame', color:0xFF6B00, x:200, z:280, desc:'Tall dark spire harnessing volcanic fury for creation magic.' },
    { name:'Solar Spire', order:'Radiant', color:0xF1C40F, x:0, z:-320, desc:'White and gold floating tower channeling pure sunlight.' },
    { name:'Tidewatch', order:'Deep', color:0x3498DB, x:-50, z:-380, desc:'Blue sentinel partially submerged where waves meet stone.' },
    { name:'Heartwood Spire', order:'Wild', color:0x2ECC71, x:250, z:350, desc:'Living tower grown from the roots of the great Heartwood.' },
    { name:'Violet Citadel', order:'Arcane', color:0x9B6EFF, x:-50, z:340, desc:'Ancient purple fortress housing arcane archives.' },
    { name:'Heartstring Tower', order:'Heart', color:0xFF69B4, x:0, z:200, desc:'Pink crystalline tower resonating with emotional bonds.' }
];

for (const td of towerData) {
    const ty = getHeight(td.x, td.z);
    const group = new THREE.Group();

    // Base
    const base = new THREE.Mesh(
        new THREE.CylinderGeometry(4, 6, 30, 8),
        new THREE.MeshStandardMaterial({ color:0x2a2a2a, roughness:0.6, metalness:0.3 })
    );
    base.position.y = 15;
    base.castShadow = true;
    group.add(base);

    // Top
    const top = new THREE.Mesh(
        new THREE.ConeGeometry(5, 15, 8),
        new THREE.MeshStandardMaterial({ color:td.color, emissive:td.color, emissiveIntensity:0.6, roughness:0.3, metalness:0.5 })
    );
    top.position.y = 37;
    top.castShadow = true;
    group.add(top);

    // Orb
    const orb = new THREE.Mesh(
        new THREE.SphereGeometry(2, 16, 12),
        new THREE.MeshStandardMaterial({ color:td.color, emissive:td.color, emissiveIntensity:1.5 })
    );
    orb.position.y = 46;
    group.add(orb);

    // Point light
    const light = new THREE.PointLight(td.color, 2, 150);
    light.position.y = 40;
    group.add(light);

    group.position.set(td.x, ty, td.z);
    group.userData = { type:'tower', name:td.name, order:td.order, desc:td.desc, color:td.color };
    scene.add(group);
    towers.push(group);
}

// Solar Spire floats
towers[1].position.y += 10;

setProgress(72);

// ── Seven Moons ──
const moonData = [
    { name:'Emberhowl',  color:0xFF6B00, order:'Flame',   cycle:18, wizards:18 },
    { name:'Solaris',    color:0xF1C40F, order:'Radiant', cycle:12, wizards:12 },
    { name:'Deepwell',   color:0x3498DB, order:'Deep',    cycle:13, wizards:13 },
    { name:'Evergreen',  color:0x2ECC71, order:'Wild',    cycle:18, wizards:18 },
    { name:'Umbra',      color:0x9B6EFF, order:'Arcane',  cycle:14, wizards:14 },
    { name:'Roseglow',   color:0xFF69B4, order:'Heart',   cycle:11, wizards:11 },
    { name:'Palehowl',   color:0xdddddd, order:'Starter', cycle:30, wizards:0  }
];
const moonGroup = new THREE.Group();
const moons = [];
const moonLights = [];
for (let i = 0; i < 7; i++) {
    const md = moonData[i];
    const angle = (i / 7) * Math.PI * 2;
    const orbitR = i === 6 ? 300 : 400;
    const baseY = i === 6 ? 320 : 350;
    const r = i === 6 ? 3.5 : 6;

    // Lit half (emissive moon surface)
    const moonMat = new THREE.MeshStandardMaterial({
        color: md.color,
        emissive: md.color,
        emissiveIntensity: 1.0,
        transparent: true,
        opacity: 1.0
    });
    const moon = new THREE.Mesh(new THREE.SphereGeometry(r, 32, 24), moonMat);

    // Dark overlay hemisphere for phase shadow
    const shadowGeo = new THREE.SphereGeometry(r + 0.05, 32, 24, 0, Math.PI);
    const shadowMat = new THREE.MeshBasicMaterial({
        color: 0x000000,
        transparent: true,
        opacity: 0.85,
        side: THREE.DoubleSide
    });
    const shadow = new THREE.Mesh(shadowGeo, shadowMat);
    shadow.rotation.y = 0;
    moon.add(shadow);

    // Phase glow ring
    const glowGeo = new THREE.RingGeometry(r + 0.5, r + 2, 32);
    const glowMat = new THREE.MeshBasicMaterial({
        color: md.color,
        transparent: true,
        opacity: 0.15,
        side: THREE.DoubleSide
    });
    const glow = new THREE.Mesh(glowGeo, glowMat);
    glow.lookAt(camera.position);
    moon.add(glow);

    // Position on orbit
    moon.position.set(
        Math.cos(angle) * orbitR,
        baseY + Math.sin(angle) * 30,
        Math.sin(angle) * orbitR * 0.5 - 200
    );
    moon.userData = {
        type: 'moon',
        name: md.name,
        index: i,
        cycle: md.cycle,
        order: md.order,
        wizards: md.wizards,
        orbitRadius: orbitR,
        baseY: baseY,
        shadow: shadow,
        glow: glow,
        glowMat: glowMat,
        moonMat: moonMat,
        orbitSpeed: (1 / md.cycle) * 0.3,  // Faster cycle = faster orbit
        phaseSpeed: (1 / md.cycle) * 2.0,  // Phase rotation speed tied to cycle
        phaseOffset: i * 1.3               // Stagger phases so they're not all synced
    };

    const moonLight = new THREE.PointLight(md.color, 0.3, 800);
    moonLight.position.copy(moon.position);
    moonGroup.add(moonLight);
    moonLights.push(moonLight);
    moonGroup.add(moon);
    moons.push(moon);
}
scene.add(moonGroup);

setProgress(78);

// ── Loyalty Network (tower-to-moon lines, dynamic) ──
const loyaltyGroup = new THREE.Group();

const towerPositions = towers.map(t => t.position.clone().add(new THREE.Vector3(0,35,0)));

// Each tower connects to its corresponding moon (same index: 0=Flame/Emberhowl, 1=Radiant/Solaris, etc.)
const loyaltyPaths = [];
const loyaltyLines = [];
const towerMoonColors = [0xFF6B00, 0xF1C40F, 0x3498DB, 0x2ECC71, 0x9B6EFF, 0xFF69B4];
for (let i = 0; i < 6; i++) {
    const towerPos = towerPositions[i];
    const moonPos = moons[i].position.clone();
    const mid = new THREE.Vector3(
        (towerPos.x + moonPos.x) * 0.5,
        (towerPos.y + moonPos.y) * 0.5 + 30,
        (towerPos.z + moonPos.z) * 0.5
    );
    const curve = new THREE.QuadraticBezierCurve3(towerPos, mid, moonPos);
    const pts = curve.getPoints(24);
    const lineMat = new THREE.LineDashedMaterial({ color: towerMoonColors[i], transparent: true, opacity: 0.5, dashSize: 6, gapSize: 3, linewidth: 1 });
    const geo = new THREE.BufferGeometry().setFromPoints(pts);
    const line = new THREE.Line(geo, lineMat);
    line.computeLineDistances();
    loyaltyGroup.add(line);
    loyaltyLines.push(line);
    loyaltyPaths.push({ from: towerPos, moonIdx: i });
}
scene.add(loyaltyGroup);

// Update loyalty lines to follow moving moons
function updateLoyaltyLines() {
    for (let i = 0; i < 6; i++) {
        const towerPos = towerPositions[i];
        const moonPos = moons[i].position;
        const mid = new THREE.Vector3(
            (towerPos.x + moonPos.x) * 0.5,
            (towerPos.y + moonPos.y) * 0.5 + 30,
            (towerPos.z + moonPos.z) * 0.5
        );
        const curve = new THREE.QuadraticBezierCurve3(towerPos, mid, moonPos);
        const pts = curve.getPoints(24);
        loyaltyLines[i].geometry.setFromPoints(pts);
        loyaltyLines[i].computeLineDistances();
        loyaltyPaths[i].to = moonPos.clone();
        loyaltyPaths[i].mid = mid;
    }
}

// Traveling dots on loyalty network
const dotCount = 30;
const dotGeo = new THREE.BufferGeometry();
const dotPositions = new Float32Array(dotCount*3);
const dotProgress = new Float32Array(dotCount);
const dotPathIdx = new Uint8Array(dotCount);
for (let i=0;i<dotCount;i++) {
    dotProgress[i] = Math.random();
    dotPathIdx[i] = Math.floor(Math.random()*loyaltyPaths.length);
}
dotGeo.setAttribute('position', new THREE.Float32BufferAttribute(dotPositions, 3));
const dotMat = new THREE.PointsMaterial({ color:0xffd700, size:4, sizeAttenuation:true, transparent:true, opacity:0.9 });
const dots = new THREE.Points(dotGeo, dotMat);
scene.add(dots);

setProgress(82);

// ── Particles ──
function createParticles(count, regionX, regionZ, spread, color, sizeRange, yRange) {
    const geo = new THREE.BufferGeometry();
    const pos = new Float32Array(count*3);
    const vel = new Float32Array(count*3);
    for (let i=0;i<count;i++) {
        pos[i*3] = regionX + (Math.random()-0.5)*spread;
        pos[i*3+1] = (yRange ? yRange[0] + Math.random()*(yRange[1]-yRange[0]) : getHeight(pos[i*3], regionX) + 5 + Math.random()*40);
        pos[i*3+2] = regionZ + (Math.random()-0.5)*spread;
        vel[i*3] = (Math.random()-0.5)*0.2;
        vel[i*3+1] = (Math.random()-0.5)*0.3;
        vel[i*3+2] = (Math.random()-0.5)*0.2;
    }
    geo.setAttribute('position', new THREE.Float32BufferAttribute(pos, 3));
    const mat = new THREE.PointsMaterial({ color, size:sizeRange||2, sizeAttenuation:true, transparent:true, opacity:0.7 });
    const pts = new THREE.Points(geo, mat);
    pts.userData = { vel, regionX, regionZ, spread, yRange };
    return pts;
}

// Snow - Frosthollow
const snow = createParticles(150, -350, -300, 250, 0xffffff, 2, [getHeight(-350,-300), getHeight(-350,-300)+100]);
scene.add(snow);

// Ash - Ember Wastes
const ash = createParticles(80, 400, 100, 200, 0xff8844, 1.5, [getHeight(400,100), getHeight(400,100)+80]);
scene.add(ash);

// Fireflies - Deepwood
const fireflies = createParticles(60, 250, 350, 160, 0xaaff44, 2.5, [getHeight(250,350), getHeight(250,350)+30]);
scene.add(fireflies);

// Fog - Shadowmire
const fog = createParticles(80, 0, 400, 200, 0x888877, 4, [getHeight(0,400)-5, getHeight(0,400)+10]);
scene.add(fog);

// Lava particles
const lava = createParticles(50, 400, 100, 180, 0xff4400, 2, [getHeight(400,100)-5, getHeight(400,100)+15]);
scene.add(lava);

const particleSystems = [
    { pts:snow, dir:new THREE.Vector3(0,-0.3,0), respawnY:true },
    { pts:ash, dir:new THREE.Vector3(0,0.4,0), respawnY:true },
    { pts:fireflies, dir:new THREE.Vector3(0,0,0), wander:true },
    { pts:fog, dir:new THREE.Vector3(0.1,0,0.05), respawnY:false },
    { pts:lava, dir:new THREE.Vector3(0,0.2,0), respawnY:true }
];

setProgress(90);

// ── Lava Rivers (emissive planes in Ember Wastes) ──
for (let i=0;i<5;i++) {
    const curve = new THREE.CatmullRomCurve3([
        new THREE.Vector3(380 + (Math.random()-0.5)*60, getHeight(380,50+i*30)-2, 50+i*30),
        new THREE.Vector3(400 + (Math.random()-0.5)*40, getHeight(400,80+i*30)-2, 80+i*30),
        new THREE.Vector3(420 + (Math.random()-0.5)*60, getHeight(420,120+i*30)-2, 120+i*30),
    ]);
    const tube = new THREE.TubeGeometry(curve, 12, 1.5, 6, false);
    const lavaMesh = new THREE.Mesh(tube, new THREE.MeshStandardMaterial({ color:0xff4400, emissive:0xff2200, emissiveIntensity:1.5, roughness:0.4 }));
    scene.add(lavaMesh);
}

// ── NEW LORE LANDMARKS ──

// --- FROSTHOLLOW ---
// Frozen Lake of Echoes, larger reflective disc with ripple rings
{
    const lakeCenter = new THREE.Vector3(-350, getHeight(-350,-300)+5, -300);
    for (let r = 0; r < 5; r++) {
        const ring = new THREE.Mesh(
            new THREE.RingGeometry(10+r*10, 12+r*10, 48),
            new THREE.MeshPhysicalMaterial({ color:0xc8e8ff, transparent:true, opacity:0.5-r*0.08, roughness:0.05, metalness:0.5, side:THREE.DoubleSide })
        );
        ring.rotation.x = -Math.PI/2;
        ring.position.copy(lakeCenter);
        ring.position.y += 0.2*r;
        scene.add(ring);
    }
}

// Bernard's Watch, tall peak with tiny structure
{
    const bwX=-390, bwZ=-340;
    const bwY = getHeight(bwX,bwZ);
    const peak = new THREE.Mesh(new THREE.ConeGeometry(8,70,6), new THREE.MeshStandardMaterial({color:0xe0eeff,roughness:0.7,flatShading:true}));
    peak.position.set(bwX,bwY+35,bwZ); peak.castShadow=true; scene.add(peak);
    const hut = new THREE.Mesh(new THREE.BoxGeometry(4,3,4), new THREE.MeshStandardMaterial({color:0x8b7355,roughness:0.9}));
    hut.position.set(bwX,bwY+71,bwZ); scene.add(hut);
    const hutRoof = new THREE.Mesh(new THREE.ConeGeometry(3.5,2,4), new THREE.MeshStandardMaterial({color:0x5c3d2e}));
    hutRoof.position.set(bwX,bwY+73.5,bwZ); scene.add(hutRoof);
}

// Ice Hall entrance, glowing blue archway
{
    const ihX=-320, ihZ=-270;
    const ihY = getHeight(ihX,ihZ);
    const arch = new THREE.Mesh(new THREE.TorusGeometry(8,1.5,8,16,Math.PI), new THREE.MeshStandardMaterial({color:0x4488ff,emissive:0x2266cc,emissiveIntensity:0.8,roughness:0.2}));
    arch.position.set(ihX,ihY+8,ihZ); scene.add(arch);
    const archLight = new THREE.PointLight(0x4488ff,1,60); archLight.position.set(ihX,ihY+8,ihZ); scene.add(archLight);
}

// --- EMBER WASTES ---
// The Crucible, ring-shaped arena with orange glow
{
    const crX=420, crZ=80;
    const crY = getHeight(crX,crZ);
    const crucible = new THREE.Mesh(new THREE.TorusGeometry(18,3,8,24), new THREE.MeshStandardMaterial({color:0x8b4513,emissive:0xff6600,emissiveIntensity:0.7,roughness:0.6}));
    crucible.rotation.x = -Math.PI/2;
    crucible.position.set(crX,crY+3,crZ); scene.add(crucible);
    const crucibleLight = new THREE.PointLight(0xff6600,2,100); crucibleLight.position.set(crX,crY+8,crZ); scene.add(crucibleLight);
}

// Ash Gardens, charred stumps with embers
for(let i=0;i<12;i++){
    const ax=380+(Math.random()-0.5)*50, az=140+(Math.random()-0.5)*40;
    const ay=getHeight(ax,az);
    const stump=new THREE.Mesh(new THREE.CylinderGeometry(1,1.5,3+Math.random()*2,6), new THREE.MeshStandardMaterial({color:0x2a1a0a,roughness:0.95}));
    stump.position.set(ax,ay+1.5,az); scene.add(stump);
    if(Math.random()>0.5){
        const ember=new THREE.Mesh(new THREE.SphereGeometry(0.4,6,4), new THREE.MeshStandardMaterial({color:0xff4400,emissive:0xff2200,emissiveIntensity:1.5}));
        ember.position.set(ax,ay+3.5,az); scene.add(ember);
    }
}

// Stripe Caverns entrance, dark opening
{
    const scX=440, scZ=120;
    const scY = getHeight(scX,scZ);
    const cave = new THREE.Mesh(new THREE.CircleGeometry(6,8), new THREE.MeshStandardMaterial({color:0x0a0505,roughness:1}));
    cave.position.set(scX,scY+4,scZ);
    cave.lookAt(scX-10,scY+4,scZ);
    scene.add(cave);
}

// --- SUNWARD HEIGHTS ---
// The Purified Plateau, highest flat area glowing gold
{
    const ppX=370, ppZ=-320;
    const ppY = getHeight(ppX,ppZ);
    const plateau = new THREE.Mesh(new THREE.CylinderGeometry(25,28,3,12), new THREE.MeshStandardMaterial({color:0xffe8a0,emissive:0xffd700,emissiveIntensity:0.3,roughness:0.4,metalness:0.2}));
    plateau.position.set(ppX,ppY+1.5,ppZ); scene.add(plateau);
}

// Monochrome Monastery, small white cube buildings
for(let i=0;i<5;i++){
    const mx=340+i*8+(Math.random()-0.5)*4, mz=-280+(Math.random()-0.5)*12;
    const my=getHeight(mx,mz);
    const bld=new THREE.Mesh(new THREE.BoxGeometry(4+Math.random()*2,5+Math.random()*3,4+Math.random()*2), new THREE.MeshStandardMaterial({color:0xf5f5f0,roughness:0.6}));
    bld.position.set(mx,my+3,mz); bld.castShadow=true; scene.add(bld);
}

// The Noon Spire, tall thin white pillar (no shadow)
{
    const nsX=360, nsZ=-310;
    const nsY = getHeight(nsX,nsZ);
    const spire = new THREE.Mesh(new THREE.CylinderGeometry(0.8,1.2,50,8), new THREE.MeshStandardMaterial({color:0xffffff,emissive:0xfff8e0,emissiveIntensity:0.4,roughness:0.1,metalness:0.3}));
    spire.position.set(nsX,nsY+25,nsZ); spire.castShadow=false; scene.add(spire);
    const spireOrb = new THREE.Mesh(new THREE.SphereGeometry(1.5,12,8), new THREE.MeshStandardMaterial({color:0xffd700,emissive:0xffd700,emissiveIntensity:1.5}));
    spireOrb.position.set(nsX,nsY+51,nsZ); scene.add(spireOrb);
}

// --- ABYSSAL REACHES ---
// The Divide, visible crack in coastline cliff
{
    const divPts = [new THREE.Vector3(-20,getHeight(-20,-370)-10,-370), new THREE.Vector3(0,getHeight(0,-380)-15,-380), new THREE.Vector3(20,getHeight(20,-360)-10,-360)];
    const divCurve = new THREE.CatmullRomCurve3(divPts);
    const divTube = new THREE.TubeGeometry(divCurve,12,2,6,false);
    const divMesh = new THREE.Mesh(divTube, new THREE.MeshStandardMaterial({color:0x0a0a15,roughness:1}));
    scene.add(divMesh);
}

// Mirror Caves, bioluminescent blue dots
for(let i=0;i<25;i++){
    const cx=(Math.random()-0.5)*80, cz=-350-(Math.random()*30);
    const cy=getHeight(cx,cz)-5-Math.random()*10;
    const dot=new THREE.Mesh(new THREE.SphereGeometry(0.5,6,4), new THREE.MeshStandardMaterial({color:0x00aaff,emissive:0x0088ff,emissiveIntensity:2}));
    dot.position.set(cx,cy,cz); scene.add(dot);
}

// Tidal Courts, half-submerged structures
for(let i=0;i<4;i++){
    const tx=-30+i*20, tz=-365+Math.random()*10;
    const ty=-8;
    const court=new THREE.Mesh(new THREE.BoxGeometry(5,8,5), new THREE.MeshStandardMaterial({color:0x3d5566,roughness:0.7,metalness:0.2}));
    court.position.set(tx,ty,tz); scene.add(court);
    const courtRoof=new THREE.Mesh(new THREE.ConeGeometry(4,3,4), new THREE.MeshStandardMaterial({color:0x2a4050}));
    courtRoof.position.set(tx,ty+5.5,tz); scene.add(courtRoof);
}

// --- DEEPWOOD ---
// The Meadow of Marks, clearing with colorful flower dots
{
    const meadowColors = [0xff4444,0xffaa22,0xff66aa,0xaabb22,0x44aaff,0xffff44];
    for(let i=0;i<40;i++){
        const fx=230+(Math.random()-0.5)*50, fz=320+(Math.random()-0.5)*40;
        const fy=getHeight(fx,fz);
        const flower=new THREE.Mesh(new THREE.SphereGeometry(0.4,4,3), new THREE.MeshStandardMaterial({color:meadowColors[i%meadowColors.length],emissive:meadowColors[i%meadowColors.length],emissiveIntensity:0.3}));
        flower.position.set(fx,fy+0.5,fz); scene.add(flower);
    }
}

// Dalmatian's Post, thin watchtower with orange flame
{
    const dpX=290, dpZ=310;
    const dpY=getHeight(dpX,dpZ);
    const tower=new THREE.Mesh(new THREE.CylinderGeometry(1,1.5,25,6), new THREE.MeshStandardMaterial({color:0x5c4a3a,roughness:0.9}));
    tower.position.set(dpX,dpY+12.5,dpZ); tower.castShadow=true; scene.add(tower);
    const platform=new THREE.Mesh(new THREE.CylinderGeometry(3,3,1,8), new THREE.MeshStandardMaterial({color:0x4a3a2a}));
    platform.position.set(dpX,dpY+25.5,dpZ); scene.add(platform);
    const flame=new THREE.PointLight(0xff6600,1.5,50); flame.position.set(dpX,dpY+27,dpZ); scene.add(flame);
    const flameOrb=new THREE.Mesh(new THREE.SphereGeometry(0.8,6,4), new THREE.MeshStandardMaterial({color:0xff6600,emissive:0xff4400,emissiveIntensity:2}));
    flameOrb.position.set(dpX,dpY+27,dpZ); scene.add(flameOrb);
}

// Herding Grounds, rolling hills (no trees, just elevated bumps)
for(let i=0;i<6;i++){
    const hx=210+(Math.random()-0.5)*60, hz=380+(Math.random()-0.5)*40;
    const hy=getHeight(hx,hz);
    const hill=new THREE.Mesh(new THREE.SphereGeometry(8+Math.random()*6,8,6,0,Math.PI*2,0,Math.PI/2), new THREE.MeshStandardMaterial({color:0x4a7a30,roughness:0.9}));
    hill.position.set(hx,hy,hz); scene.add(hill);
}

// --- VIOLET HIGHLANDS ---
// Grand Assembly Hall, dome shape
{
    const gaX=-300, gaZ=300;
    const gaY=getHeight(gaX,gaZ);
    const base=new THREE.Mesh(new THREE.CylinderGeometry(15,15,8,12), new THREE.MeshStandardMaterial({color:0x5a4070,roughness:0.6,metalness:0.2}));
    base.position.set(gaX,gaY+4,gaZ); base.castShadow=true; scene.add(base);
    const dome=new THREE.Mesh(new THREE.SphereGeometry(15,16,12,0,Math.PI*2,0,Math.PI/2), new THREE.MeshStandardMaterial({color:0x7a5a8a,emissive:0x4a2a5a,emissiveIntensity:0.2,roughness:0.3,metalness:0.4}));
    dome.position.set(gaX,gaY+8,gaZ); dome.castShadow=true; scene.add(dome);
}

// Inscription Walls, long flat walls with lines
for(let i=0;i<3;i++){
    const wx=-280+i*25, wz=280+i*10;
    const wy=getHeight(wx,wz);
    const wall=new THREE.Mesh(new THREE.BoxGeometry(20,8,1), new THREE.MeshStandardMaterial({color:0x6a4a7a,roughness:0.7}));
    wall.position.set(wx,wy+4,wz); wall.rotation.y=0.3*i; wall.castShadow=true; scene.add(wall);
    // Subtle line texture via thin lighter strips
    for(let l=0;l<4;l++){
        const line=new THREE.Mesh(new THREE.BoxGeometry(18,0.3,0.2), new THREE.MeshStandardMaterial({color:0x9a7aaa,emissive:0x6a4a7a,emissiveIntensity:0.3}));
        line.position.set(wx,wy+2+l*1.5,wz+0.6); line.rotation.y=0.3*i; scene.add(line);
    }
}

// Classic Terraces, more pronounced step terrain
for(let i=0;i<5;i++){
    const tx=-320+i*15, tz=330-i*8;
    const ty=getHeight(tx,tz);
    const step=new THREE.Mesh(new THREE.BoxGeometry(30,2,15), new THREE.MeshStandardMaterial({color:new THREE.Color().setHSL(0.78,0.3,0.25+i*0.04),roughness:0.8}));
    step.position.set(tx,ty+i*2+1,tz); scene.add(step);
}

// --- SHADOWMIRE ---
// The Shiny's Beacon, bright white-gold point light
{
    const sbX=20, sbZ=420;
    const sbY=getHeight(sbX,sbZ);
    const beacon=new THREE.PointLight(0xfff8e0,3,200); beacon.position.set(sbX,sbY+15,sbZ); scene.add(beacon);
    const beaconOrb=new THREE.Mesh(new THREE.SphereGeometry(2,12,8), new THREE.MeshStandardMaterial({color:0xfff8e0,emissive:0xffd700,emissiveIntensity:2.5}));
    beaconOrb.position.set(sbX,sbY+15,sbZ); scene.add(beaconOrb);
    const beaconPole=new THREE.Mesh(new THREE.CylinderGeometry(0.5,0.8,14,6), new THREE.MeshStandardMaterial({color:0x3a3a2a,roughness:0.9}));
    beaconPole.position.set(sbX,sbY+7,sbZ); scene.add(beaconPole);
}

// Blot Pools, dark circular depressions
for(let i=0;i<6;i++){
    const bx=-15+Math.random()*50, bz=390+Math.random()*30;
    const by=getHeight(bx,bz);
    const pool=new THREE.Mesh(new THREE.CircleGeometry(4+Math.random()*3,12), new THREE.MeshStandardMaterial({color:0x1a0a20,roughness:1,metalness:0}));
    pool.rotation.x=-Math.PI/2; pool.position.set(bx,by+0.2,bz); scene.add(pool);
}

// Zombie Crypts, small dark rectangular structures half-sunken
for(let i=0;i<5;i++){
    const cx=-10+i*12, cz=410+Math.random()*15;
    const cy=getHeight(cx,cz);
    const crypt=new THREE.Mesh(new THREE.BoxGeometry(4,3,6), new THREE.MeshStandardMaterial({color:0x1a1a15,roughness:0.95}));
    crypt.position.set(cx,cy-0.5,cz); scene.add(crypt);
    const lid=new THREE.Mesh(new THREE.BoxGeometry(4.5,0.5,6.5), new THREE.MeshStandardMaterial({color:0x2a2a20}));
    lid.position.set(cx,cy+1,cz); scene.add(lid);
}

// --- STARTER LANDS (center) ---
// Scattered small settlements
for(let i=0;i<8;i++){
    const sx=(Math.random()-0.5)*60, sz=(Math.random()-0.5)*60;
    const sy=getHeight(sx,sz);
    const bld=new THREE.Mesh(new THREE.BoxGeometry(2+Math.random()*2,3+Math.random()*2,2+Math.random()*2), new THREE.MeshStandardMaterial({color:0x8a7a60,roughness:0.8}));
    bld.position.set(sx,sy+1.5,sz); bld.castShadow=true; scene.add(bld);
}

// Palehowl glow from above
{
    const paleLight = new THREE.SpotLight(0xeeeeff, 0.8, 300, Math.PI/6, 0.5, 1);
    paleLight.position.set(0, 200, 0);
    paleLight.target.position.set(0, 0, 0);
    scene.add(paleLight);
    scene.add(paleLight.target);
}

// ── Enhanced Text Label System ──
function createLoreLabel(text, position, color, size) {
    const canvas = document.createElement('canvas');
    const fontSize = size === 'large' ? 40 : size === 'medium' ? 28 : 20;
    canvas.width = 512; canvas.height = 64;
    const ctx = canvas.getContext('2d');
    ctx.font = (size === 'large' ? 'bold ' : '') + fontSize + 'px -apple-system, BlinkMacSystemFont, sans-serif';
    ctx.fillStyle = color || '#ffffff';
    ctx.textAlign = 'center';
    ctx.shadowColor = 'rgba(0,0,0,0.9)'; ctx.shadowBlur = 10;
    ctx.fillText(text, 256, 42);
    const tex = new THREE.CanvasTexture(canvas);
    const mat = new THREE.SpriteMaterial({ map:tex, transparent:true, opacity:0.9, depthTest:true, sizeAttenuation:true });
    const sprite = new THREE.Sprite(mat);
    sprite.scale.set(size==='large'?90:size==='medium'?60:45, size==='large'?11:size==='medium'?8:6, 1);
    sprite.position.copy(position);
    sprite.userData = { isLabel:true, baseOpacity:0.9 };
    return sprite;
}

// Tower name labels
const towerLabels = [];
for (const td of towerData) {
    const ty = getHeight(td.x,td.z);
    const label = createLoreLabel(td.name, new THREE.Vector3(td.x, ty+55, td.z), '#'+new THREE.Color(td.color).getHexString(), 'medium');
    scene.add(label);
    towerLabels.push(label);
}

// Major landmark labels (smaller)
const landmarkLabels = [
    {text:'Frozen Lake of Echoes', pos:new THREE.Vector3(-350,getHeight(-350,-300)+20,-300), color:'#d9ebff'},
    {text:"Bernard's Watch", pos:new THREE.Vector3(-390,getHeight(-390,-340)+80,-340), color:'#d9ebff'},
    {text:'The Crucible', pos:new THREE.Vector3(420,getHeight(420,80)+15,80), color:'#ff8844'},
    {text:'Ash Gardens', pos:new THREE.Vector3(380,getHeight(380,140)+12,140), color:'#cc6633'},
    {text:'Purified Plateau', pos:new THREE.Vector3(370,getHeight(370,-320)+12,-320), color:'#ffe6a3'},
    {text:'Noon Spire', pos:new THREE.Vector3(360,getHeight(360,-310)+58,-310), color:'#ffe6a3'},
    {text:'The Divide', pos:new THREE.Vector3(0,getHeight(0,-380)+5,-380), color:'#5577aa'},
    {text:'Meadow of Marks', pos:new THREE.Vector3(230,getHeight(230,320)+10,320), color:'#88cc44'},
    {text:"Dalmatian's Post", pos:new THREE.Vector3(290,getHeight(290,310)+32,310), color:'#88cc44'},
    {text:'Grand Assembly Hall', pos:new THREE.Vector3(-300,getHeight(-300,300)+28,300), color:'#9a6aaa'},
    {text:"Shiny's Beacon", pos:new THREE.Vector3(20,getHeight(20,420)+22,420), color:'#ffd700'},
];
for (const lm of landmarkLabels) {
    const label = createLoreLabel(lm.text, lm.pos, lm.color, 'small');
    scene.add(label);
    towerLabels.push(label);
}

// Distance-based label fading
function updateLabelFade() {
    for (const label of towerLabels) {
        if (!label.userData.isLabel) continue;
        const dist = camera.position.distanceTo(label.position);
        const fade = Math.max(0, Math.min(1, 1 - (dist - 200) / 600));
        label.material.opacity = fade * label.userData.baseOpacity;
    }
}

// ── Realm Labels (sprites) ──
function createTextSprite(text, color) {
    const canvas = document.createElement('canvas');
    canvas.width = 512; canvas.height = 64;
    const ctx = canvas.getContext('2d');
    ctx.font = 'bold 32px -apple-system, BlinkMacSystemFont, sans-serif';
    ctx.fillStyle = color || '#ffffff';
    ctx.textAlign = 'center';
    ctx.shadowColor = 'rgba(0,0,0,0.8)'; ctx.shadowBlur = 8;
    ctx.fillText(text, 256, 42);
    const tex = new THREE.CanvasTexture(canvas);
    const mat = new THREE.SpriteMaterial({ map:tex, transparent:true, opacity:0.85 });
    const sprite = new THREE.Sprite(mat);
    sprite.scale.set(80, 10, 1);
    return sprite;
}

for (const [name, r] of Object.entries(realms)) {
    if (name === 'Heartwood' || name === 'Solara Fields') continue;
    const label = createTextSprite(name, r.hex);
    label.position.set(r.x, getHeight(r.x, r.z)+60, r.z);
    scene.add(label);
}

setProgress(95);

// ── Legend ──
const legendEl = document.getElementById('legend');
for (const name of displayRealms) {
    const r = realms[name];
    const item = document.createElement('div');
    item.className = 'legend-item';
    item.innerHTML = `<div class="legend-dot" style="background:${r.hex}"></div>${name}`;
    item.addEventListener('click', () => flyTo(r.x, getHeight(r.x,r.z)+80, r.z, name));
    legendEl.appendChild(item);
}

// ── Roads & Trail Network ──
const roadGroup = new THREE.Group();
scene.add(roadGroup);

function sampleTerrainY(x, z, offset) {
    return getHeight(x, z) + (offset || 3);
}

function createRoad(waypoints, radius, color, emissiveColor, emissiveIntensity) {
    const pts = waypoints.map(p => new THREE.Vector3(p[0], sampleTerrainY(p[0], p[1], 4), p[1]));
    const curve = new THREE.CatmullRomCurve3(pts, false, 'catmullrom', 0.5);
    const tubeGeo = new THREE.TubeGeometry(curve, Math.max(20, pts.length * 8), radius || 1.5, 6, false);
    const mat = new THREE.MeshStandardMaterial({ color: color || 0x8B7355, emissive: emissiveColor || 0x8B7355, emissiveIntensity: emissiveIntensity || 0.15, roughness: 0.85 });
    const mesh = new THREE.Mesh(tubeGeo, mat);
    roadGroup.add(mesh);
    return mesh;
}

function createTrail(waypoints) {
    const pts = waypoints.map(p => new THREE.Vector3(p[0], sampleTerrainY(p[0], p[1], 3), p[1]));
    const geo = new THREE.BufferGeometry().setFromPoints(pts);
    const mat = new THREE.LineDashedMaterial({ color: 0x9B8A6E, dashSize: 4, gapSize: 3, transparent: true, opacity: 0.6 });
    const line = new THREE.Line(geo, mat);
    line.computeLineDistances();
    roadGroup.add(line);
    return line;
}

function createBridge(x1, z1, x2, z2, y) {
    const mx = (x1+x2)/2, mz = (z1+z2)/2;
    const len = Math.sqrt((x2-x1)**2+(z2-z1)**2);
    const angle = Math.atan2(z2-z1, x2-x1);
    const bridge = new THREE.Mesh(
        new THREE.BoxGeometry(len, 1.5, 5),
        new THREE.MeshStandardMaterial({ color: 0x6B5B45, roughness: 0.8 })
    );
    bridge.position.set(mx, y + 2, mz);
    bridge.rotation.y = -angle;
    // Slight arch
    const rail1 = new THREE.Mesh(new THREE.BoxGeometry(len, 3, 0.5), new THREE.MeshStandardMaterial({ color: 0x5A4A35 }));
    rail1.position.set(mx, y + 3.5, mz + 2.2 * Math.cos(angle));
    rail1.rotation.y = -angle;
    const rail2 = rail1.clone();
    rail2.position.set(mx, y + 3.5, mz - 2.2 * Math.cos(angle));
    roadGroup.add(bridge, rail1, rail2);
}

// Major Roads
// The Great Circuit - connecting 6 towers in hexagon
createRoad([
    [200, 280], [150, 300], [80, 320], [0, 340], [-50, 340],  // Forge→Violet Citadel
    [-50, 340], [-30, 300], [-10, 260], [0, 200],              // Violet Citadel→Heartstring
    [0, 200], [30, 150], [60, 50], [0, -100],                  // Heartstring→center→north
    [0, -100], [-20, -200], [-50, -320], [0, -320],            // →Tidewatch area
    [0, -320], [30, -310], [80, -290], [150, -280],            // Tidewatch→east
    [150, -280], [200, -200], [220, -50], [230, 100], [200, 280] // →back to Forge
], 1.5, 0x8B7355, 0x8B7355, 0.15);

// Frosthollow Road
createRoad([
    [-30, -100], [-80, -120], [-150, -150], [-200, -180], [-250, -220], [-300, -260], [-340, -290], [-350, -300]
], 1.5, 0x8B7355, 0x8B7355, 0.15);

// Ember Trail - gets darker near volcanoes
createRoad([
    [60, 50], [120, 60], [180, 70], [250, 80], [320, 90], [380, 95], [400, 100]
], 1.5, 0x5A3A20, 0x5A3A20, 0.1);

// Sunward Path with switchbacks
createRoad([
    [60, -100], [120, -140], [160, -180], [200, -200], [240, -230], [280, -260], [320, -280], [350, -300]
], 1.5, 0x8B7355, 0xAA9060, 0.2);

// Coastal Road along Abyssal Reaches
createRoad([
    [-50, -380], [-30, -375], [0, -370], [30, -365], [60, -360], [80, -355]
], 1.5, 0x5A6A7A, 0x5A6A7A, 0.1);

// Forest Path through Deepwood
createRoad([
    [150, 300], [180, 310], [200, 320], [220, 330], [240, 340], [250, 350]
], 1.2, 0x4A6A35, 0x4A6A35, 0.1);

// Highland Way through Violet Highlands
createRoad([
    [-100, 250], [-150, 260], [-200, 270], [-240, 280], [-270, 290], [-300, 300]
], 1.5, 0x6A4A7A, 0x6A4A7A, 0.1);

// Shadowmire Causeway - elevated
createRoad([
    [0, 300], [0, 330], [0, 360], [0, 390], [0, 420]
], 1.8, 0x4A4A35, 0x4A4A35, 0.1);

// Minor Trails
// Trail circling Frozen Lake
{
    const lakePts = [];
    for (let a = 0; a <= Math.PI * 2; a += Math.PI / 8) {
        lakePts.push([-350 + Math.cos(a) * 60, -300 + Math.sin(a) * 60]);
    }
    lakePts.push(lakePts[0].slice());
    createTrail(lakePts);
}

// Dalmatian's Post to Heartwood
createTrail([[290, 310], [275, 320], [265, 335], [255, 345], [250, 350]]);

// Trails between Starter Lands settlements
createTrail([[-20, -20], [0, 0], [20, 20], [30, 10]]);
createTrail([[0, 0], [-15, 30], [0, 50]]);
createTrail([[0, 0], [30, -20], [50, -10]]);

// Trail skirting the Crucible
createTrail([[400, 60], [410, 70], [420, 65], [430, 75], [435, 90], [425, 100]]);

// Trails from realms to nearest towers
createTrail([[-350, -300], [-300, -260], [-200, -180], [-100, -100], [-50, -50], [0, 0]]); // Frosthollow→center
createTrail([[400, 100], [350, 150], [280, 200], [200, 280]]); // Ember→Forge
createTrail([[350, -300], [300, -250], [200, -150], [100, -50]]); // Sunward→center
createTrail([[0, -350], [0, -250], [0, -150], [0, -50]]); // Abyssal→center
createTrail([[-300, 300], [-200, 300], [-100, 320], [-50, 340]]); // Violet→Citadel
createTrail([[0, 400], [0, 350], [0, 300], [0, 200]]); // Shadowmire→Heartstring

// Bridges
createBridge(-150, -150, -130, -140, sampleTerrainY(-140, -145, 0)); // Frosthollow road bridge
createBridge(250, 80, 270, 85, sampleTerrainY(260, 82, 0)); // Ember trail bridge
createBridge(0, 360, 10, 370, getHeight(5, 365) - 3); // Shadowmire causeway bridge
createBridge(-30, -375, -10, -370, -6); // Coastal road bridge over water

// ── 3D Wizard Dog Models ──
const dogGroups = [];      // THREE.Group per dog (for raycasting & animation)
const dogMeshParts = [];   // flat array of all dog child meshes (for raycasting)
const dogLabels = [];
const dogTooltip = document.createElement('div');
dogTooltip.style.cssText = 'position:fixed;z-index:60;padding:8px 14px;border-radius:10px;background:rgba(20,20,22,0.92);backdrop-filter:blur(12px);color:#fff;font-size:13px;font-weight:600;pointer-events:none;display:none;white-space:nowrap;font-family:-apple-system,BlinkMacSystemFont,sans-serif;border:1px solid rgba(255,255,255,0.12);line-height:1.5;';
document.body.appendChild(dogTooltip);

const realmPlacement = {
    'Frosthollow': { cx:-350, cz:-300, spread:160 },
    'Ember Wastes': { cx:400, cz:100, spread:160 },
    'Sunward Heights': { cx:350, cz:-300, spread:160 },
    'Abyssal Reaches': { cx:0, cz:-350, spread:160 },
    'Deepwood': { cx:250, cz:350, spread:160 },
    'Violet Highlands': { cx:-300, cz:300, spread:200 },
    'Shadowmire': { cx:0, cz:400, spread:160 },
    'Starter Lands': { cx:0, cz:0, spread:160 },
};

function seededRandom(seed) {
    let s = seed;
    return function() { s = (s * 16807 + 0) % 2147483647; return s / 2147483647; };
}

function createDogLabel(text) {
    const lines = text.split('\n');
    const canvas = document.createElement('canvas');
    canvas.width = 256; canvas.height = 64;
    const ctx = canvas.getContext('2d');
    ctx.shadowColor = 'rgba(0,0,0,0.9)'; ctx.shadowBlur = 4;
    ctx.textAlign = 'center';
    // Name line
    ctx.font = 'bold 18px -apple-system, BlinkMacSystemFont, sans-serif';
    ctx.fillStyle = '#ffffff';
    ctx.fillText(lines[0], 128, 22);
    // Traits line
    if (lines[1]) {
        ctx.font = '12px -apple-system, BlinkMacSystemFont, sans-serif';
        ctx.fillStyle = '#c9a86c';
        ctx.fillText(lines[1], 128, 44);
    }
    const tex = new THREE.CanvasTexture(canvas);
    const mat = new THREE.SpriteMaterial({ map:tex, transparent:true, opacity:0.85, depthTest:true, sizeAttenuation:true });
    const sprite = new THREE.Sprite(mat);
    sprite.scale.set(42, 12, 1);
    return sprite;
}

// Wanderer path through all realms
const wandererPath = new THREE.CatmullRomCurve3([
    new THREE.Vector3(0, 0, 0),
    new THREE.Vector3(-350, 0, -300),
    new THREE.Vector3(0, 0, -350),
    new THREE.Vector3(350, 0, -300),
    new THREE.Vector3(400, 0, 100),
    new THREE.Vector3(250, 0, 350),
    new THREE.Vector3(-300, 0, 300),
    new THREE.Vector3(0, 0, 400),
    new THREE.Vector3(0, 0, 0),
], true);

let wandererGroup = null;
let wandererLight = null;
let wandererLabel = null;

// ── Texture loader for PFP sprites ──
const texLoader = new THREE.TextureLoader();

function createDogModel(dog) {
    const group = new THREE.Group();
    const id = dog.id || '0';
    const orderColor = orderColorsHex[dog.order] || '#ffffff';
    const orderHex = parseInt(orderColor.replace('#',''), 16);

    // Load PFP image as billboard plane (NOT sprite, sprites blend and look washed out)
    const imgPath = `images/${id}.png`;
    const planeGeo = getCachedGeo('dogPfpPlane', () => new THREE.PlaneGeometry(22, 22));
    const planeMat = new THREE.MeshBasicMaterial({
        color: 0xffffff,
        transparent: true,
        alphaTest: 0.5,
        side: THREE.DoubleSide,
        depthWrite: true,
        fog: false
    });
    const pfpMesh = new THREE.Mesh(planeGeo, planeMat);
    pfpMesh.position.set(0, 14, 0);
    pfpMesh.userData.isBillboard = true;
    group.add(pfpMesh);

    // Load texture async
    texLoader.load(imgPath, (tex) => {
        tex.minFilter = THREE.LinearFilter;
        tex.magFilter = THREE.LinearFilter;
        tex.colorSpace = THREE.SRGBColorSpace;
        planeMat.map = tex;
        planeMat.needsUpdate = true;
    }, undefined, () => {
        // Fallback: colored circle if image fails
        const canvas = document.createElement('canvas');
        canvas.width = 128; canvas.height = 128;
        const ctx = canvas.getContext('2d');
        ctx.beginPath(); ctx.arc(64, 64, 60, 0, Math.PI * 2);
        ctx.fillStyle = orderColor; ctx.fill();
        ctx.strokeStyle = '#fff'; ctx.lineWidth = 4; ctx.stroke();
        ctx.font = 'bold 28px sans-serif'; ctx.fillStyle = '#fff'; ctx.textAlign = 'center';
        ctx.fillText('#' + id, 64, 72);
        const fallbackTex = new THREE.CanvasTexture(canvas);
        fallbackTex.colorSpace = THREE.SRGBColorSpace;
        planeMat.map = fallbackTex;
        planeMat.needsUpdate = true;
    });

    // Order-colored glow ring beneath the sprite
    const ringGeo = new THREE.RingGeometry(10, 12, 24);
    const ringMat = new THREE.MeshBasicMaterial({ color: orderHex, transparent: true, opacity: 0.4, side: THREE.DoubleSide });
    const ring = new THREE.Mesh(ringGeo, ringMat);
    ring.rotation.x = -Math.PI / 2;
    ring.position.y = 0.5;
    group.add(ring);

    return group;
}


// ── Material & Geometry Caches ──
const matCache = {};
function getCachedMat(hex, opts) {
    const key = hex + '_' + JSON.stringify(opts || {});
    if (!matCache[key]) {
        matCache[key] = new THREE.MeshStandardMaterial({ color:hex, roughness:0.75, metalness:0.05, ...opts });
    }
    return matCache[key];
}
const geoCache = {};
function getCachedGeo(key, factory) {
    if (!geoCache[key]) geoCache[key] = factory();
    return geoCache[key];
}

// ── Castle House Creation ──
const castleFlags = []; // track flags for wave animation

const realmCastleStyle = {
    'Frosthollow': { stoneTint: 0xb0c8dd, windowColor: 0xffdd66, snowRoof: true },
    'Ember Wastes': { stoneTint: 0x2a1a1a, windowColor: 0xff6600, snowRoof: false },
    'Sunward Heights': { stoneTint: 0xf0e8d0, windowColor: 0xffffaa, snowRoof: false },
    'Deepwood': { stoneTint: 0x778877, windowColor: 0xffdd66, moss: true },
    'Violet Highlands': { stoneTint: 0x7a6a8a, windowColor: 0xffdd66, snowRoof: false },
    'Shadowmire': { stoneTint: 0x2a2a22, windowColor: 0x44ff66, snowRoof: false },
    'Abyssal Reaches': { stoneTint: 0x6a7a8a, windowColor: 0xffdd66, snowRoof: false },
    'Starter Lands': { stoneTint: 0x8a8a7a, windowColor: 0xffdd66, snowRoof: false },
};

// Shared castle geometries
const castleWallGeo = new THREE.BoxGeometry(8, 10, 8);
const castleBaseGeo = new THREE.BoxGeometry(10, 1.5, 10);
const castleCrenGeo = new THREE.BoxGeometry(1.2, 1.5, 1.2);
const castleTowerGeo = new THREE.CylinderGeometry(3, 3, 14, isMobile ? 6 : 8);
const castleRoofGeo = new THREE.ConeGeometry(3.5, 4, isMobile ? 6 : 8);
const castleDoorGeo = new THREE.BoxGeometry(2, 3.5, 0.5);
const castleDoorTopGeo = new THREE.SphereGeometry(1, 6, 4, 0, Math.PI * 2, 0, Math.PI / 2);
const castleWindowGeo = new THREE.BoxGeometry(1, 1, 0.5);
const castleFlagGeo = new THREE.PlaneGeometry(2.5, 1.5, 4, 3);
const castlePathGeo = new THREE.BoxGeometry(2, 0.3, 15);

function createCastleHouse(dog, dogX, dogZ, dogRotY) {
    const group = new THREE.Group();
    const realm = realmAliases[dog.realm] || dog.realm;
    const style = realmCastleStyle[realm] || realmCastleStyle['Starter Lands'];
    const orderColor = parseInt((orderColorsHex[dog.order] || '#ffffff').replace('#',''), 16);

    const stoneMat = getCachedMat(style.stoneTint, { roughness: 0.9, metalness: 0 });
    const darkMat = getCachedMat(0x0a0a0a, { roughness: 1 });
    const windowMat = getCachedMat(style.windowColor, { emissive: style.windowColor, emissiveIntensity: 0.8, roughness: 0.3 });

    // Main structure
    const wall = new THREE.Mesh(castleWallGeo, stoneMat);
    wall.position.y = 5;
    wall.castShadow = true;
    group.add(wall);

    // Base/foundation
    const base = new THREE.Mesh(castleBaseGeo, getCachedMat(new THREE.Color(style.stoneTint).multiplyScalar(0.7).getHex(), { roughness: 0.95 }));
    base.position.y = -0.25;
    group.add(base);

    // Crenellations along top
    const crenPositions = [
        [-3, 10.75, -3], [-1, 10.75, -3], [1, 10.75, -3], [3, 10.75, -3],
        [-3, 10.75, 3], [3, 10.75, 3],
        [-3, 10.75, -1], [-3, 10.75, 1], [3, 10.75, -1], [3, 10.75, 1]
    ];
    for (const [cx, cy, cz] of crenPositions) {
        const cren = new THREE.Mesh(castleCrenGeo, stoneMat);
        cren.position.set(cx, cy, cz);
        group.add(cren);
    }

    // Tower on corner
    const tower = new THREE.Mesh(castleTowerGeo, stoneMat);
    tower.position.set(4, 7, -4);
    tower.castShadow = true;
    group.add(tower);

    // Tower roof
    const roof = new THREE.Mesh(castleRoofGeo, getCachedMat(orderColor, { roughness: 0.5 }));
    roof.position.set(4, 16, -4);
    group.add(roof);

    // Snow on roof for Frosthollow
    if (style.snowRoof) {
        const snowMat = getCachedMat(0xffffff, { roughness: 0.8 });
        const snow1 = new THREE.Mesh(new THREE.BoxGeometry(8.5, 0.5, 8.5), snowMat);
        snow1.position.y = 10.5;
        group.add(snow1);
        const snow2 = new THREE.Mesh(new THREE.ConeGeometry(3.8, 1, isMobile ? 6 : 8), snowMat);
        snow2.position.set(4, 18.5, -4);
        group.add(snow2);
    }

    // Moss for Deepwood
    if (style.moss && !isMobile) {
        const mossMat = getCachedMat(0x44aa44, { roughness: 0.9 });
        const mossRng = seededRandom(parseInt(dog.id) * 31);
        for (let i = 0; i < 8; i++) {
            const m = new THREE.Mesh(getCachedGeo('moss', () => new THREE.SphereGeometry(0.4, 4, 3)), mossMat);
            m.position.set((mossRng()-0.5)*8, mossRng()*8, (mossRng()-0.5)*8);
            group.add(m);
        }
    }

    // Door (dark opening on front face)
    const door = new THREE.Mesh(castleDoorGeo, darkMat);
    door.position.set(0, 1.75, 4.25);
    group.add(door);
    // Arch top
    const doorTop = new THREE.Mesh(castleDoorTopGeo, darkMat);
    doorTop.position.set(0, 3.5, 4.25);
    doorTop.rotation.x = Math.PI;
    doorTop.scale.set(1, 0.5, 0.5);
    group.add(doorTop);

    // Windows
    const win1 = new THREE.Mesh(castleWindowGeo, windowMat);
    win1.position.set(-2, 6, 4.25);
    group.add(win1);
    const win2 = new THREE.Mesh(castleWindowGeo, windowMat);
    win2.position.set(2, 6, 4.25);
    group.add(win2);

    // Flag on turret
    const flagMat = new THREE.MeshStandardMaterial({ color: orderColor, roughness: 0.6, side: THREE.DoubleSide });
    const flag = new THREE.Mesh(castleFlagGeo.clone(), flagMat);
    flag.position.set(4, 19, -4);
    group.add(flag);
    castleFlags.push(flag);

    // Path connecting to dog position (laid flat)
    const pathMat = getCachedMat(0x8B7355, { roughness: 0.9 });
    const path = new THREE.Mesh(castlePathGeo, pathMat);
    path.position.set(0, 0.15, 11.5);
    group.add(path);

    // Offset castle ~15 units to the side of the dog
    const offsetAngle = dogRotY + Math.PI / 2;
    const castleX = dogX + Math.cos(offsetAngle) * 15;
    const castleZ = dogZ + Math.sin(offsetAngle) * 15;
    const castleY = getHeight(castleX, castleZ);
    group.position.set(castleX, castleY, castleZ);
    group.rotation.y = dogRotY;

    return group;
}

// ── Batch dog creation ──
let dogIndex = 0;
const dogEntries = Object.entries(wizardDogs);
const DOGS_PER_FRAME = 10;
const placedPositions = []; // track placed dog positions for min distance

function loadDogBatch() {
    const end = Math.min(dogIndex + DOGS_PER_FRAME, dogEntries.length);
    for (let i = dogIndex; i < end; i++) {
        const [id, dog] = dogEntries[i];
        const isWanderer = id === '6164';
        const realm = realmAliases[dog.realm] || dog.realm;
        const placement = realmPlacement[realm] || realmPlacement['Starter Lands'];
        const rng = seededRandom(parseInt(id));

        let dx, dz;
        if (isWanderer) { dx = 0; dz = 0; }
        else {
            // Place with minimum distance check (30 units)
            let attempts = 0;
            do {
                const angle = rng() * Math.PI * 2;
                const dist = (0.3 + rng() * 0.7) * placement.spread;
                dx = placement.cx + Math.cos(angle) * dist;
                dz = placement.cz + Math.sin(angle) * dist;
                attempts++;
                let tooClose = false;
                for (const pp of placedPositions) {
                    const ddx = dx - pp.x, ddz = dz - pp.z;
                    if (ddx*ddx + ddz*ddz < 900) { tooClose = true; break; } // 30^2 = 900
                }
                if (!tooClose || attempts > 20) break;
            } while (true);
            placedPositions.push({ x: dx, z: dz });
        }

        const dy = getHeight(dx, dz);
        const facingAngle = rng() * Math.PI * 2;
        const group = createDogModel(dog);
        group.position.set(dx, dy, dz);
        group.rotation.y = facingAngle;
        group.userData.type = 'dog';
        group.userData.id = id;
        group.userData.dog = dog;
        group.userData.baseY = dy;
        group.userData.phase = rng() * Math.PI * 2;
        group.userData.isWanderer = isWanderer;
        group.userData.hoverJump = 0;

        scene.add(group);
        dogGroups.push(group);
        group.traverse(c => { if (c.isMesh) { c.userData._dogGroup = group; dogMeshParts.push(c); } });

        // Castle house (not for The Wanderer)
        if (!isWanderer) {
            const castle = createCastleHouse(dog, dx, dz, facingAngle);
            scene.add(castle);
        }

        // Name label with traits
        const firstName = (dog.suggestedName || '#' + id).split(' ')[0];
        const traitLine = `${dog.pattern} · ${dog.fur} · ${dog.eyes}${dog.clothes !== 'None' ? ' · ' + dog.clothes : ''}`;
        const label = createDogLabel(firstName + '\n' + traitLine);
        label.position.set(dx, dy + 55, dz);
        label.userData = { parentGroup: group };
        scene.add(label);
        dogLabels.push(label);

        if (isWanderer) {
            wandererGroup = group;
            wandererLight = new THREE.PointLight(0x9966ff, 1.5, 60);
            wandererLight.position.set(dx, dy + 5, dz);
            scene.add(wandererLight);
            wandererLabel = label;
        }
    }
    dogIndex = end;
    const pct = Math.floor((dogIndex / dogEntries.length) * 5);
    setProgress(Math.min(95 + pct, 99));
    if (dogIndex < dogEntries.length) {
        requestAnimationFrame(loadDogBatch);
    }
}
loadDogBatch();

function showDogPanel(dog) {
    const panel = document.getElementById('infoPanel');
    const content = document.getElementById('infoPanelContent');
    const orderColor = orderColorsHex[dog.order] || '#fff';
    content.innerHTML = `
        <div style="text-align:center;margin-bottom:16px;">
            <img src="${dog.image}" style="width:120px;height:120px;border-radius:16px;object-fit:cover;border:2px solid ${orderColor};" onerror="this.style.display='none'">
        </div>
        <div class="info-realm-name" style="color:${orderColor}">${dog.suggestedName || '#' + dog.id}</div>
        <div class="info-motto">#${dog.id} • ${dog.order} Order</div>
        <div class="info-section"><h3>Details</h3>
            <div class="info-tags">
                <span class="info-tag">Rank: ${dog.rank}</span>
                <span class="info-tag">Realm: ${dog.realm}</span>
                <span class="info-tag">Fur: ${dog.fur}</span>
                <span class="info-tag">Pattern: ${dog.pattern}</span>
                <span class="info-tag">Eyes: ${dog.eyes}</span>
                ${dog.clothes !== 'None' ? `<span class="info-tag">Clothes: ${dog.clothes}</span>` : ''}
            </div>
        </div>
        ${dog.suggestedStory ? `<div class="info-section"><h3>Origin Story</h3><p style="color:var(--color-text-secondary);font-size:14px;line-height:1.7;">${dog.suggestedStory.replace(/\\n/g, '<br><br>')}</p></div>` : ''}
    `;
    panel.classList.add('open');
}

// Dog animation
function updateDogs(time) {
    const camPos = camera.position;
    for (const g of dogGroups) {
        const ud = g.userData;

        // Wanderer movement
        if (ud.isWanderer) {
            const t = (time % 120) / 120;
            const pos = wandererPath.getPoint(t);
            pos.y = getHeight(pos.x, pos.z);
            g.position.set(pos.x, pos.y, pos.z);
            ud.baseY = pos.y;
            // Face direction of travel
            const ahead = wandererPath.getPoint((t + 0.005) % 1);
            g.rotation.y = Math.atan2(ahead.x - pos.x, ahead.z - pos.z);
            if (wandererLight) wandererLight.position.set(pos.x, pos.y + 8, pos.z);
        }

        // Idle bob
        const bob = Math.sin(time * 1.2 + ud.phase) * 0.5;
        g.position.y = ud.baseY + bob + ud.hoverJump;

        // Decay hover jump
        if (ud.hoverJump > 0) ud.hoverJump *= 0.92;

        // Tail wag (slightly larger amplitude for Pixar appeal)
        const tail = ud._tailGroup;
        if (tail) tail.rotation.y = Math.sin(time * 4 + ud.phase) * 0.4;

        // LOD
        const dist = camPos.distanceTo(g.position);
        const lod = g.userData._lodMesh;
        if (lod) {
            const far = dist > 900;
            lod.visible = far;
            const detail = g.userData._detailChildren;
            if (detail) for (const c of detail) c.visible = !far;
        }
    }

    // Labels
    for (const label of dogLabels) {
        const parent = label.userData.parentGroup;
        if (parent) {
            label.position.set(parent.position.x, parent.position.y + 55, parent.position.z);
            const dist = camPos.distanceTo(parent.position);
            label.material.opacity = dist < 600 ? 0.85 * Math.max(0, 1 - (dist - 200) / 400) : 0;
            label.visible = dist < 600;
        }
    }
}

// Dog hover/click
let hoveredDogGroup = null;

function onMouseMove(e) {
    const rect = renderer.domElement.getBoundingClientRect();
    mouse.x = ((e.clientX - rect.left) / rect.width) * 2 - 1;
    mouse.y = -((e.clientY - rect.top) / rect.height) * 2 + 1;
    raycaster.setFromCamera(mouse, camera);
    const hits = raycaster.intersectObjects(dogMeshParts);

    if (hits.length > 0) {
        const hitGroup = hits[0].object.userData._dogGroup;
        if (hitGroup && hitGroup !== hoveredDogGroup) {
            hoveredDogGroup = hitGroup;
            hitGroup.userData.hoverJump = 2.5; // little jump
        }
        if (hitGroup) {
            const dog = hitGroup.userData.dog;
            dogTooltip.style.display = 'block';
            dogTooltip.style.left = (e.clientX + 12) + 'px';
            dogTooltip.style.top = (e.clientY - 10) + 'px';
            dogTooltip.innerHTML = `<span style="color:${orderColorsHex[dog.order]}">#${dog.id}</span> ${dog.suggestedName || ''}<br><span style="color:#c9a86c;font-size:11px;font-weight:400">${dog.pattern} · ${dog.fur} · ${dog.eyes}${dog.clothes !== 'None' ? ' · ' + dog.clothes : ''}</span>`;
            renderer.domElement.style.cursor = 'pointer';
        }
    } else {
        hoveredDogGroup = null;
        dogTooltip.style.display = 'none';
        renderer.domElement.style.cursor = '';
    }
}
renderer.domElement.addEventListener('mousemove', onMouseMove);

// ── Raycasting & Interaction ──
const raycaster = new THREE.Raycaster();
const mouse = new THREE.Vector2();
let animatingCamera = false;

function flyTo(x, y, z, selectRealm) {
    if (animatingCamera) return;
    animatingCamera = true;
    controls.autoRotate = false;
    const startPos = camera.position.clone();
    const startTarget = controls.target.clone();
    const endTarget = new THREE.Vector3(x, Math.max(y-60, 0), z);
    const endPos = new THREE.Vector3(x + 80, y + 100, z + 120);
    const duration = 1.5;
    const startTime = clock.getElapsedTime();

    function animStep() {
        const elapsed = clock.getElapsedTime() - startTime;
        let t = Math.min(1, elapsed / duration);
        t = t < 0.5 ? 4*t*t*t : 1-Math.pow(-2*t+2,3)/2; // ease in-out cubic
        camera.position.lerpVectors(startPos, endPos, t);
        controls.target.lerpVectors(startTarget, endTarget, t);
        if (t < 1) requestAnimationFrame(animStep);
        else {
            animatingCamera = false;
            if (selectRealm) showRealmPanel(selectRealm);
        }
    }
    animStep();
}

function showRealmPanel(name) {
    const r = realms[name];
    if (!r) return;
    const dogs = Object.values(wizardDogs).filter(d => {
        const dr = d.realm;
        if (dr === name) return true;
        if (realmAliases[dr] === name) return true;
        return false;
    });

    const panel = document.getElementById('infoPanel');
    const content = document.getElementById('infoPanelContent');
    content.innerHTML = `
        <div class="info-realm-name" style="color:${r.hex}">${name}</div>
        ${r.motto ? `<div class="info-motto">${r.motto}</div>` : ''}
        <div class="info-section"><h3>Description</h3><p>${r.desc}</p></div>
        <div class="info-section"><h3>Landmarks</h3><div class="info-tags">${r.landmarks.map(l=>`<span class="info-tag">${l}</span>`).join('')}</div></div>
        <div class="info-section"><h3>Breeds</h3><div class="info-tags">${(Array.isArray(r.breeds)?r.breeds:[r.breeds]).map(b=>`<span class="info-tag">${b}</span>`).join('')}</div></div>
        <div class="info-section"><h3>Known For</h3><p>${r.knownFor}</p></div>
        <div class="info-section"><h3>Wizards (${dogs.length})</h3>
            <div class="dog-cards">${dogs.map(d => `
                <div class="dog-card">
                    <img src="${d.image}" alt="${d.suggestedName}" loading="lazy" onerror="this.style.display='none'">
                    <div class="dog-name" style="color:${orderColorsHex[d.order]}">${d.suggestedName?.split(' ')[0] || '#'+d.id}</div>
                    <div class="dog-order">${d.order} Order</div>
                </div>
            `).join('')}</div>
        </div>
    `;
    panel.classList.add('open');
}

function showTowerPanel(data) {
    const panel = document.getElementById('infoPanel');
    const content = document.getElementById('infoPanelContent');
    const hex = '#' + new THREE.Color(data.color).getHexString();
    content.innerHTML = `
        <div class="info-realm-name" style="color:${hex}">${data.name}</div>
        <div class="info-motto">${data.order} Order</div>
        <div class="info-section"><h3>Description</h3><p>${data.desc}</p></div>
    `;
    panel.classList.add('open');
}

function showMoonPanel(data) {
    const panel = document.getElementById('infoPanel');
    const content = document.getElementById('infoPanelContent');
    const md = moonData[data.index];
    const hex = '#' + new THREE.Color(md.color).getHexString();

    // Calculate current phase
    const time = clock.getElapsedTime();
    const phase = (time * data.phaseSpeed + data.phaseOffset) % (Math.PI * 2);
    const phasePct = (Math.sin(phase) + 1) / 2;
    let phaseName = 'New';
    if (phasePct > 0.9) phaseName = 'Full';
    else if (phasePct > 0.6) phaseName = 'Waxing Gibbous';
    else if (phasePct > 0.45) phaseName = 'First Quarter';
    else if (phasePct > 0.2) phaseName = 'Waxing Crescent';
    else phaseName = 'New';
    // Check if waning
    const phaseDir = Math.cos(phase);
    if (phaseDir < 0 && phasePct < 0.9) {
        phaseName = phaseName.replace('Waxing', 'Waning').replace('First', 'Third');
    }

    const magicStr = phasePct > 0.8 ? 'Surging' : phasePct > 0.5 ? 'Strong' : phasePct > 0.2 ? 'Dim' : 'Dormant';
    const barWidth = Math.round(phasePct * 100);

    const isPalehowl = data.index === 6;
    const desc = isPalehowl
        ? 'The smallest, dimmest moon. The seventh tone of the First Howl, carrying not power but possibility. It provides baseline magic to all non-wizard dogs. Weak individually, but it touches EVERYONE. The Wanderer resonates with Palehowl.'
        : `Tied to the ${md.order} Order. Its ${md.cycle}-day cycle matches its ${md.wizards} Wizards. When full, ${md.order} magic surges. When new, ${md.order} Wizards rely on raw skill and pack bonds.`;

    content.innerHTML = `
        <div class="info-realm-name" style="color:${hex}">${md.name}</div>
        <div class="info-motto">${isPalehowl ? 'The Starter Moon' : md.order + ' Order Moon'}</div>
        <div class="info-section">
            <h3>Current Phase</h3>
            <p style="font-size:1.1em;color:${hex};font-weight:600">${phaseName}</p>
            <div style="margin:8px 0;height:8px;background:rgba(255,255,255,0.08);border-radius:4px;overflow:hidden">
                <div style="width:${barWidth}%;height:100%;background:${hex};border-radius:4px;transition:width 0.3s"></div>
            </div>
            <p style="font-size:0.85em;color:rgba(255,255,255,0.5)">Magic Power: ${magicStr} (${Math.round(phasePct*100)}%)</p>
        </div>
        <div class="info-section">
            <h3>Cycle</h3>
            <p>${md.cycle}-day orbital period${!isPalehowl ? ' | ' + md.wizards + ' Wizards' : ''}</p>
        </div>
        <div class="info-section">
            <h3>Lore</h3>
            <p>${desc}</p>
        </div>
    `;
    panel.classList.add('open');
}

window.closePanel = function() {
    document.getElementById('infoPanel').classList.remove('open');
};

function onClick(e) {
    const rect = renderer.domElement.getBoundingClientRect();
    mouse.x = ((e.clientX - rect.left)/rect.width)*2 - 1;
    mouse.y = -((e.clientY - rect.top)/rect.height)*2 + 1;
    raycaster.setFromCamera(mouse, camera);

    // Check dogs (3D models)
    const dogHits = raycaster.intersectObjects(dogMeshParts);
    if (dogHits.length > 0) {
        const dg = dogHits[0].object.userData._dogGroup;
        if (dg) { showDogPanel(dg.userData.dog); return; }
    }

    // Check towers
    for (const t of towers) {
        const hits = raycaster.intersectObjects(t.children, true);
        if (hits.length > 0) { showTowerPanel(t.userData); return; }
    }

    // Check moons
    const moonHits = raycaster.intersectObjects(moons);
    if (moonHits.length > 0) { showMoonPanel(moonHits[0].object.userData); return; }

    // Check realm zones
    const realmHits = raycaster.intersectObjects(realmMeshes);
    if (realmHits.length > 0) {
        const name = realmHits[0].object.userData.name;
        const r = realms[name];
        flyTo(r.x, getHeight(r.x, r.z)+80, r.z, name);
        return;
    }

    // Check terrain click → find nearest realm
    const terrainHit = raycaster.intersectObject(terrain);
    if (terrainHit.length > 0) {
        const pt = terrainHit[0].point;
        let closest = null, closestDist = Infinity;
        for (const name of displayRealms) {
            const r = realms[name];
            const d = Math.sqrt((pt.x-r.x)**2 + (pt.z-r.z)**2);
            if (d < closestDist && d < 200) { closestDist = d; closest = name; }
        }
        if (closest) {
            const r = realms[closest];
            flyTo(r.x, getHeight(r.x,r.z)+80, r.z, closest);
        }
    }
}

renderer.domElement.addEventListener('click', onClick);

let touchStartPos = null;
let touchStartTime = 0;
renderer.domElement.addEventListener('touchstart', (e) => {
    if (e.touches.length === 1) {
        touchStartPos = { x: e.touches[0].clientX, y: e.touches[0].clientY };
        touchStartTime = Date.now();
    } else {
        touchStartPos = null;
    }
}, { passive: true });

renderer.domElement.addEventListener('touchend', (e) => {
    if (touchStartPos && e.changedTouches.length === 1) {
        const touch = e.changedTouches[0];
        const dx = touch.clientX - touchStartPos.x;
        const dy = touch.clientY - touchStartPos.y;
        const dist = Math.sqrt(dx*dx + dy*dy);
        const elapsed = Date.now() - touchStartTime;
        // Only fire click if finger barely moved and tap was quick
        if (dist < 25 && elapsed < 400) {
            onClick({ clientX: touch.clientX, clientY: touch.clientY });
        }
    }
    touchStartPos = null;
}, { passive: true });

// Zoom buttons
document.getElementById('zoomIn').addEventListener('click', (e) => { e.stopPropagation(); controls.dollyIn(1.3); controls.update(); });
document.getElementById('zoomOut').addEventListener('click', (e) => { e.stopPropagation(); controls.dollyOut(1.3); controls.update(); });

// ── Animation Loop ──
function updateParticles(delta) {
    for (const sys of particleSystems) {
        const pos = sys.pts.geometry.attributes.position;
        const ud = sys.pts.userData;
        const arr = pos.array;
        for (let i=0; i<pos.count; i++) {
            const i3 = i*3;
            if (sys.wander) {
                arr[i3] += (Math.random()-0.5)*0.4;
                arr[i3+1] += (Math.random()-0.5)*0.3;
                arr[i3+2] += (Math.random()-0.5)*0.4;
                // Blink effect via opacity handled by material
            } else {
                arr[i3] += sys.dir.x + ud.vel[i3]*0.1;
                arr[i3+1] += sys.dir.y * delta * 30;
                arr[i3+2] += sys.dir.z + ud.vel[i3+2]*0.1;
            }
            // Bounds check
            const dx = arr[i3] - ud.regionX, dz = arr[i3+2] - ud.regionZ;
            if (Math.abs(dx) > ud.spread/2 || Math.abs(dz) > ud.spread/2 ||
                (ud.yRange && (arr[i3+1] < ud.yRange[0]-5 || arr[i3+1] > ud.yRange[1]+10))) {
                arr[i3] = ud.regionX + (Math.random()-0.5)*ud.spread;
                arr[i3+2] = ud.regionZ + (Math.random()-0.5)*ud.spread;
                if (ud.yRange) arr[i3+1] = ud.yRange[0] + Math.random()*(ud.yRange[1]-ud.yRange[0]);
            }
        }
        pos.needsUpdate = true;
    }
}

function updateLoyaltyDots(time) {
    const posArr = dots.geometry.attributes.position.array;
    for (let i=0;i<dotCount;i++) {
        dotProgress[i] += 0.003;
        if (dotProgress[i] > 1) dotProgress[i] = 0;
        const path = loyaltyPaths[dotPathIdx[i] % loyaltyPaths.length];
        const t = dotProgress[i];
        // Quadratic bezier through center
        const mt = 1-t;
        const x = mt*mt*path.from.x + 2*mt*t*path.mid.x + t*t*path.to.x;
        const y = mt*mt*path.from.y + 2*mt*t*path.mid.y + t*t*path.to.y;
        const z = mt*mt*path.from.z + 2*mt*t*path.mid.z + t*t*path.to.z;
        posArr[i*3] = x; posArr[i*3+1] = y; posArr[i*3+2] = z;
    }
    dots.geometry.attributes.position.needsUpdate = true;
}

function updateWater(time) {
    const pos = water.geometry.attributes.position;
    for (let i=0;i<pos.count;i++) {
        const x = pos.getX(i), z = pos.getZ(i);
        pos.setY(i, -8 + Math.sin(x*0.01 + time*0.8)*1.5 + Math.cos(z*0.012 + time*0.6)*1.2);
    }
    pos.needsUpdate = true;
}

// Moon orbit + phase cycling
function updateMoons(time) {
    for (let i = 0; i < moons.length; i++) {
        const moon = moons[i];
        const ud = moon.userData;

        // Individual orbital motion (each moon orbits at its own speed)
        const orbitAngle = (i / 7) * Math.PI * 2 + time * ud.orbitSpeed;
        moon.position.x = Math.cos(orbitAngle) * ud.orbitRadius;
        moon.position.y = ud.baseY + Math.sin(orbitAngle * 0.7) * 30;
        moon.position.z = Math.sin(orbitAngle) * ud.orbitRadius * 0.5 - 200;

        // Update corresponding light
        if (moonLights[i]) moonLights[i].position.copy(moon.position);

        // Phase cycle: shadow hemisphere rotates to show phase
        // Full cycle = shadow rotates 360 degrees over the cycle period
        const phase = (time * ud.phaseSpeed + ud.phaseOffset) % (Math.PI * 2);
        if (ud.shadow) {
            ud.shadow.rotation.y = phase;
        }

        // Calculate phase percentage (0 = new moon, 0.5 = full moon, 1 = new again)
        const phasePct = (Math.sin(phase) + 1) / 2; // 0 to 1, where 1 = full

        // Emissive intensity pulses with phase (brighter at full)
        if (ud.moonMat) {
            ud.moonMat.emissiveIntensity = 0.3 + phasePct * 1.2;
        }

        // Glow ring intensity follows phase
        if (ud.glowMat) {
            ud.glowMat.opacity = 0.03 + phasePct * 0.25;
        }

        // Point light intensity follows phase
        if (moonLights[i]) {
            moonLights[i].intensity = 0.05 + phasePct * 0.5;
        }

        // Glow ring always faces camera
        if (ud.glow) {
            ud.glow.lookAt(camera.position);
        }
    }
}

// Firefly blink
let fireflyTime = 0;
function updateFireflyBlink(time) {
    fireflies.material.opacity = 0.4 + Math.sin(time*3)*0.3 + Math.sin(time*7.3)*0.15;
}

// ── Post-Processing (Bloom) ──
const composer = new EffectComposer(renderer);
const renderPass = new RenderPass(scene, camera);
composer.addPass(renderPass);
const bloomPass = new UnrealBloomPass(
    new THREE.Vector2(window.innerWidth, window.innerHeight),
    0.4,   // strength
    0.6,   // radius
    0.85   // threshold
);
composer.addPass(bloomPass);

setProgress(100);
setTimeout(() => document.getElementById('loading').classList.add('done'), 500);
setTimeout(() => { const hint = document.getElementById('hint'); if(hint) setTimeout(()=>hint.classList.add('hidden'), 5000); }, 2000);

// ── Billboard Update for Dog PFP Planes ──
function updateBillboards() {
    for (const g of dogGroups) {
        g.traverse(child => {
            if (child.isMesh && child.userData.isBillboard) {
                const worldPos = new THREE.Vector3();
                child.getWorldPosition(worldPos);
                child.lookAt(camera.position);
            }
        });
    }
}

function animate() {
    requestAnimationFrame(animate);
    const delta = clock.getDelta();
    const time = clock.getElapsedTime();

    controls.update();
    updateParticles(delta);
    updateMoons(time);
    updateLoyaltyLines();
    updateLoyaltyDots(time);
    updateFireflyBlink(time);

    // Only update water every few frames for performance
    if (Math.floor(time*30) % 2 === 0) updateWater(time);

    // Update dogs
    updateDogs(time);

    // Billboard PFP planes to face camera
    updateBillboards();

    // Castle flag wave animation
    for (const flag of castleFlags) {
        const pos = flag.geometry.attributes.position;
        const origPos = flag.geometry.userData.origPos || pos.array.slice();
        if (!flag.geometry.userData.origPos) flag.geometry.userData.origPos = origPos;
        for (let v = 0; v < pos.count; v++) {
            const x = origPos[v * 3];
            pos.array[v * 3 + 1] = origPos[v * 3 + 1] + Math.sin(time * 3 + x * 2) * 0.2;
        }
        pos.needsUpdate = true;
    }

    // Distance-based label fading
    if (Math.floor(time*10) % 3 === 0) updateLabelFade();

    // Tower orb pulse
    for (const t of towers) {
        const orb = t.children[2];
        if (orb) orb.material.emissiveIntensity = 1.2 + Math.sin(time*2 + t.position.x)*0.5;
    }

    composer.render();
}
animate();

// Resize
window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
    composer.setSize(window.innerWidth, window.innerHeight);
});

</script>
</body>
</html>
