<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Generator â€” Create Custom Wizard Dog Art | The Order of 86</title>
    <meta name="description" content="Create custom wizard dog art and content with the Order of 86 content generator. Mix and match traits from 86 unique Doginal wizard dogs.">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://theorderof86.com/content">
    <meta property="og:title" content="Content Generator â€” Create Custom Wizard Dog Art | The Order of 86">
    <meta property="og:description" content="Create custom wizard dog art with the Order of 86 content generator. Mix and match traits from 86 unique wizard dogs.">
    <meta property="og:image" content="https://theorderof86.com/og-image.jpg">
    <meta property="og:url" content="https://theorderof86.com/content">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="The Order of 86">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Content Generator â€” Create Custom Wizard Dog Art | The Order of 86">
    <meta name="twitter:description" content="Create custom wizard dog art with the Order of 86 content generator. Mix and match traits from 86 unique wizard dogs.">
    <meta name="twitter:image" content="https://theorderof86.com/og-image.jpg">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect fill='%231C1C1E' width='32' height='32' rx='6'/><text x='16' y='23' font-size='18' font-weight='bold' text-anchor='middle' fill='%23ffd700'>86</text></svg>">
    <style>
        *,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
        body{background:#0a0a0a;color:#F5F5F7;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;min-height:100vh;overflow-x:hidden}

        /* Navigation */
        .nav-close-mobile{background:none;border:none;color:#ffd700;font-size:2rem;cursor:pointer;align-self:flex-end}
        @media(max-width:768px){.nav-bar a:not(.nav-logo-mobile){display:none}.nav-logo-mobile,}

        /* Layout */
        .main-container{display:flex;max-width:1400px;margin:0 auto;padding:2rem;gap:2rem;min-height:calc(100vh - 80px)}
        .preview-section{flex:1;min-width:400px}
        .controls-section{flex:1;min-width:450px;max-width:600px}

        @media(max-width:1024px){
            .main-container{flex-direction:column;padding:1rem}
            .preview-section,.controls-section{min-width:auto;max-width:none}
        }

        /* Header */
        .header{text-align:center;margin-bottom:2rem}
        .header h1{font-size:2.5rem;color:#ffd700;margin-bottom:0.5rem;text-shadow:0 2px 8px rgba(255,215,0,0.3)}
        .header h2{font-size:1.1rem;color:#98989D;font-weight:400}

        /* Preview */
        .preview-container{position:sticky;top:120px}
        .preview-frame{position:relative;width:100%;max-width:500px;aspect-ratio:1;margin:0 auto;border-radius:20px;border:3px solid rgba(255,215,0,0.2);background:linear-gradient(45deg,#1a1a1c,#2a2a2e);box-shadow:0 20px 60px rgba(0,0,0,0.8),0 0 30px rgba(255,215,0,0.1);overflow:hidden;transition:border-color 0.3s}
        .preview-frame:hover{border-color:rgba(255,215,0,0.4)}
        .preview-frame .bg-layer{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;transition:opacity 0.3s}
        .preview-frame .dog-layer{position:absolute;inset:0;width:100%;height:100%;object-fit:contain;z-index:1;transition:transform 0.3s}
        .preview-loading{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.7);z-index:10;transition:opacity 0.3s}
        .preview-loading.hidden{opacity:0;pointer-events:none}
        .magic-ball-wrap{position:relative;width:80px;height:110px;display:flex;flex-direction:column;align-items:center;justify-content:center}
        .ball-stand{width:40px;height:14px;margin-top:-5px;background:radial-gradient(ellipse at center,#c9a84c 0%,#8a6a2a 50%,#5a4010 100%);border-radius:50%;box-shadow:0 2px 6px rgba(0,0,0,0.5)}
        .ball-stand::before{content:'';display:block;width:24px;height:8px;margin:0 auto;background:radial-gradient(ellipse at center,#d4b45c 0%,#9a7a3a 100%);border-radius:50%;transform:translateY(-3px)}
        .ball-stand::after{content:'';display:block;width:50px;height:6px;margin:-2px auto 0;background:radial-gradient(ellipse at center,#b8942c 0%,#6a4a15 100%);border-radius:50%}
        .magic-ball{position:relative;z-index:2;width:60px;height:60px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#c8a0ff 0%,#7b54c9 30%,#4a2a8a 60%,#1a0a3a 100%);box-shadow:0 0 30px rgba(123,84,201,0.6),0 0 60px rgba(123,84,201,0.3),inset 0 -8px 15px rgba(0,0,0,0.4),inset 0 5px 10px rgba(255,255,255,0.15);animation:ballFloat 2s ease-in-out infinite}
        .magic-ball::before{content:'';position:absolute;top:10px;left:18px;width:18px;height:12px;border-radius:50%;background:radial-gradient(ellipse,rgba(255,255,255,0.5),transparent);transform:rotate(-15deg)}
        .magic-ball::after{content:'';position:absolute;inset:-4px;border-radius:50%;background:transparent;border:2px solid transparent;border-top-color:rgba(200,160,255,0.4);animation:ballRing 3s linear infinite}
        .sparkle{position:absolute;width:4px;height:4px;border-radius:50%;pointer-events:none}
        .sparkle:nth-child(1){background:#ffd700;top:5px;left:10px;animation:sparkleFloat 1.5s ease-in-out infinite 0s}
        .sparkle:nth-child(2){background:#ff88ff;top:60px;right:5px;animation:sparkleFloat 1.8s ease-in-out infinite 0.3s}
        .sparkle:nth-child(3){background:#88ddff;bottom:5px;left:30px;animation:sparkleFloat 1.3s ease-in-out infinite 0.6s}
        .sparkle:nth-child(4){background:#ffaa44;top:20px;right:10px;animation:sparkleFloat 2s ease-in-out infinite 0.9s}
        .sparkle:nth-child(5){background:#44ffaa;bottom:15px;right:25px;animation:sparkleFloat 1.6s ease-in-out infinite 1.2s}
        .sparkle:nth-child(6){background:#ffffff;top:35px;left:2px;animation:sparkleFloat 1.4s ease-in-out infinite 0.4s}
        @keyframes ballFloat{0%,100%{transform:translateY(0) scale(1)}50%{transform:translateY(-6px) scale(1.03)}}
        @keyframes ballRing{0%{transform:rotateX(70deg) rotateZ(0deg)}100%{transform:rotateX(70deg) rotateZ(360deg)}}
        @keyframes sparkleFloat{0%{opacity:0;transform:scale(0) translateY(0)}25%{opacity:1;transform:scale(1.2) translateY(-8px)}50%{opacity:0.6;transform:scale(0.8) translateY(-15px)}75%{opacity:1;transform:scale(1) translateY(-5px)}100%{opacity:0;transform:scale(0) translateY(0)}}
        @keyframes spin{to{transform:rotate(360deg)}}

        /* Selection Info */
        .selection-info{text-align:center;margin:1.5rem 0;padding:1rem;background:rgba(255,215,0,0.05);border-radius:12px;border:1px solid rgba(255,215,0,0.1)}
        .wizard-name{font-size:1.3rem;color:#ffd700;font-weight:600;margin-bottom:0.5rem}
        .wizard-count{font-size:0.9rem;color:#98989D}
        .randomize-btn{margin-top:1rem;padding:0.6rem 2rem;background:linear-gradient(135deg,#4a4a4e,#6a6a6e);color:#F5F5F7;border:none;border-radius:10px;cursor:pointer;font-weight:600;transition:all 0.2s}
        .randomize-btn:hover{transform:translateY(-2px);background:linear-gradient(135deg,#5a5a5e,#7a7a7e);box-shadow:0 8px 25px rgba(0,0,0,0.3)}

        /* Download Buttons */
        .download-section{margin-top:1.5rem}
        .download-buttons{display:flex;gap:0.8rem;flex-wrap:wrap;justify-content:center}
        .download-btn{padding:0.8rem 2rem;background:linear-gradient(135deg,#ffd700,#e6a800);color:#000;font-size:0.95rem;font-weight:700;border:none;border-radius:12px;cursor:pointer;transition:all 0.2s;text-transform:uppercase;letter-spacing:0.03em;min-width:160px}
        .download-btn:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(255,215,0,0.4)}
        .download-btn:disabled{opacity:0.5;cursor:not-allowed;transform:none}
        .download-btn.secondary{background:linear-gradient(135deg,#4a4a4e,#6a6a6e);color:#F5F5F7}
        .download-btn.secondary:hover{background:linear-gradient(135deg,#5a5a5e,#7a7a7e)}

        /* Controls Panel */
        .controls-panel{background:linear-gradient(145deg,#1a1a1c,#2a2a2e);border-radius:20px;border:1px solid rgba(255,215,0,0.1);overflow:hidden;box-shadow:0 10px 40px rgba(0,0,0,0.6)}

        /* Tabs */
        .tabs-header{display:flex;border-bottom:1px solid rgba(255,215,0,0.1)}
        .tab-btn{flex:1;padding:1rem;background:none;border:none;color:#98989D;font-size:0.9rem;font-weight:600;cursor:pointer;transition:all 0.2s;text-transform:uppercase;letter-spacing:0.05em;border-bottom:3px solid transparent}
        .tab-btn:hover{color:#F5F5F7;background:rgba(255,215,0,0.05)}
        .tab-btn.active{color:#ffd700;background:rgba(255,215,0,0.1);border-bottom-color:#ffd700}

        .tab-content{height:500px;overflow-y:auto;padding:1.5rem}
        .tab-content::-webkit-scrollbar{width:6px}
        .tab-content::-webkit-scrollbar-track{background:rgba(255,215,0,0.05)}
        .tab-content::-webkit-scrollbar-thumb{background:rgba(255,215,0,0.2);border-radius:3px}
        .tab-content::-webkit-scrollbar-thumb:hover{background:rgba(255,215,0,0.4)}

        .tab-panel{display:none;animation:fadeIn 0.3s ease-in-out}
        .tab-panel.active{display:block}
        @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}

        /* Search & Filters */
        .controls-row{display:flex;gap:0.8rem;margin-bottom:1.5rem;flex-wrap:wrap}
        .search-input{flex:1;min-width:200px;padding:0.8rem 1rem;background:rgba(255,215,0,0.05);border:2px solid rgba(255,215,0,0.1);border-radius:10px;color:#F5F5F7;font-size:0.9rem;outline:none;transition:all 0.2s}
        .search-input:focus{border-color:#ffd700;box-shadow:0 0 15px rgba(255,215,0,0.2)}
        .search-input::placeholder{color:#666}
        .filter-select{padding:0.8rem;background:rgba(255,215,0,0.05);border:2px solid rgba(255,215,0,0.1);border-radius:10px;color:#F5F5F7;cursor:pointer;transition:all 0.2s}
        .filter-select:focus{border-color:#ffd700}

        /* Grids */
        .grid{display:grid;gap:12px;animation:slideUp 0.4s ease-out}
        @keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}

        .wizards-grid{grid-template-columns:repeat(auto-fill,minmax(70px,1fr))}
        .backgrounds-grid{grid-template-columns:repeat(auto-fill,minmax(120px,1fr))}

        /* Wizard Thumbs */
        .wizard-thumb{position:relative;width:100%;aspect-ratio:1;border-radius:12px;cursor:pointer;border:3px solid transparent;transition:all 0.3s;overflow:hidden;background:#2a2a2e;transform-origin:center}
        .wizard-thumb img{width:100%;height:100%;object-fit:cover;transition:transform 0.3s}
        .wizard-thumb:hover{border-color:rgba(255,215,0,0.5);transform:scale(1.08);box-shadow:0 8px 25px rgba(0,0,0,0.4)}
        .wizard-thumb:hover img{transform:scale(1.1)}
        .wizard-thumb.selected{border-color:#ffd700;background:rgba(255,215,0,0.1);box-shadow:0 0 20px rgba(255,215,0,0.6);transform:scale(1.05)}
        .wizard-id{position:absolute;top:4px;left:4px;background:rgba(0,0,0,0.8);color:#ffd700;font-size:0.7rem;font-weight:600;padding:2px 6px;border-radius:4px}

        /* Background Thumbs */
        .bg-thumb{position:relative;width:100%;aspect-ratio:1;border-radius:12px;cursor:pointer;border:3px solid transparent;transition:all 0.3s;overflow:hidden;transform-origin:center}
        .bg-thumb img{width:100%;height:100%;object-fit:cover;transition:transform 0.3s}
        .bg-thumb:hover{border-color:rgba(255,215,0,0.5);transform:scale(1.05);box-shadow:0 8px 25px rgba(0,0,0,0.4)}
        .bg-thumb:hover img{transform:scale(1.1)}
        .bg-thumb.selected{border-color:#ffd700;box-shadow:0 0 20px rgba(255,215,0,0.6);transform:scale(1.02)}
        .bg-thumb.none-bg{display:flex;align-items:center;justify-content:center;background:linear-gradient(45deg,#2a2a2e,#3a3a3e);color:#98989D;font-size:0.8rem;font-weight:600}
        .bg-thumb.none-bg:hover{background:linear-gradient(45deg,#3a3a3e,#4a4a4e);color:#F5F5F7}
        .bg-label{position:absolute;bottom:0;left:0;right:0;padding:6px;background:linear-gradient(transparent,rgba(0,0,0,0.9));color:#F5F5F7;font-size:0.7rem;font-weight:600;text-align:center}
        .bg-type-badge{position:absolute;top:6px;right:6px;background:#ffd700;color:#000;font-size:0.6rem;font-weight:700;padding:2px 6px;border-radius:6px;text-transform:uppercase}

        /* Settings */
        .setting-group{margin-bottom:2rem;padding:1.5rem;background:rgba(255,215,0,0.03);border-radius:12px;border:1px solid rgba(255,215,0,0.1)}
        .setting-label{display:block;color:#ffd700;font-size:0.9rem;font-weight:600;margin-bottom:0.8rem;text-transform:uppercase;letter-spacing:0.05em}
        .setting-row{display:flex;gap:1rem;align-items:center;margin-bottom:1rem}
        .setting-input{flex:1;padding:0.6rem;background:rgba(255,215,0,0.05);border:2px solid rgba(255,215,0,0.1);border-radius:8px;color:#F5F5F7;outline:none;transition:border-color 0.2s}
        .setting-input:focus{border-color:#ffd700}
        .setting-value{min-width:60px;color:#98989D;font-size:0.9rem;text-align:right}

        /* Empty States */
        .empty-state{text-align:center;padding:3rem 1rem;color:#666}
        .empty-state h3{color:#98989D;margin-bottom:0.5rem}

        /* Hidden canvas */
        #previewCanvas{display:none}

        /* Mobile responsiveness */
        @media(max-width:768px){
            .main-container{padding:1rem 0.5rem}
            .tabs-header{flex-wrap:wrap}
            .tab-btn{min-width:25%;font-size:0.8rem;padding:0.8rem 0.5rem}
            .controls-row{flex-direction:column}
            .download-buttons{flex-direction:column}
            .setting-row{flex-direction:column;align-items:stretch;gap:0.5rem}
            .setting-value{text-align:left}
        }
    
/* â”€â”€ Modern Glassmorphism Nav â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.nav-bar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 clamp(16px, 3vw, 48px);
    padding-top: env(safe-area-inset-top);
    height: 64px;
    background: rgba(10, 10, 12, 0.55);
    backdrop-filter: saturate(180%) blur(24px);
    -webkit-backdrop-filter: saturate(180%) blur(24px);
    border-bottom: 1px solid rgba(255, 215, 0, 0.08);
    box-shadow: 0 1px 12px rgba(255, 215, 0, 0.03);
    transition: background 0.4s ease, border-color 0.4s ease, box-shadow 0.4s ease;
}
.nav-bar.scrolled {
    background: rgba(10, 10, 12, 0.92);
    border-bottom-color: rgba(255, 215, 0, 0.15);
    box-shadow: 0 2px 20px rgba(255, 215, 0, 0.06);
}
.nav-logo {
    font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    font-size: 20px;
    font-weight: 700;
    color: #ffd700;
    text-decoration: none;
    letter-spacing: 0.5px;
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.3), 0 0 40px rgba(255, 215, 0, 0.1);
    transition: text-shadow 0.3s ease;
    white-space: nowrap;
    flex-shrink: 0;
}
.nav-logo:hover {
    text-shadow: 0 0 24px rgba(255, 215, 0, 0.5), 0 0 48px rgba(255, 215, 0, 0.2);
}
.nav-links {
    display: flex;
    align-items: center;
    gap: 4px;
}
.nav-links a {
    position: relative;
    color: rgba(245, 245, 247, 0.55);
    text-decoration: none;
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    padding: 8px 16px;
    transition: color 0.3s ease;
    -webkit-tap-highlight-color: transparent;
}
.nav-links a::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 16px;
    right: 16px;
    height: 2px;
    background: #ffd700;
    border-radius: 1px;
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 0 6px rgba(255, 215, 0, 0.4);
}
.nav-links a:hover {
    color: rgba(245, 245, 247, 0.9);
}
.nav-links a:hover::after {
    transform: scaleX(1);
}
.nav-links a.active {
    color: #ffd700;
}
.nav-links a.active::after {
    transform: scaleX(1);
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
}

/* â”€â”€ Hamburger â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.nav-hamburger {
    display: none;
    width: 44px;
    height: 44px;
    align-items: center;
    justify-content: center;
    background: none;
    border: none;
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
    padding: 0;
    flex-shrink: 0;
}
.nav-hamburger-lines {
    width: 22px;
    height: 16px;
    position: relative;
}
.nav-hamburger-lines span {
    display: block;
    position: absolute;
    width: 100%;
    height: 2px;
    background: #F5F5F7;
    border-radius: 1px;
    transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
}
.nav-hamburger-lines span:nth-child(1) { top: 0; }
.nav-hamburger-lines span:nth-child(2) { top: 7px; }
.nav-hamburger-lines span:nth-child(3) { top: 14px; }
.nav-hamburger.is-open .nav-hamburger-lines span:nth-child(1) {
    top: 7px; transform: rotate(45deg);
}
.nav-hamburger.is-open .nav-hamburger-lines span:nth-child(2) {
    opacity: 0; transform: scaleX(0);
}
.nav-hamburger.is-open .nav-hamburger-lines span:nth-child(3) {
    top: 7px; transform: rotate(-45deg);
}

/* â”€â”€ Mobile Menu â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.nav-mobile-overlay {
    position: fixed;
    top: 64px;
    left: 0;
    right: 0;
    z-index: 99;
    background: rgba(10, 10, 12, 0.85);
    backdrop-filter: blur(40px) saturate(180%);
    -webkit-backdrop-filter: blur(40px) saturate(180%);
    border-bottom: 1px solid rgba(255, 215, 0, 0.1);
    padding: 8px 0 16px;
    display: flex;
    flex-direction: column;
    transform: translateY(-110%);
    opacity: 0;
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s ease;
    pointer-events: none;
}
.nav-mobile-overlay.open {
    transform: translateY(0);
    opacity: 1;
    pointer-events: auto;
}
.nav-mobile-overlay a {
    color: rgba(245, 245, 247, 0.6);
    text-decoration: none;
    font-size: 15px;
    font-weight: 600;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    padding: 14px 32px;
    transition: color 0.2s ease, background 0.2s ease;
    -webkit-tap-highlight-color: transparent;
}
.nav-mobile-overlay a:hover,
.nav-mobile-overlay a:active {
    color: #F5F5F7;
    background: rgba(255, 255, 255, 0.04);
}
.nav-mobile-overlay a.active {
    color: #ffd700;
}

/* â”€â”€ Mobile Responsive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@media (max-width: 768px) {
    .nav-links { display: none; }
    .nav-hamburger { display: flex; }
}

/* â”€â”€ Nav Spacer (push content below fixed nav) â”€â”€â”€â”€â”€â”€â”€â”€ */
.nav-spacer { height: 64px; padding-top: env(safe-area-inset-top); }

    </style>
</head>
<body>
<nav class="nav-bar" id="mainNav">
    <a href="index.html" class="nav-logo">The Order of 86</a>
    <div class="nav-links">
        <a href="index.html">Wizards</a>
        <a href="moons.html">Moons</a>
        <a href="map.html">Map</a>
        <a href="lore.html">Lore</a>
        <a href="content.html" class="active">Content</a>
    </div>
    <button class="nav-hamburger" id="navHamburger" aria-label="Menu">
        <div class="nav-hamburger-lines"><span></span><span></span><span></span></div>
    </button>
</nav>
<div class="nav-mobile-overlay" id="navMobileMenu">
    <a href="index.html">Wizards</a>
    <a href="moons.html">Moons</a>
    <a href="map.html">Map</a>
    <a href="lore.html">Lore</a>
    <a href="content.html" class="active">Content</a>
</div>
<div class="nav-spacer"></div>

<div class="header">
    <h1>Content Generator</h1>
    <h2>Mix, match, and create magical content with the 86 Wizards</h2>
</div>

<div class="main-container">
    <!-- Preview Section -->
    <div class="preview-section">
        <div class="preview-container">
            <div class="preview-frame" id="previewFrame">
                <div class="preview-loading" id="previewLoading">
                    <div class="magic-ball-wrap">
                        <div class="sparkle"></div>
                        <div class="sparkle"></div>
                        <div class="sparkle"></div>
                        <div class="sparkle"></div>
                        <div class="sparkle"></div>
                        <div class="sparkle"></div>
                        <div class="magic-ball"></div>
                        <div class="ball-stand"></div>
                    </div>
                </div>
                <img class="bg-layer" id="bgLayer" src="" style="display:none">
                <img class="dog-layer" id="dogLayer" src="" style="display:none">
            </div>
            
            <div class="selection-info">
                <div class="wizard-name" id="selectedName">Select a wizard to begin</div>
                <div class="wizard-count" id="wizardCount">86 Wizards available</div>
                <button class="randomize-btn" onclick="randomizeSelection()">ðŸŽ² Surprise Me!</button>
            </div>

            <div class="download-section">
                <div class="download-buttons">
                    <button class="download-btn" id="downloadStill" onclick="downloadStill()" disabled>Download Still (PNG)</button>
                    <button class="download-btn secondary" id="downloadBg" onclick="downloadBackground()" disabled style="display:none">Download GIF (with Wizard)</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Controls Section -->
    <div class="controls-section">
        <div class="controls-panel">
            <div class="tabs-header">
                <button class="tab-btn active" onclick="switchTab('wizards')">Wizards</button>
                <button class="tab-btn" onclick="switchTab('animated')">Animated BGs</button>
                <button class="tab-btn" onclick="switchTab('still')">Still BGs</button>
                <button class="tab-btn" onclick="switchTab('settings')">Settings</button>
            </div>

            <!-- Wizards Tab -->
            <div class="tab-content">
                <div class="tab-panel active" id="wizardsTab">
                    <div class="controls-row">
                        <input type="text" class="search-input" id="wizardSearch" placeholder="Search wizards by name or ID...">
                        <select class="filter-select" id="orderFilter" onchange="filterWizards()">
                            <option value="">All Orders</option>
                            <option value="Flame">Flame</option><option value="Wild">Wild</option><option value="Arcane">Arcane</option>
                            <option value="Deep">Deep</option><option value="Radiant">Radiant</option><option value="Heart">Heart</option><option value="Wanderer">Wanderer</option><option value="Starter">Starter Dog</option>
                        </select>
                    </div>
                    <div class="grid wizards-grid" id="wizardsGrid"></div>
                </div>

                <!-- Animated Backgrounds Tab -->
                <div class="tab-panel" id="animatedTab">
                    <div class="grid backgrounds-grid" id="animatedBgGrid"></div>
                </div>

                <!-- Still Backgrounds Tab -->
                <div class="tab-panel" id="stillTab">
                    <div class="grid backgrounds-grid" id="stillBgGrid"></div>
                </div>

                <!-- Settings Tab -->
                <div class="tab-panel" id="settingsTab">
                    <div class="setting-group">
                        <label class="setting-label">Wizard Scale</label>
                        <div class="setting-row">
                            <input type="range" class="setting-input" id="dogScale" min="0.5" max="1.5" step="0.1" value="1" oninput="updatePreview()">
                            <span class="setting-value" id="dogScaleValue">100%</span>
                        </div>
                    </div>
                    
                    <div class="setting-group">
                        <label class="setting-label">Wizard Position</label>
                        <div class="setting-row">
                            <input type="range" class="setting-input" id="dogOffsetX" min="-200" max="200" step="5" value="0" oninput="updatePreview()">
                            <span class="setting-value" id="dogOffsetXValue">0px</span>
                        </div>
                        <div class="setting-row">
                            <input type="range" class="setting-input" id="dogOffsetY" min="-200" max="200" step="5" value="0" oninput="updatePreview()">
                            <span class="setting-value" id="dogOffsetYValue">0px</span>
                        </div>
                    </div>
                    
                    <div class="setting-group">
                        <label class="setting-label">Wizard Rotation</label>
                        <div class="setting-row">
                            <input type="range" class="setting-input" id="dogRotation" min="-180" max="180" step="5" value="0" oninput="updatePreview()">
                            <span class="setting-value" id="dogRotationValue">0Â°</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<canvas id="previewCanvas" width="1000" height="1000"></canvas>

<script>
const WIZARDS = [
  {id:'165',name:'Vanguard the Glacier Walker',order:'Flame'},{id:'246',name:'Goldburn the Solar Flame',order:'Flame'},
  {id:'986',name:'Splitforge the Dual Natured',order:'Flame'},{id:'1053',name:'Deathforge the Undying',order:'Flame'},
  {id:'1271',name:'Snowcollie the Patient Amplifier',order:'Heart'},{id:'1714',name:'Roseheart the Gentle Flame',order:'Flame'},
  {id:'1841',name:'Ember Beard the Bridge Prophet',order:'Deep'},{id:'1848',name:'Lensfire the Tiger Scholar',order:'Flame'},
  {id:'1976',name:'Frostbark the Ice Grower',order:'Wild'},{id:'1977',name:'Blackclassic the Network Walker',order:'Wild'},
  {id:'2426',name:'Blotbark the Corruption Fighter',order:'Wild'},{id:'2634',name:'Mixedsight the Paradox Prophet',order:'Deep'},
  {id:'2807',name:'Voidbloom the Visor Wearer',order:'Wild'},{id:'2855',name:'Lensheart the Scholarly Amplifier',order:'Heart'},
  {id:'3030',name:'Pureflame the Unadorned',order:'Flame'},{id:'3186',name:'Brownheart the Common Light',order:'Radiant'},
  {id:'3406',name:'Pinkmantle the Dimensional Scholar',order:'Arcane'},{id:'3417',name:'Orangeshield the Flame Prophet',order:'Deep'},
  {id:'3449',name:'Stripeheart the Bridge Walker',order:'Wild'},{id:'3479',name:'Dawnheart the Neutral Amplifier',order:'Heart'},
  {id:'3557',name:'Goldstare the Solar Prophet',order:'Deep'},{id:'3735',name:'Roseheart the Steady Bond',order:'Heart'},
  {id:'3758',name:'Deathbloom the Renewal Bringer',order:'Wild'},{id:'3826',name:'Rosefield the Wild Ember',order:'Wild'},
  {id:'4042',name:'Roseflame the Pink Eyed',order:'Flame'},{id:'4165',name:'Pearlgaze the Emotional Seer',order:'Deep'},
  {id:'4458',name:'Clearsight the Precision Revealer',order:'Radiant'},{id:'4540',name:'Blotforge the Chaos Shaper',order:'Flame'},
  {id:'4650',name:'Sandstone the Stable Amplifier',order:'Arcane'},{id:'4742',name:'Blottedmist the Chaos Seer',order:'Deep'},
  {id:'4994',name:'Whitecoat the Collie Coordinator',order:'Arcane'},{id:'5035',name:'Blizzardflame the Ice Hearted',order:'Flame'},
  {id:'5056',name:'Brownvisor the Research Director',order:'Arcane'},{id:'5177',name:'Frostgrow the Gray Endurer',order:'Wild'},
  {id:'5240',name:'Graysleep the Dream Walker',order:'Arcane'},{id:'5275',name:'Tideforge the Current Rider',order:'Flame'},
  {id:'5374',name:'Redsight the Spotted Tracker',order:'Wild'},{id:'5381',name:'Roseclassic the Pink Diplomat',order:'Radiant'},
  {id:'5516',name:'Whiteguard the Shield Prophet',order:'Deep'},{id:'5518',name:'Voidstrike the Green Eyed',order:'Flame'},
  {id:'5538',name:'Graystorm the Weather Walker',order:'Wild'},{id:'6095',name:'Dalmatianscript the Unique Scholar',order:'Arcane'},
  {id:'6135',name:'Bluevisor the Technology Prophet',order:'Deep'},{id:'6164',name:'The Wanderer',order:'Wanderer'},
  {id:'6198',name:'Ashstripe the Veil Ripper',order:'Arcane'},{id:'6203',name:'Sleepytan the Dream Revealer',order:'Radiant'},
  {id:'6232',name:'Goldsolid the Pure Prophet',order:'Deep'},{id:'6398',name:'Tideseed the Shore Walker',order:'Wild'},
  {id:'6502',name:'Sleepyheart the Dream Bonder',order:'Arcane'},{id:'6597',name:'Inkwell the Archive Prophet',order:'Deep'},
  {id:'6873',name:'Goldleaf the Multi Eyed',order:'Wild'},{id:'7226',name:'Tanwatcher the Patient Prophet',order:'Deep'},
  {id:'7257',name:'Graydreamer the Sleep Prophet',order:'Deep'},{id:'7439',name:'Goldsentry the Gentle Endurer',order:'Arcane'},
  {id:'7710',name:'Goldstrike the Lightning Fast',order:'Flame'},{id:'7731',name:'Beigelight the Steady Illuminator',order:'Radiant'},
  {id:'7770',name:'Stripesight the Pattern Burner',order:'Flame'},{id:'7833',name:'Bronzebeacon the Shiny Light',order:'Radiant'},
  {id:'8095',name:'Rosestrike the Pink Eyed',order:'Flame'},{id:'8154',name:'Grayveil the Foundation Scholar',order:'Arcane'},
  {id:'8272',name:'Spotforge the Pattern Reader',order:'Wild'},{id:'8284',name:'Stripesight the Pattern Hunter',order:'Wild'},
  {id:'8311',name:'Goldvisor the Tiger Theorist',order:'Heart'},{id:'8342',name:'Whiteheart the Split Researcher',order:'Heart'},
  {id:'8518',name:'Goldstripe the Time Stalker',order:'Heart'},{id:'8667',name:'Goldforge the Sun Touched',order:'Flame'},
  {id:'8728',name:'Frostforge the Scarf Bearer',order:'Flame'},{id:'8822',name:'Chaosbloom the Change Bringer',order:'Wild'},
  {id:'8965',name:'Brownthorn the Shield Grower',order:'Wild'},{id:'9017',name:'Sleepysteady the Gentle Dreamer',order:'Heart'},
  {id:'9025',name:'Grayheart the Split Revealer',order:'Radiant'},{id:'9089',name:'Raredheart the Ultimate Amplifier',order:'Heart'},
  {id:'9183',name:'Whiteheart the Pink Eyed Illuminator',order:'Radiant'},{id:'9234',name:'Shadowspot the Pattern Keeper',order:'Arcane'},
  {id:'9301',name:'Rosegold the Pink Eyed Theorist',order:'Heart'},{id:'9396',name:'Tancollar the Diplomatic Light',order:'Radiant'},
  {id:'9469',name:'Whitemist the Sleepy Purifier',order:'Radiant'},{id:'9530',name:'Bernardguard the Truth Keeper',order:'Deep'},
  {id:'9604',name:"Beigelumber the Worker's Light",order:'Radiant'},{id:'9624',name:'Inkspot the Silent Decoder',order:'Arcane'},
  {id:'9684',name:'Goldblot the Luminous Shadow',order:'Radiant'},{id:'9713',name:'Darkleaf the Shadow Grower',order:'Wild'},
  {id:'9758',name:'Commonflame the Everyman',order:'Flame'},{id:'9826',name:'Greenbone the Chaos Scholar',order:'Heart'},
  {id:'9898',name:'Verdant the Arcane Flame',order:'Arcane'},{id:'9952',name:'Grimbloom the Green Eyed',order:'Wild'},
  {id:'starter-1',name:'Starter Dog 1',order:'Starter'},{id:'starter-2',name:'Starter Dog 2',order:'Starter'},
  {id:'starter-3',name:'Starter Dog 3',order:'Starter'},{id:'starter-4',name:'Starter Dog 4',order:'Starter'},
  {id:'starter-5',name:'Starter Dog 5',order:'Starter'},{id:'starter-6',name:'Starter Dog 6',order:'Starter'},
  {id:'starter-7',name:'Starter Dog 7',order:'Starter'},{id:'starter-8',name:'Starter Dog 8',order:'Starter'}
];

const ANIMATED_BACKGROUNDS = [
  // Fire & Lava
  {file:'anim-emberhowl-eruption.gif',name:'Emberhowl Eruption'},
  {file:'anim-lava-river.gif',name:'Lava River'},
  {file:'anim-forge-flames.gif',name:'Forge Flames'},
  {file:'anim-magma-chamber.gif',name:'Magma Chamber'},
  {file:'anim-ember-storm.gif',name:'Ember Storm'},
  {file:'anim-volcanic-lightning.gif',name:'Volcanic Lightning'},
  {file:'anim-magma-forge.gif',name:'Magma Forge'},
  {file:'anim-lava-lake-crossing.gif',name:'Lava Lake Crossing'},
  // Water & Ice
  {file:'anim-deepwell-tides.gif',name:'Deepwell Tides'},
  {file:'anim-enchanted-waterfall.gif',name:'Enchanted Waterfall'},
  {file:'anim-tidal-cave.gif',name:'Tidal Cave'},
  {file:'anim-moonrise-lake.gif',name:'Moonrise Over Lake'},
  {file:'anim-snowfall-realm.gif',name:'Snowfall Realm'},
  {file:'anim-blizzard-siege.gif',name:'Blizzard Siege'},
  {file:'anim-ice-cavern-drip.gif',name:'Ice Cavern Drip'},
  {file:'anim-aurora-tundra.gif',name:'Aurora Tundra'},
  {file:'anim-frozen-waterfall.gif',name:'Frozen Waterfall'},
  {file:'anim-frozen-throne.gif',name:'Frozen Throne'},
  {file:'anim-storm-at-sea.gif',name:'Storm at Sea'},
  {file:'anim-enchanted-pond.gif',name:'Enchanted Pond'},
  // Nature
  {file:'anim-evergreen-rainfall.gif',name:'Evergreen Rainfall'},
  {file:'anim-firefly-forest.gif',name:'Firefly Forest'},
  {file:'anim-sacred-grove.gif',name:'Sacred Grove'},
  {file:'anim-cherry-blossom.gif',name:'Cherry Blossom Wind'},
  {file:'anim-fairy-ring.gif',name:'Fairy Ring'},
  {file:'anim-swamp-mist.gif',name:'Swamp Mist'},
  {file:'anim-haunted-swamp.gif',name:'Haunted Swamp'},
  {file:'anim-mushroom-rain.gif',name:'Mushroom Rain'},
  {file:'anim-spirit-forest.gif',name:'Spirit Forest'},
  {file:'anim-witchs-garden.gif',name:"Witch's Garden"},
  // Magic & Mystery
  {file:'anim-arcane-storm.gif',name:'Arcane Storm'},
  {file:'anim-crystal-cavern-pulse.gif',name:'Crystal Cavern Pulse'},
  {file:'anim-portal-vortex.gif',name:'Portal Vortex'},
  {file:'anim-wizard-duel.gif',name:'Wizard Duel'},
  {file:'anim-cauldron-brew.gif',name:'Cauldron Brew'},
  {file:'anim-runic-circle.gif',name:'Runic Circle'},
  {file:'anim-crystal-bridge.gif',name:'Crystal Bridge'},
  {file:'anim-wishing-well.gif',name:'Wishing Well'},
  {file:'anim-spell-scroll-room.gif',name:'Spell Scroll Room'},
  {file:'anim-enchanted-well.gif',name:'Enchanted Well'},
  // Interiors & Labs
  {file:'anim-torch-corridor.gif',name:'Torch Corridor'},
  {file:'anim-library-rain.gif',name:'Library Rain'},
  {file:'anim-clocktower.gif',name:'Clocktower'},
  {file:'anim-wizards-study.gif',name:"Wizard's Study"},
  {file:'anim-alchemist-lab.gif',name:'Alchemist Lab'},
  {file:'anim-dragons-lair.gif',name:"Dragon's Lair"},
  // Atmosphere & Weather
  {file:'anim-starfall-sky.gif',name:'Starfall Sky'},
  {file:'anim-roseglow-lanterns.gif',name:'Roseglow Lanterns'},
  {file:'anim-thunderstorm-coast.gif',name:'Thunderstorm Coast'},
  {file:'anim-sandstorm-desert.gif',name:'Sandstorm Desert'},
  {file:'anim-solar-eclipse.gif',name:'Solar Eclipse'},
  {file:'anim-blood-moon.gif',name:'Blood Moon'},
  {file:'anim-meteor-crater.gif',name:'Meteor Crater'},
  // Dark & Haunted
  {file:'anim-moonlit-graveyard.gif',name:'Moonlit Graveyard'},
  {file:'anim-haunted-tower.gif',name:'Haunted Tower'},
  {file:'anim-bone-graveyard.gif',name:'Bone Graveyard'},
  {file:'anim-haunted-ballroom.gif',name:'Haunted Ballroom'},
  // Scenic
  {file:'anim-moonlit-docks.gif',name:'Moonlit Docks'},
  {file:'anim-moonlit-ruins.gif',name:'Moonlit Ruins'},
  {file:'anim-war-drums.gif',name:'War Drums'},
  // Nautical
  {file:'anim-sinking-ship.gif',name:'Sinking Ship'},
  {file:'anim-ghost-ship.gif',name:'Ghost Ship'},
  {file:'anim-jellyfish-deep.gif',name:'Jellyfish Deep'},
  {file:'anim-coral-sway.gif',name:'Coral Reef Sway'},
  // Nature & Weather
  {file:'anim-tornado.gif',name:'Tornado'},
  {file:'anim-avalanche.gif',name:'Avalanche'},
  {file:'anim-falling-stars.gif',name:'Falling Stars'},
  {file:'anim-campfire-night.gif',name:'Campfire Night'},
  {file:'anim-vine-growth.gif',name:'Vine Growth'},
  {file:'anim-bubbling-swamp.gif',name:'Bubbling Swamp'},
  {file:'anim-enchanted-pond.gif',name:'Enchanted Pond'},
  {file:'anim-windmill.gif',name:'Windmill'},
  // Interiors & Mechanical
  {file:'anim-floating-candles.gif',name:'Floating Candles'},
  {file:'anim-ticking-clock.gif',name:'Ticking Clock'},
  {file:'anim-spinning-wheel.gif',name:'Spinning Wheel'},
  {file:'anim-candle-tunnel.gif',name:'Candle Tunnel'},
  {file:'anim-haunted-mirror.gif',name:'Haunted Mirror'},
  // Caves & Crystals
  {file:'anim-waterfall-cave.gif',name:'Waterfall Cave'},
  {file:'anim-pulse-crystals.gif',name:'Pulse Crystals'},
  // Fun
  {file:'anim-shooting-gallery.gif',name:'Shooting Gallery'},
  // v7 â€” High Detail
  {file:'anim-volcanic-eruption.gif',name:'Volcanic Eruption'},
  {file:'anim-bioluminescent-grove.gif',name:'Bioluminescent Grove'},
  {file:'anim-clockwork-city.gif',name:'Clockwork City'},
  {file:'anim-northern-lights-sea.gif',name:'Northern Lights Sea'},
  {file:'anim-rain-on-rooftops.gif',name:'Rain on Rooftops'},
  {file:'anim-enchanted-hourglass.gif',name:'Enchanted Hourglass'},
  {file:'anim-thunderstorm-field.gif',name:'Thunderstorm Field'},
  {file:'anim-crystal-cavern-waterfall.gif',name:'Crystal Cavern Waterfall'},
  {file:'anim-will-o-wisps.gif',name:"Will-o'-Wisps"},
  {file:'anim-magic-library.gif',name:'Magic Library'},
];

// Generate still backgrounds as data URIs
const STILL_BACKGROUNDS = [
  // Moons
  {file:'scene-palehowl-rising.png',name:'Palehowl Rising'},
  {file:'scene-emberhowl-eclipse.png',name:'Emberhowl Eclipse'},
  {file:'scene-solaris-dawn.png',name:'Solaris Dawn'},
  {file:'scene-deepwell-abyss.png',name:'Deepwell Abyss'},
  {file:'scene-evergreen-canopy.png',name:'Evergreen Canopy'},
  {file:'scene-umbra-void.png',name:'Umbra Void'},
  {file:'scene-roseglow-festival.png',name:'Roseglow Festival'},
  // Locations & Events
  {file:'scene-first-howl.png',name:'The First Howl'},
  {file:'scene-septenary-alignment.png',name:'Septenary Alignment'},
  {file:'scene-wanderer-path.png',name:"The Wanderer's Path"},
  {file:'scene-great-rot.png',name:'The Great Rot'},
  {file:'scene-pack-magic-ritual.png',name:'Pack Magic Ritual'},
  {file:'scene-sorting-ceremony.png',name:'The Sorting Ceremony'},
  {file:'scene-moon-bridge.png',name:'Moon Bridge'},
  {file:'scene-howling-gate.png',name:'The Howling Gate'},
  // Interiors
  {file:'scene-wizard-castle.png',name:'Wizard Castle'},
  {file:'scene-wizard-round-table.png',name:'Wizard Round Table'},
  {file:'scene-wizard-tower-interior.png',name:'Wizard Tower Interior'},
  {file:'scene-potion-workshop.png',name:'Potion Workshop'},
  {file:'scene-enchanted-library.png',name:'Enchanted Library'},
  {file:'scene-crystal-lizard-cave.png',name:'Crystal Lizard Cave'},
  {file:'scene-dragons-hoard.png',name:"Dragon's Hoard"},
  // Environments
  {file:'scene-icy-mountain.png',name:'Icy Mountain'},
  {file:'scene-volcano.png',name:'Volcano'},
  {file:'scene-frozen-tundra-storm.png',name:'Frozen Tundra Storm'},
  {file:'scene-mushroom-glade.png',name:'Mushroom Glade'},
  {file:'scene-ancient-ruins.png',name:'Ancient Ruins'},
  {file:'scene-starfall-meadow.png',name:'Starfall Meadow'},
  // Cities
  {file:'scene-crucible-city.png',name:'The Crucible'},
  {file:'scene-archivum-city.png',name:'Archivum'},
  {file:'scene-roothold-city.png',name:'Roothold'},
  {file:'scene-stillwater-city.png',name:'Stillwater'},
  {file:'scene-aurelius-city.png',name:'Aurelius'},
  {file:'scene-bondsheart-city.png',name:'Bondsheart'},
  // Interiors v2
  {file:'scene-observatory.png',name:'Observatory'},
  {file:'scene-throne-room.png',name:'Throne Room'},
  {file:'scene-dungeon-cell.png',name:'Dungeon Cell'},
  {file:'scene-wizards-dorm.png',name:"Wizard's Dorm"},
  {file:'scene-abandoned-mine.png',name:'Abandoned Mine'},
  // Underwater
  {file:'scene-sunken-ship.png',name:'Sunken Ship'},
  {file:'scene-coral-reef.png',name:'Coral Reef'},
  // Outdoor Scenes
  {file:'scene-dock-at-dawn.png',name:'Dock at Dawn'},
  {file:'scene-autumn-clearing.png',name:'Autumn Clearing'},
  {file:'scene-zen-garden.png',name:'Zen Garden'},
  {file:'scene-shipwreck-beach.png',name:'Shipwreck Beach'},
  {file:'scene-market-street.png',name:'Market Street'},
  {file:'scene-frozen-lake.png',name:'Frozen Lake'},
  // Fantasy
  {file:'scene-spider-hollow.png',name:'Spider Hollow'},
  {file:'scene-goblin-camp.png',name:'Goblin Camp'},
  {file:'scene-crystal-garden.png',name:'Crystal Garden'},
  {file:'scene-floating-islands.png',name:'Floating Islands'},
  {file:'scene-bridge-over-chasm.png',name:'Bridge Over Chasm'},
  {file:'scene-crystal-lake-night.png',name:'Crystal Lake Night'},
  {file:'scene-dragon-nest.png',name:'Dragon Nest'},
  // v7 â€” High Detail
  {file:'scene-witchs-cottage.png',name:"Witch's Cottage"},
  {file:'scene-underwater-temple.png',name:'Underwater Temple'},
  {file:'scene-graveyard-dawn.png',name:'Graveyard Dawn'},
  {file:'scene-enchanted-forge.png',name:'Enchanted Forge'},
  {file:'scene-moonlit-harbor.png',name:'Moonlit Harbor'},
  {file:'scene-crystal-throne-room.png',name:'Crystal Throne Room'},
  {file:'scene-misty-waterfall-cliff.png',name:'Misty Waterfall Cliff'},
  {file:'scene-dragon-graveyard.png',name:'Dragon Graveyard'},
  {file:'scene-wizard-laboratory.png',name:'Wizard Laboratory'},
  {file:'scene-aurora-peaks.png',name:'Aurora Peaks'}
];

// State
let selectedWizard = null;
let selectedBackground = null;
let filteredWizards = WIZARDS;
let currentTab = 'wizards';

// DOM Elements
const canvas = document.getElementById('previewCanvas');
const ctx = canvas.getContext('2d');
const bgLayer = document.getElementById('bgLayer');
const dogLayer = document.getElementById('dogLayer');
const previewLoading = document.getElementById('previewLoading');

// Tab Management
function switchTab(tab) {
    // Update tab buttons
    document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
    document.querySelector(`[onclick="switchTab('${tab}')"]`).classList.add('active');
    
    // Update tab panels
    document.querySelectorAll('.tab-panel').forEach(panel => panel.classList.remove('active'));
    document.getElementById(tab + 'Tab').classList.add('active');
    
    currentTab = tab;
}

// Wizard Management
function buildWizardGrid(query = '', order = '') {
    const queryLower = query.toLowerCase();
    filteredWizards = WIZARDS.filter(w => 
        (!order || w.order === order) && 
        (!queryLower || w.name.toLowerCase().includes(queryLower) || w.id.includes(queryLower))
    );
    
    document.getElementById('wizardCount').textContent = 
        `${filteredWizards.length} of ${WIZARDS.length} ${query || order ? '(filtered)' : ''}`;
    
    const grid = document.getElementById('wizardsGrid');
    grid.innerHTML = filteredWizards.map(w => `
        <div class="wizard-thumb ${selectedWizard && selectedWizard.id === w.id ? 'selected' : ''}" 
             onclick="selectWizard('${w.id}')" title="#${w.id} ${w.name}">
            <div class="wizard-id">#${w.id}</div>
            <img src="${w.id.startsWith('starter-') ? 'images/starters/thumbs/' + w.id + '.png' : 'wizard-images/' + w.id + '.png'}" alt="${w.name}" loading="lazy">
        </div>
    `).join('');
}

function selectWizard(id) {
    selectedWizard = WIZARDS.find(w => w.id === id);
    showLoading();
    
    dogLayer.onload = () => {
        updatePreview();
        hideLoading();
        updateDownloadButtons();
    };
    dogLayer.src = id.startsWith('starter-') ? `images/starters/${id}.png` : `wizard-images-transparent/${id}.png`;
    dogLayer.style.display = 'block';
    
    document.getElementById('selectedName').textContent = `#${id} ${selectedWizard.name}`;
    buildWizardGrid(document.getElementById('wizardSearch').value, document.getElementById('orderFilter').value);
}

// Background Management
function buildAnimatedBgGrid() {
    const grid = document.getElementById('animatedBgGrid');
    if (grid.children.length > 1) return; // already built
    let html = `<div class="bg-thumb none-bg" data-file="" onclick="clearBackground()">None</div>`;
    html += ANIMATED_BACKGROUNDS.map(bg => `
        <div class="bg-thumb" data-file="${bg.file}"
             onclick="selectAnimatedBackground('${bg.file}')">
            <div class="bg-type-badge">GIF</div>
            <img src="content-bg/thumbs/${bg.file.replace('.gif','.jpg')}" alt="${bg.name}" loading="lazy">
            <div class="bg-label">${bg.name}</div>
        </div>
    `).join('');
    grid.innerHTML = html;
}

function buildStillBgGrid() {
    const grid = document.getElementById('stillBgGrid');
    if (grid.children.length > 1) return; // already built
    let html = `<div class="bg-thumb none-bg" data-file="" onclick="clearBackground()">None</div>`;
    html += STILL_BACKGROUNDS.map((bg, index) => `
        <div class="bg-thumb" data-file="${bg.file}"
             onclick="selectStillBackground(${index})">
            <div class="bg-type-badge">PNG</div>
            <img src="content-bg/still/${bg.file}" alt="${bg.name}" loading="lazy">
            <div class="bg-label">${bg.name}</div>
        </div>
    `).join('');
    grid.innerHTML = html;
}

function updateBgSelection() {
    document.querySelectorAll('.bg-thumb').forEach(el => {
        const file = el.dataset.file;
        if (!file) { el.classList.toggle('selected', !selectedBackground); return; }
        el.classList.toggle('selected', selectedBackground && selectedBackground.file === file);
    });
}

function selectAnimatedBackground(file) {
    selectedBackground = {type: 'animated', file: file, name: ANIMATED_BACKGROUNDS.find(b => b.file === file).name};
    showLoading();
    
    bgLayer.onload = () => {
        updatePreview();
        hideLoading();
        updateDownloadButtons();
    };
    bgLayer.src = `content-bg/${file}`;
    bgLayer.style.display = 'block';
    
    updateBgSelection();
}

function selectStillBackground(index) {
    const bg = STILL_BACKGROUNDS[index];
    selectedBackground = {type: 'still', file: bg.file, name: bg.name};
    showLoading();
    
    bgLayer.onload = () => {
        updatePreview();
        hideLoading();
        updateDownloadButtons();
    };
    bgLayer.src = `content-bg/still/${bg.file}`;
    bgLayer.style.display = 'block';
    
    updateBgSelection();
}

function clearBackground() {
    selectedBackground = null;
    bgLayer.style.display = 'none';
    updatePreview();
    updateDownloadButtons();
    updateBgSelection();
}

// Preview Management
function updatePreview() {
    if (!selectedWizard) return;
    
    const scale = parseFloat(document.getElementById('dogScale').value);
    const offsetX = parseFloat(document.getElementById('dogOffsetX').value);
    const offsetY = parseFloat(document.getElementById('dogOffsetY').value);
    const rotation = parseFloat(document.getElementById('dogRotation').value);
    
    dogLayer.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale}) rotate(${rotation}deg)`;
    
    // Update setting values
    document.getElementById('dogScaleValue').textContent = Math.round(scale * 100) + '%';
    document.getElementById('dogOffsetXValue').textContent = offsetX + 'px';
    document.getElementById('dogOffsetYValue').textContent = offsetY + 'px';
    document.getElementById('dogRotationValue').textContent = rotation + 'Â°';
}

function showLoading() {
    previewLoading.classList.remove('hidden');
}

function hideLoading() {
    previewLoading.classList.add('hidden');
}

// Download Management
function updateDownloadButtons() {
    const stillBtn = document.getElementById('downloadStill');
    const bgBtn = document.getElementById('downloadBg');
    
    stillBtn.disabled = !selectedWizard;
    
    if (selectedBackground && selectedBackground.type === 'animated') {
        bgBtn.style.display = 'inline-block';
        bgBtn.disabled = false;
    } else {
        bgBtn.style.display = 'none';
    }
}

function getPreviewSize() {
    return document.getElementById('previewFrame').getBoundingClientRect().width || 400;
}

function drawDogOnCanvas(targetCtx, dogImg, canvasSize) {
    const previewW = getPreviewSize();
    const ratio = canvasSize / previewW;
    const scale = parseFloat(document.getElementById('dogScale').value);
    const offsetX = parseFloat(document.getElementById('dogOffsetX').value) * ratio;
    const offsetY = parseFloat(document.getElementById('dogOffsetY').value) * ratio;
    const rotation = parseFloat(document.getElementById('dogRotation').value);
    
    targetCtx.save();
    targetCtx.translate(canvasSize/2 + offsetX, canvasSize/2 + offsetY);
    targetCtx.scale(scale, scale);
    targetCtx.rotate(rotation * Math.PI / 180);
    targetCtx.drawImage(dogImg, -canvasSize/2, -canvasSize/2, canvasSize, canvasSize);
    targetCtx.restore();
}

function triggerDownload(dataUrl, filename) {
    // Safari/iOS fallback â€” open in new tab if link.click() doesn't work
    const link = document.createElement('a');
    link.download = filename;
    link.href = dataUrl;
    document.body.appendChild(link);
    link.click();
    setTimeout(() => {
        document.body.removeChild(link);
        // Fallback: if still on page after 1s, open in new tab (iOS Safari)
    }, 100);
}

function downloadStill() {
    if (!selectedWizard) {
        alert('Select a wizard first');
        return;
    }
    
    showLoading();
    
    const dog = new Image();
    dog.crossOrigin = 'anonymous';
    dog.src = selectedWizard.id.startsWith('starter-') ? `images/starters/${selectedWizard.id}.png` : `wizard-images-transparent/${selectedWizard.id}.png`;
    
    dog.onload = () => {
        ctx.clearRect(0, 0, 1000, 1000);
        
        if (selectedBackground) {
            const bg = new Image();
            bg.crossOrigin = 'anonymous';
            
            if (selectedBackground.type === 'animated') {
                bg.src = `content-bg/${selectedBackground.file}`;
            } else {
                bg.src = `content-bg/still/${selectedBackground.file}`;
            }
            
            bg.onload = () => {
                ctx.drawImage(bg, 0, 0, 1000, 1000);
                drawDogOnCanvas(ctx, dog, 1000);
                
                const filename = `wizard-${selectedWizard.id}-${selectedBackground.name.replace(/\s+/g, '-').toLowerCase()}.png`;
                triggerDownload(canvas.toDataURL('image/png'), filename);
                hideLoading();
            };
        } else {
            ctx.fillStyle = '#1C1C1E';
            ctx.fillRect(0, 0, 1000, 1000);
            drawDogOnCanvas(ctx, dog, 1000);
            
            triggerDownload(canvas.toDataURL('image/png'), `wizard-${selectedWizard.id}-no-bg.png`);
            hideLoading();
        }
    };
}

function downloadBackground() {
    if (!selectedBackground || selectedBackground.type !== 'animated') {
        alert('No animated background selected');
        return;
    }
    
    if (!selectedWizard) {
        // No wizard selected â€” just download raw GIF
        const link = document.createElement('a');
        link.download = `background-${selectedBackground.name.replace(/\s+/g, '-').toLowerCase()}.gif`;
        link.href = `content-bg/${selectedBackground.file}`;
        link.click();
        return;
    }
    
    showLoading();
    
    // Load the dog image first
    const dog = new Image();
    dog.crossOrigin = 'anonymous';
    dog.src = selectedWizard.id.startsWith('starter-') ? `images/starters/${selectedWizard.id}.png` : `wizard-images-transparent/${selectedWizard.id}.png`;
    
    dog.onload = () => {
        const gifUrl = `content-bg/${selectedBackground.file}`;
        
        compositeGif(gifUrl, dog).then(blob => {
            const blobUrl = URL.createObjectURL(blob);
            const filename = `wizard-${selectedWizard.id}-${selectedBackground.name.replace(/\s+/g, '-').toLowerCase()}.gif`;
            triggerDownload(blobUrl, filename);
            setTimeout(() => URL.revokeObjectURL(blobUrl), 5000);
            hideLoading();
        }).catch(err => {
            console.error('GIF composite failed:', err);
            alert('GIF creation failed: ' + err.message + '. Check console for details.');
            hideLoading();
        });
    };
}

async function compositeGif(gifUrl, dogImg) {
    // omggif uses CommonJS exports â€” shim it for browser
    if (!window.GifReader) {
        window.exports = window.exports || {};
        await loadScript('https://cdn.jsdelivr.net/npm/omggif@1.0.10/omggif.js', 'sha384-MyJfgL1BC/8IpGowcTSNInyyiYYLLUEEDACAIkOlzV68oYz87Pu5amdJWCO3NtFo');
        window.GifReader = window.exports.GifReader;
        window.GifWriter = window.exports.GifWriter;
    }
    if (!window.GIF) {
        await loadScript('https://unpkg.com/gif.js@0.2.0/dist/gif.js', 'sha384-4RMW82CWFobXY+HRHXe5go/V5acBhiIVGCT+2k7TEoxi7AiWKw8WoWb9qMU+FAFu');
    }
    
    const resp = await fetch(gifUrl);
    const buff = await resp.arrayBuffer();
    const reader = new window.GifReader(new Uint8Array(buff));
    
    const w = reader.width;
    const h = reader.height;
    const numFrames = reader.numFrames();
    
    if (!numFrames) throw new Error('No frames found');
    
    // Output at 1000x1000 for high quality (matches still download size)
    const outW = 1000, outH = 1000;
    
    const encoder = new GIF({
        workers: 2,
        quality: 1,
        width: outW,
        height: outH,
        dither: false,
        workerScript: 'gif.worker.js'
    });
    
    // Accumulator canvas at GIF native resolution
    const acc = document.createElement('canvas');
    acc.width = w; acc.height = h;
    const actx = acc.getContext('2d');
    
    // Pre-render the dog layer at output resolution
    const dogLayerCanvas = document.createElement('canvas');
    dogLayerCanvas.width = outW; dogLayerCanvas.height = outH;
    const dctx = dogLayerCanvas.getContext('2d');
    drawDogOnCanvas(dctx, dogImg, outW);
    
    // Reusable composite canvas at output resolution
    const comp = document.createElement('canvas');
    comp.width = outW; comp.height = outH;
    const cctx = comp.getContext('2d');
    cctx.imageSmoothingEnabled = false;
    
    for (let i = 0; i < numFrames; i++) {
        const info = reader.frameInfo(i);
        const pixels = new Uint8Array(w * h * 4);
        reader.decodeAndBlitFrameRGBA(i, pixels);
        
        // Put decoded frame onto accumulator at native res
        const frameData = new ImageData(new Uint8ClampedArray(pixels.buffer), w, h);
        const tmp = document.createElement('canvas');
        tmp.width = w; tmp.height = h;
        tmp.getContext('2d').putImageData(frameData, 0, 0);
        actx.drawImage(tmp, 0, 0);
        
        // Upscale background to output resolution + composite dog
        cctx.clearRect(0, 0, outW, outH);
        cctx.drawImage(acc, 0, 0, outW, outH);
        cctx.drawImage(dogLayerCanvas, 0, 0);
        
        encoder.addFrame(cctx, {delay: info.delay * 10, copy: true});
    }
    
    return new Promise((resolve, reject) => {
        encoder.on('finished', blob => resolve(blob));
        encoder.on('error', reject);
        encoder.render();
    });
}

function loadScript(src, integrity) {
    return new Promise((resolve, reject) => {
        if (document.querySelector(`script[src="${src}"]`)) { resolve(); return; }
        const s = document.createElement('script');
        s.src = src;
        if (integrity) { s.integrity = integrity; s.crossOrigin = 'anonymous'; }
        s.onload = resolve;
        s.onerror = reject;
        document.head.appendChild(s);
    });
}

// Utility Functions
function randomizeSelection() {
    const randomWizard = WIZARDS[Math.floor(Math.random() * WIZARDS.length)];
    const allBgs = [...ANIMATED_BACKGROUNDS.map(bg => ({type: 'animated', ...bg})), 
                   ...STILL_BACKGROUNDS.map((bg, i) => ({type: 'still', index: i, ...bg}))];
    const randomBg = allBgs[Math.floor(Math.random() * allBgs.length)];
    
    selectWizard(randomWizard.id);
    
    if (randomBg.type === 'animated') {
        selectAnimatedBackground(randomBg.file);
    } else {
        selectStillBackground(randomBg.index);
    }
}

function filterWizards() {
    const query = document.getElementById('wizardSearch').value;
    const order = document.getElementById('orderFilter').value;
    buildWizardGrid(query, order);
}

// Event Listeners
document.getElementById('wizardSearch').addEventListener('input', filterWizards);

// Initialize
buildWizardGrid();
buildAnimatedBgGrid();
buildStillBgGrid();
updateDownloadButtons();
</script>
<script>
(function(){
    var h=document.getElementById('navHamburger'),m=document.getElementById('navMobileMenu');
    if(h&&m){h.addEventListener('click',function(){var o=m.classList.toggle('open');h.classList.toggle('is-open',o);});}
    var nav=document.getElementById('mainNav');
    if(nav){window.addEventListener('scroll',function(){nav.classList.toggle('scrolled',window.scrollY>10);},{passive:true});}
})();
</script>
<script src="sparkle.js?v=1772131297"></script>
<script src="orb-cursor.js"></script>
<script src="starfield.js"></script>
</body>
</html>